import{j as e,J as X,a1 as G,r as n,B,F as y,X as J,e as K,c as I,S as E,u as q,T as W,U as Z,f as g}from"./index-BMYc7Eyr.js";import{S as O,a as U,b as P,c as Y,d as a}from"./select-DZeVJwWo.js";import{I as v}from"./input-Bp_50W1t.js";import{f as ee,a as se,b as L,c as i,d as re,e as o}from"./table-_gJFl-nq.js";import{f as le,a as oe}from"./dateUtils-D6w6W0GJ.js";import{D as V,a as R,b as H,c as M,d as z,g as Q,f as ie}from"./dialog-BUmtcOY4.js";import{L as _}from"./label-DCOkkRjJ.js";const ce=G("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function $({className:r,variant:m,...l}){return e.jsx("div",{className:X(ce({variant:m}),r),...l})}function ae({agent:r,agentList:m}){var C,d;const[l,w]=n.useState(!1),[t,S]=n.useState(!1),[x,A]=n.useState({role:((d=(C=r.user)==null?void 0:C.role)==null?void 0:d.toString())||"1"}),F=async()=>{if(!l){w(!0);try{const c=await I.put(`editType/${r.user.id}`,{role:x.role},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});m(),S(!1),E.fire({icon:"success",title:"Success",text:c.data.message,showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(c){console.error("Error updating role:",c),E.fire({icon:"error",title:"Oops",text:"Failed to update role. Please try again."})}finally{w(!1)}}};return e.jsxs(V,{open:t,onOpenChange:S,children:[(r==null?void 0:r.prc_liscence_number)!==""&&e.jsx(R,{children:e.jsx(B,{className:`w-8 h-8 rounded-md ${(r==null?void 0:r.prc_liscence_number)===""?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-500 hover:bg-green-400"}`,disabled:(r==null?void 0:r.prc_liscence_number)==="",children:e.jsx(y,{icon:J,className:"text-[#eff6ff]"})})}),e.jsx(H,{className:"md:max-w-[425px]",children:e.jsxs(M,{children:[e.jsx(z,{className:"text-start",children:"Edit Type"}),e.jsx(Q,{children:e.jsxs("div",{className:"text-start flex flex-col gap-4 mt-5",children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(_,{htmlFor:"accnt",children:"Account number"}),e.jsx(v,{type:"text",value:r.user.acct_number,readOnly:!0,className:"cursor-not-allowed"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(_,{htmlFor:"name",children:"Fullname"}),e.jsx(v,{type:"text",value:`${r.personal_info.first_name} ${r.personal_info.middle_name} ${r.personal_info.last_name} ${r.personal_info.extension_name}`,readOnly:!0,className:"cursor-not-allowed"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(_,{htmlFor:"email",children:"Email address"}),e.jsx(v,{type:"email",value:r.user.email,readOnly:!0,className:"cursor-not-allowed"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(_,{htmlFor:"phone",children:"Contact number"}),e.jsx(v,{type:"text",value:r==null?void 0:r.personal_info.phone,readOnly:!0,className:"cursor-not-allowed"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(_,{htmlFor:"type",children:"Type"}),e.jsxs(O,{name:"role",defaultValue:x.role,onValueChange:c=>A({...x,role:c}),children:[e.jsx(U,{className:"h-9 bg-white",children:e.jsx(P,{placeholder:"Select Agent or Broker"})}),e.jsxs(Y,{children:[e.jsx(a,{value:"1",children:"Agent"}),e.jsx(a,{value:"2",children:"Broker"})]})]})]}),e.jsx("div",{className:"flex justify-end w-full gap-2",children:e.jsx(B,{className:"w-full bg-green-500 hover:bg-green-400",onClick:F,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Updating..."}),e.jsx("span",{className:"animate-spin border-2 cursor-not-allowed border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{icon:K}),e.jsx("span",{className:"text-[#eff6ff]",children:"Update"})]})})})]})})]})})]})}function fe(){const[r,m]=n.useState([]),[l,w]=n.useState(""),[t,S]=n.useState("all"),x=q(),A=async()=>{try{const s=await I.get("agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});m(s.data.agentList)}catch(s){console.error("Error fetching agent and broker:",s),E.fire({icon:"error",title:"Error",text:"Failed to fetching agent and broker. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),x("/atHomes")}};n.useEffect(()=>{A()},[]);const F=s=>{w(s.target.value)},C=s=>{S(s==="all"?"all":parseInt(s))},d=r.filter(s=>{var h,u,f,p,j,b,N;const k=`${(h=s==null?void 0:s.user)==null?void 0:h.acct_number}`.toLowerCase(),D=`${(u=s==null?void 0:s.personal_info)==null?void 0:u.first_name} ${(f=s==null?void 0:s.personal_info)==null?void 0:f.middle_name} ${(p=s==null?void 0:s.personal_info)==null?void 0:p.last_name} ${(j=s==null?void 0:s.personal_info)==null?void 0:j.extension_name}`.toLowerCase(),T=((b=s==null?void 0:s.user)==null?void 0:b.role)===1?"agent":((N=s==null?void 0:s.user)==null?void 0:N.role)===2?"broker":"";return D.includes(l.toLowerCase())||T.includes(l.toLowerCase())||k.includes(l.toLowerCase())}),c=t==="all"?d:d.slice(0,t);return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(O,{onValueChange:C,children:[e.jsxs(U,{className:"w-[120px] border border-primary md:w-28",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(P,{placeholder:"All"})," "]}),e.jsxs(Y,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"10",children:"10"}),e.jsx(a,{value:"20",children:"20"}),e.jsx(a,{value:"30",children:"30"}),e.jsx(a,{value:"40",children:"40"}),e.jsx(a,{value:"50",children:"50"})]})]}),e.jsx(v,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:l,onChange:F})]}),e.jsx("div",{className:"fade-in-left",children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(L,{children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"Account number"}),e.jsx(i,{children:"Fullname"}),e.jsx(i,{children:"Type"}),e.jsx(i,{children:"Email address"}),e.jsx(i,{children:"Contact number"}),e.jsx(i,{children:"Date Approved"}),e.jsx(i,{children:"Status"}),e.jsx(i,{className:"text-right",children:"Action"})]})}),e.jsx(re,{children:c.length>0?c.map((s,k)=>{var D,T,h,u,f,p,j,b,N;return e.jsxs(L,{children:[e.jsx(o,{className:"font-medium border border-[#bfdbfe]",children:k+1}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.user.acct_number}),e.jsxs(o,{className:"border border-[#bfdbfe] uppercase",children:[s.personal_info.first_name," ",s.personal_info.middle_name," ",s.personal_info.last_name," ",s.personal_info.extension_name]}),e.jsx(o,{className:"font-medium border border-[#bfdbfe]",children:((D=s==null?void 0:s.user)==null?void 0:D.role)===1?e.jsx("span",{className:"inline-flex unlicenseds-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Agent"}):((T=s==null?void 0:s.user)==null?void 0:T.role)===2?e.jsx("span",{className:"inline-flex unlicenseds-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Broker"}):(h=s==null?void 0:s.user)==null?void 0:h.role}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s==null?void 0:s.user.email}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s==null?void 0:s.personal_info.phone}),e.jsx(o,{className:"border border-[#bfdbfe]",children:le(s==null?void 0:s.user.updated_at)}),e.jsx(o,{className:"border border-[#bfdbfe]",children:(s==null?void 0:s.prc_liscence_number)!==""?e.jsxs($,{className:"bg-green-500 hover:bg-green-500 gap-1",children:[e.jsx(y,{icon:W})," Licensed"]}):(s==null?void 0:s.prc_liscence_number)===""?e.jsxs($,{className:"bg-red-500 hover:bg-red-500 gap-1",children:[e.jsx(y,{icon:Z}),"Unlicensed"]}):s==null?void 0:s.prc_liscence_number}),e.jsx(o,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsxs(V,{children:[e.jsx(R,{children:e.jsx(B,{className:"w-8 h-8 rounded-md",children:e.jsx(y,{icon:g,className:"text-[#eff6ff]"})})}),e.jsx(H,{className:"md:max-w-[400px]",children:e.jsxs(M,{children:[e.jsx(z,{className:"text-start",children:"Agent and Broker Details"}),e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col gap-4 mt-5 mb-5",children:[e.jsxs("div",{className:"border-b pb-2 mb-4 text-start",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Personal Details"}),e.jsxs("p",{children:["Name: ",(u=s==null?void 0:s.personal_info)==null?void 0:u.first_name," ",(f=s==null?void 0:s.personal_info)==null?void 0:f.middle_name," ",(p=s==null?void 0:s.personal_info)==null?void 0:p.last_name]}),e.jsxs("p",{children:["Email: ",(j=s==null?void 0:s.user)==null?void 0:j.email]}),e.jsxs("p",{children:["Username: ",(b=s==null?void 0:s.user)==null?void 0:b.username]}),e.jsxs("p",{children:["Phone: ",(N=s==null?void 0:s.personal_info)==null?void 0:N.phone]}),e.jsxs("p",{children:["Gender: ",s.personal_info.gender.charAt(0).toUpperCase()+s.personal_info.gender.slice(1)]}),e.jsxs("p",{children:["Complete Address: ",s.personal_info.complete_address]}),e.jsxs("p",{children:["Status: ",s.user.status===0?"Approved":s.user.status===1?"Pending":"Decline"]})]}),e.jsxs("div",{className:"text-start",children:[e.jsx("h2",{className:"text-lg font-bold ",children:"Identity Information"}),e.jsxs("p",{children:["PRC License Number: ",(s==null?void 0:s.prc_liscence_number)||"N/A"]}),e.jsxs("p",{children:["DHSUD Registration Number: ",(s==null?void 0:s.dhsud_registration_number)||"N/A"]}),e.jsxs("p",{children:["Type: ",(s==null?void 0:s.user.role)===1?"Agent":(s==null?void 0:s.user.role)===2?"Broker":"N/A"]}),e.jsxs("p",{children:["Validity Date: ",oe((s==null?void 0:s.validation_date)||"N/A")]})]})]})}),e.jsx(ie,{asChild:!0,children:e.jsx(B,{className:"bg-red-500 hover:bg-red-400",children:"Close"})})]})})]}),e.jsx(ae,{agent:s,agentList:A})]})})]},s.id)}):e.jsx(L,{children:e.jsx(o,{colSpan:9,className:"text-center border border-[#bfdbfe]",children:"No data available"})})})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",t==="all"?d.length:t," of ",d.length," entries"]})})})]})}export{fe as default};
