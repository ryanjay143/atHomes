import{r as i,j as e,B as y,F as v,f as R,a2 as E,c as A,S as _,X as I}from"./index-D08i151l.js";import{a as P,b as Y}from"./dateUtils-D6w6W0GJ.js";import{S as $,a as F,b as L,c as m,d as t}from"./select-BsQqV2s9.js";import{I as z}from"./input-D0hbgsj-.js";import{f as H,a as M,b as S,c,d as O,e as o}from"./table-ClV6Stmn.js";import{D as U,a as V,b as G,c as X,d as q,g as J,e as K,f as Q}from"./dialog-B_IQxA-z.js";function W({item:r,getPendingRegistered:C}){var w,D,d,f,s;const[h,b]=i.useState(!1),[n,N]=i.useState(!1),x=async()=>{if(!n){N(!0);try{const a=await A.put(`agent-broker/${r.user.id}`,{status:0},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});b(!1),_.fire({title:"Success",text:a.data.message,icon:"success",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),C()}catch(a){console.error("Error updating user status:",a)}finally{N(!1)}}};return e.jsxs(U,{open:h,onOpenChange:b,children:[e.jsx(V,{children:e.jsx(y,{className:"w-8 h-8 rounded-md",children:e.jsx(v,{icon:R,className:"text-[#eff6ff]"})})}),e.jsxs(G,{className:"md:max-w-[400px]",children:[e.jsxs(X,{children:[e.jsx(q,{className:"text-start",children:"Agent and Broker Details"}),e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col gap-4 mt-5",children:[e.jsxs("div",{className:"border-b pb-2 mb-4 text-start",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Personal Details"}),e.jsxs("p",{children:["Name: ",(w=r==null?void 0:r.personal_info)==null?void 0:w.first_name," ",(D=r==null?void 0:r.personal_info)==null?void 0:D.last_name]}),e.jsxs("p",{children:["Email: ",(d=r==null?void 0:r.user)==null?void 0:d.email]}),e.jsxs("p",{children:["Username: ",(f=r==null?void 0:r.user)==null?void 0:f.username]}),e.jsxs("p",{children:["Phone: ",(s=r==null?void 0:r.personal_info)==null?void 0:s.phone]}),e.jsxs("p",{children:["Gender: ",r.personal_info.gender.charAt(0).toUpperCase()+r.personal_info.gender.slice(1)]}),e.jsxs("p",{children:["Complete Address: ",r.personal_info.complete_address]}),e.jsxs("p",{children:["Status: ",r.user.status===0?"Approved":r.user.status===1?"Pending":"Decline"]})]}),e.jsxs("div",{className:"text-start",children:[e.jsx("h2",{className:"text-lg font-bold ",children:"Identity Information"}),e.jsxs("p",{children:["PRC License Number: ",(r==null?void 0:r.prc_liscence_number)||"N/A"]}),e.jsxs("p",{children:["DHSUD Registration Number: ",(r==null?void 0:r.dhsud_registration_number)||"N/A"]}),e.jsxs("p",{children:["Type: ",(r==null?void 0:r.user.role)===1?"Agent":(r==null?void 0:r.user.role)===2?"Broker":"N/A"]}),e.jsxs("p",{children:["Validity Date: ",P((r==null?void 0:r.validation_date)||"N/A")]})]})]})})]}),e.jsx(K,{children:e.jsxs("div",{className:"flex flex-row gap-2 justify-end",children:[e.jsx(Q,{asChild:!0,children:e.jsx(y,{className:"bg-red-500 hover:bg-red-400",children:"Cancel"})}),e.jsx(y,{className:"bg-green-500 hover:bg-green-400",type:"button",onClick:x,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Approved..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{icon:E}),e.jsx("span",{children:"Approved"})]})})]})})]})]})}function le(){const[r,C]=i.useState([]),[h,b]=i.useState(""),[n,N]=i.useState("all");function x(){A.get("agent-broker",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(s=>{C(s.data.pendingAgents)}).catch(s=>{console.log(s)})}const w=async s=>{_.fire({title:"Are you sure?",text:"Do you really want to delete this user?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async a=>{if(a.isConfirmed)try{const l=await A.delete(`agent-broker/${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});_.fire({title:"Deleted!",text:l.data.message,icon:"success",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),x()}catch(l){console.error("Error deleting user:",l),_.fire({title:"Error!",text:"An error occurred while deleting the user.",icon:"error",showConfirmButton:!0})}})};i.useEffect(()=>{x()},[]);const D=s=>{N(s==="all"?"all":parseInt(s))},d=r.filter(s=>{var u,g,p,j;const a=`${(u=s==null?void 0:s.personal_info)==null?void 0:u.first_name} ${(g=s==null?void 0:s.personal_info)==null?void 0:g.last_name}`.toLowerCase(),l=((p=s==null?void 0:s.user)==null?void 0:p.role)===1?"agent":((j=s==null?void 0:s.user)==null?void 0:j.role)===2?"broker":"";return a.includes(h.toLowerCase())||l.includes(h.toLowerCase())}),f=n==="all"?d:d.slice(0,n);return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs($,{onValueChange:D,children:[e.jsxs(F,{className:"w-[120px] border border-primary md:w-28",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(L,{placeholder:"All"})," "]}),e.jsxs(m,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"10",children:"10"}),e.jsx(t,{value:"20",children:"20"}),e.jsx(t,{value:"30",children:"30"}),e.jsx(t,{value:"40",children:"40"}),e.jsx(t,{value:"50",children:"50"})]})]}),e.jsx(z,{type:"text",value:h,placeholder:"Search",className:"w-52 md:w-full",onChange:s=>b(s.target.value)})]}),e.jsx("div",{className:"fade-in-left",children:e.jsxs(H,{children:[e.jsx(M,{className:"bg-primary",children:e.jsxs(S,{children:[e.jsx(c,{children:"#"}),e.jsx(c,{children:"Fullname"}),e.jsx(c,{children:"Type"}),e.jsx(c,{children:"Email address"}),e.jsx(c,{children:"Contact number"}),e.jsx(c,{children:"Date Registered"}),e.jsx(c,{className:"text-right",children:"Action"})]})}),e.jsx(O,{children:f.length>0?f.map((s,a)=>{var l,u,g,p,j,T,B,k;return e.jsxs(S,{children:[e.jsx(o,{className:"font-medium capitalize border border-[#bfdbfe]",children:a+1}),e.jsxs(o,{className:"font-medium capitalize border border-[#bfdbfe]",children:[(l=s==null?void 0:s.personal_info)==null?void 0:l.first_name," ",(u=s==null?void 0:s.personal_info)==null?void 0:u.last_name]}),e.jsx(o,{className:"border border-[#bfdbfe]",children:((g=s==null?void 0:s.user)==null?void 0:g.role)===1?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Agent"}):((p=s==null?void 0:s.user)==null?void 0:p.role)===2?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Broker"}):(j=s==null?void 0:s.user)==null?void 0:j.role}),e.jsx(o,{className:"border border-[#bfdbfe]",children:(T=s==null?void 0:s.user)==null?void 0:T.email}),e.jsx(o,{className:"border border-[#bfdbfe]",children:(B=s==null?void 0:s.personal_info)==null?void 0:B.phone}),e.jsx(o,{className:"border border-[#bfdbfe]",children:Y((k=s==null?void 0:s.personal_info)==null?void 0:k.created_at)}),e.jsx(o,{className:"border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-center",children:[e.jsx(W,{item:s,getPendingRegistered:x}),e.jsx(y,{className:"w-8 h-8 rounded-md bg-red-500 hover:bg-hover-400",onClick:()=>w(s.id),children:e.jsx(v,{icon:I})})]})})]},a)}):e.jsx(S,{children:e.jsx(o,{colSpan:7,className:"text-center border border-[#bfdbfe]",children:"No data available"})})})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",n==="all"?d.length:n," of ",d.length," entries"]})})})]})}export{le as default};
