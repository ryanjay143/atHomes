import{j as e,O as K,a9 as q,r as x,B as L,F as i,a3 as J,aa as W,g as Z,d as O,S as U,u as ee,Y as se,X as F,a as re,ab as le}from"./index-BqgKW3tX.js";import{S as Y,a as P,b as V,c as R,d as n}from"./select-yW0ppv6d.js";import{I as _}from"./input-BPORAoyB.js";import{D as H,a as M,b as z,c as Q,d as X,g as G,T as oe,h as ie,i as E,j as d,k as ae,l as o,f as de}from"./dialog-bG-Ik3It.js";import{f as ne,a as ce}from"./dateUtils-D6w6W0GJ.js";import{L as w}from"./label-L0oGHOiY.js";const te=q("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function I({className:r,variant:u,...l}){return e.jsx("div",{className:K(te({variant:u}),r),...l})}function xe({agent:r,agentList:u}){var D,c;const[l,C]=x.useState(!1),[m,A]=x.useState(!1),[h,S]=x.useState({role:((c=(D=r.user)==null?void 0:D.role)==null?void 0:c.toString())||"1"}),B=async()=>{if(!l){C(!0);try{const a=await O.put(`editType/${r.user.id}`,{role:h.role},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});u(),A(!1),U.fire({icon:"success",title:"Success",text:a.data.message,showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(a){console.error("Error updating role:",a),U.fire({icon:"error",title:"Oops",text:"Failed to update role. Please try again."})}finally{C(!1)}}};return e.jsxs(H,{open:m,onOpenChange:A,children:[(r==null?void 0:r.prc_liscence_number)!==""&&e.jsx(M,{children:e.jsx(L,{className:`w-8 h-8 rounded-md ${(r==null?void 0:r.prc_liscence_number)===""?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-green-400 to-green-600 shadow hover:from-green-500 hover:to-green-700 transition-all duration-200"}`,disabled:(r==null?void 0:r.prc_liscence_number)==="",title:"Edit Type",children:e.jsx(i,{icon:J,className:"text-white"})})}),e.jsx(z,{className:"md:max-w-[430px] rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(Q,{children:[e.jsxs(X,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(i,{icon:W,className:"text-blue-500"}),"Edit Type"]}),e.jsx(G,{children:e.jsxs("div",{className:"flex flex-col gap-5 mt-6 text-start",children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"accnt",className:"font-semibold text-blue-900",children:"Account Number"}),e.jsx(_,{type:"text",value:r.user.acct_number,readOnly:!0,className:"cursor-not-allowed rounded-lg border-blue-200 bg-gray-100"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"name",className:"font-semibold text-blue-900",children:"Full Name"}),e.jsx(_,{type:"text",value:`${r.personal_info.first_name} ${r.personal_info.middle_name} ${r.personal_info.last_name} ${r.personal_info.extension_name}`,readOnly:!0,className:"cursor-not-allowed rounded-lg border-blue-200 bg-gray-100"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"email",className:"font-semibold text-blue-900",children:"Email Address"}),e.jsx(_,{type:"email",value:r.user.email,readOnly:!0,className:"cursor-not-allowed rounded-lg border-blue-200 bg-gray-100"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"phone",className:"font-semibold text-blue-900",children:"Contact Number"}),e.jsx(_,{type:"text",value:r==null?void 0:r.personal_info.phone,readOnly:!0,className:"cursor-not-allowed rounded-lg border-blue-200 bg-gray-100"})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"type",className:"font-semibold text-blue-900",children:"Type"}),e.jsxs(Y,{name:"role",defaultValue:h.role,onValueChange:a=>S({...h,role:a}),children:[e.jsx(P,{className:"h-9 bg-white rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:e.jsx(V,{placeholder:"Select Agent or Broker"})}),e.jsxs(R,{children:[e.jsx(n,{value:"1",children:"Agent"}),e.jsx(n,{value:"2",children:"Broker"})]})]})]}),e.jsx("div",{className:"flex justify-end w-full gap-2 mt-2",children:e.jsx(L,{className:"w-full bg-gradient-to-r from-green-500 to-green-700 text-white rounded-lg shadow hover:from-green-600 hover:to-green-800 flex items-center justify-center gap-2",onClick:B,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Updating..."}),e.jsx("span",{className:"animate-spin border-2 cursor-not-allowed border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{icon:Z}),e.jsx("span",{children:"Update"})]})})})]})})]})})]})}function Ne(){const[r,u]=x.useState([]),[l,C]=x.useState(""),[m,A]=x.useState("all"),h=ee(),S=async()=>{try{const s=await O.get("agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});u(s.data.agentList)}catch(s){console.error("Error fetching agent and broker:",s),U.fire({icon:"error",title:"Error",text:"Failed to fetching agent and broker. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),h("/")}};x.useEffect(()=>{S()},[]);const B=s=>{C(s.target.value)},D=s=>{A(s==="all"?"all":parseInt(s))},c=r.filter(s=>{var b,f,p,j,N,v,y;const k=`${(b=s==null?void 0:s.user)==null?void 0:b.acct_number}`.toLowerCase(),T=`${(f=s==null?void 0:s.personal_info)==null?void 0:f.first_name} ${(p=s==null?void 0:s.personal_info)==null?void 0:p.middle_name} ${(j=s==null?void 0:s.personal_info)==null?void 0:j.last_name} ${(N=s==null?void 0:s.personal_info)==null?void 0:N.extension_name}`.toLowerCase(),g=((v=s==null?void 0:s.user)==null?void 0:v.role)===1?"agent":((y=s==null?void 0:s.user)==null?void 0:y.role)===2?"broker":"";return T.includes(l.toLowerCase())||g.includes(l.toLowerCase())||k.includes(l.toLowerCase())}),a=m==="all"?c:c.slice(0,m);return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(Y,{onValueChange:D,children:[e.jsxs(P,{className:"w-[120px] border border-primary md:w-28",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(V,{placeholder:"All"})," "]}),e.jsxs(R,{children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"10",children:"10"}),e.jsx(n,{value:"20",children:"20"}),e.jsx(n,{value:"30",children:"30"}),e.jsx(n,{value:"40",children:"40"}),e.jsx(n,{value:"50",children:"50"})]})]}),e.jsx(_,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:l,onChange:B})]}),e.jsx("div",{className:"fade-in-left",children:e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsxs(E,{children:[e.jsx(d,{children:"#"}),e.jsx(d,{children:"Fullname"}),e.jsx(d,{children:"Type"}),e.jsx(d,{children:"Email address"}),e.jsx(d,{children:"Contact number"}),e.jsx(d,{children:"Date Approved"}),e.jsx(d,{children:"Status"}),e.jsx(d,{className:"text-right",children:"Action"})]})}),e.jsx(ae,{children:a.length>0?a.map((s,k)=>{var T,g,b,f,p,j,N,v,y;return e.jsxs(E,{children:[e.jsx(o,{className:"font-medium border border-[#bfdbfe]",children:k+1}),e.jsxs(o,{className:"border border-[#bfdbfe] uppercase",children:[s.personal_info.first_name," ",s.personal_info.middle_name," ",s.personal_info.last_name," ",s.personal_info.extension_name]}),e.jsx(o,{className:"font-medium border border-[#bfdbfe]",children:((T=s==null?void 0:s.user)==null?void 0:T.role)===1?e.jsx("span",{className:"inline-flex unlicenseds-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Agent"}):((g=s==null?void 0:s.user)==null?void 0:g.role)===2?e.jsx("span",{className:"inline-flex unlicenseds-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Broker"}):(b=s==null?void 0:s.user)==null?void 0:b.role}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s==null?void 0:s.user.email}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s==null?void 0:s.personal_info.phone}),e.jsx(o,{className:"border border-[#bfdbfe]",children:ne(s==null?void 0:s.user.updated_at)}),e.jsx(o,{className:"border border-[#bfdbfe]",children:(()=>{var $;const t=($=s==null?void 0:s.prc_liscence_number)==null?void 0:$.trim();return!t||t.toUpperCase()==="N/A"||t.toUpperCase()==="NA"||t.length<4||t.toLowerCase()==="n/a"||t.toLowerCase()==="na"||t.toLowerCase()===""?e.jsxs(I,{className:"bg-red-500 hover:bg-red-500 gap-1",children:[e.jsx(i,{icon:se}),"Unlicensed"]}):e.jsxs(I,{className:"bg-green-500 hover:bg-green-500 gap-1",children:[e.jsx(i,{icon:F})," Licensed"]})})()}),e.jsx(o,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsxs(H,{children:[e.jsx(M,{children:e.jsx(L,{className:"w-8 h-8 rounded-md bg-gradient-to-br from-blue-500 to-blue-700 shadow hover:from-blue-600 hover:to-blue-800 transition-all duration-200",children:e.jsx(i,{icon:re,className:"text-white"})})}),e.jsx(z,{className:"md:max-w-[420px] rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(Q,{children:[e.jsxs(X,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(i,{icon:F,className:"text-blue-500"}),"Agent & Broker Details"]}),e.jsx(G,{children:e.jsxs("div",{className:"flex flex-col gap-6 mt-6 mb-4",children:[e.jsxs("div",{className:"border-b pb-4 mb-2 text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{icon:le,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Personal Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Account #:"})," ",s==null?void 0:s.user.acct_number]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Name:"})," ",(f=s==null?void 0:s.personal_info)==null?void 0:f.first_name," ",(p=s==null?void 0:s.personal_info)==null?void 0:p.middle_name," ",(j=s==null?void 0:s.personal_info)==null?void 0:j.last_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",(N=s==null?void 0:s.user)==null?void 0:N.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Username:"})," ",(v=s==null?void 0:s.user)==null?void 0:v.username]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Phone:"})," ",(y=s==null?void 0:s.personal_info)==null?void 0:y.phone]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Gender:"})," ",s.personal_info.gender.charAt(0).toUpperCase()+s.personal_info.gender.slice(1)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Complete Address:"})," ",s.personal_info.complete_address]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Status:"}),s.user.status===0&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-green-100 text-green-700 text-xs font-semibold",children:"Approved"}),s.user.status===1&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 text-xs font-semibold",children:"Pending"}),s.user.status!==0&&s.user.status!==1&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:"Declined"})]})]})]}),e.jsxs("div",{className:"text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{icon:F,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Identity Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"PRC License #:"})," ",(s==null?void 0:s.prc_liscence_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"DHSUD Reg. #:"})," ",(s==null?void 0:s.dhsud_registration_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Type:"})," ",(s==null?void 0:s.user.role)===1?"Agent":(s==null?void 0:s.user.role)===2?"Broker":"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Validity Date:"})," ",ce((s==null?void 0:s.validation_date)||"N/A")]})]})]})]})}),e.jsx(de,{asChild:!0,children:e.jsx(L,{className:"bg-red-500 hover:bg-red-400 text-white rounded-lg mt-2 shadow",children:"Close"})})]})})]}),e.jsx(xe,{agent:s,agentList:S})]})})]},s.id)}):e.jsx(E,{children:e.jsx(o,{colSpan:9,className:"text-center border border-[#bfdbfe]",children:"No data available"})})})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",m==="all"?c.length:m," of ",c.length," entries"]})})})]})}export{Ne as default};
