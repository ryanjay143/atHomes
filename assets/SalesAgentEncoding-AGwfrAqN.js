import{j as e,L as ye,r,B as D,F as n,$ as we,ae as R,a4 as T,aa as Q,ad as se,ag as de,g as me,d as ae,S as te,a as Se,ah as xe,ai as _e,aj as Ce,a1 as ue,a3 as ke}from"./index-Dk1_FMbU.js";import{c as Pe,C as Be,b as Le}from"./card-CBUDeD1Y.js";import{I as v}from"./input-lhyLM1nK.js";import{S as z,a as $,b as H,c as M,d as o}from"./select-mnZuAGIz.js";import{D as W,a as ge,b as K,c as le,d as re,g as ne,e as X,f as De,T as Fe,h as Ee,i as ee,j as L,k as Ae,l as _}from"./dialog-CJKaJoWJ.js";import{B as Ie,a as Re,b as Te,c as Oe}from"./breadcrumb-D-hm6pqD.js";import{L as d}from"./label-BBsw-Xlw.js";import{N as he}from"./react-number-format.es-D7EvX0do.js";function qe(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Ie,{children:e.jsxs(Re,{children:[e.jsx(Te,{className:"text-accent",children:e.jsx(ye,{to:"/agent-broker/agent-salesEncoding",children:"List of Sales Encoding"})}),e.jsx(Oe,{})]})})})})}function Ge({fetchAgent:t,identityDetails:j}){const[l,g]=r.useState({agent_id:j.id,category:"",date_on_sale:new Date().toISOString().split("T")[0],amount:"",location:"",remarks:"",image:null,client_name:"",block_and_lot:""}),[c,f]=r.useState({}),[C,F]=r.useState(!1),[u,E]=r.useState(!1),[y,A]=r.useState(""),[w,S]=r.useState(null),[k,b]=r.useState(null);r.useEffect(()=>{g(a=>({...a,agent_id:j.id}))},[j]);const P=()=>{const a={};return l.agent_id||(a.agent_id="Agent/Broker is required."),l.category||(a.category="Category is required."),l.date_on_sale||(a.date_on_sale="Date of Sale is required."),l.amount||(a.amount="Amount of Sale is required."),l.location||(a.location="Location of Property is required."),l.remarks||(a.remarks="Remarks are required."),l.image||(a.image="Proof of Transaction is required."),l.client_name||(a.client_name="Client name is required."),l.category==="Block and lot"&&!l.block_and_lot&&(a.block_and_lot="Block & Lot is required."),f(a),Object.keys(a).length===0},s=async a=>{if(a.preventDefault(),!P()||u)return;E(!0);const i=new FormData;Object.entries(l).forEach(([h,N])=>{h==="block_and_lot"?i.append(h,l.category==="Block and lot"?String(N||""):""):h==="image"?N&&i.append(h,N):i.append(h,String(N))});try{await ae.post("user/agent-sales",i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),t(),g({agent_id:j.id,category:"",date_on_sale:new Date().toISOString().split("T")[0],amount:"",location:"",remarks:"",image:null,client_name:"",block_and_lot:""}),A(""),F(!1),S(null),te.fire({icon:"success",title:"Success",text:"Sales created successfully.",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch{te.fire({icon:"error",title:"Failed to create sales encoding",text:"There was an error while saving your sales encoding. Please try again.",confirmButtonText:"Retry"})}finally{E(!1)}},p=(a,i)=>{g(a==="category"?{...l,category:i,block_and_lot:i==="Block and lot"?l.block_and_lot:""}:{...l,[a]:i})},B=a=>{const{name:i,value:h}=a.target;g({...l,[i]:h})},V=a=>{const i=a.target.value;g({...l,date_on_sale:i})},J=a=>{const{value:i}=a;A(i),g({...l,amount:i}),f(i===""?{amount:"Amount is required"}:{})},O=a=>{var h;const i=((h=a.target.files)==null?void 0:h[0])||null;if(i&&(["image/jpeg","image/png","image/jpg"].includes(i.type)?i.size>5242880?(b("File size exceeds the maximum limit of 5MB."),g({...l,image:null})):(b(null),g({...l,image:i})):(b("Invalid file type. Only JPEG, PNG, and JPG are allowed."),g({...l,image:null}))),i){const N=new FileReader;N.onloadend=()=>{S(N.result)},N.onerror=()=>{b("Failed to read file")},N.readAsDataURL(i)}};return e.jsx("div",{children:e.jsxs(W,{open:C,onOpenChange:F,children:[e.jsx(ge,{asChild:!0,children:e.jsxs(D,{className:"h-10 bg-gradient-to-r from-blue-500 to-blue-700 text-white shadow-md hover:from-blue-600 hover:to-blue-800 transition-all duration-200 rounded-lg",children:[e.jsx(n,{icon:we,className:"mr-2"}),"Add Sales"]})}),e.jsx(K,{className:"md:w-[90%] max-w-lg h-full md:h-[750px] overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(le,{children:[e.jsxs(re,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:R,className:"text-blue-500"}),"Add Sales Encoding"]}),e.jsx(ne,{children:e.jsx("form",{onSubmit:s,children:e.jsxs("div",{className:"text-start grid grid-cols-1 md:grid-cols-1 gap-5 mt-5",children:[e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-blue-900",children:"Category"}),e.jsxs(z,{onValueChange:a=>p("category",a),children:[e.jsx($,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(H,{placeholder:"Select category"})}),e.jsxs(M,{children:[e.jsx(o,{value:"Lot only",children:"Lot only"}),e.jsx(o,{value:"House and lot",children:"House and lot"}),e.jsx(o,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(o,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(o,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(o,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(o,{value:"Block and lot",children:"Block and lot"})]})]}),c.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.category})]}),l.category==="Block and lot"&&e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:T,className:"text-blue-400"}),"Block & Lot ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{type:"text",name:"block_and_lot",placeholder:"e.g. Block 01, Lot 10",value:l.block_and_lot,onChange:B,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",required:l.category==="Block and lot",autoFocus:!0}),c.block_and_lot&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.block_and_lot})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:Q,className:"text-blue-400"}),"Client Name"]}),e.jsx(v,{type:"text",name:"client_name",placeholder:"Enter client name",value:l.client_name,onChange:B,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),c.client_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.client_name})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:se,className:"text-blue-400"}),"Reservation Date"]}),e.jsx(v,{type:"date",name:"date_on_sale",value:l.date_on_sale,onChange:V,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),c.date_on_sale&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.date_on_sale})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-blue-900",children:"Amount of Sale"}),e.jsx(he,{value:y,thousandSeparator:!0,decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,placeholder:"0.00",onValueChange:J,className:"flex h-9 w-full rounded-lg border border-blue-300 bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"}),c.amount&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.amount})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:T,className:"text-blue-400"}),"Location of Property"]}),e.jsx(v,{type:"text",name:"location",placeholder:"Enter location of property",onChange:B,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),c.location&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.location})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-blue-900",children:"Remarks"}),e.jsxs(z,{onValueChange:a=>p("remarks",a),children:[e.jsx($,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(H,{placeholder:"Select remarks"})}),e.jsxs(M,{children:[e.jsx(o,{value:"Sold",children:"Sold"}),e.jsx(o,{value:"Not Sold",children:"Not Sold"}),e.jsx(o,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(o,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),c.remarks&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.remarks})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:de,className:"text-blue-400"}),"Upload Proof of Transaction",e.jsx("span",{className:"text-xs text-red-500 ml-2",children:"(JPEG, PNG, JPG only, max 5MB)"})]}),e.jsx(v,{type:"file",name:"image",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:O,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),k&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:k}),c.image&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.image}),w&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("img",{src:w,alt:"Preview",className:"max-w-xs rounded-lg border border-blue-200 shadow"})})]}),e.jsx(X,{className:"mt-4",children:e.jsx(D,{type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white rounded-lg shadow hover:from-blue-700 hover:to-blue-900 flex items-center justify-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:me}),e.jsx("span",{children:"Submit"})]})})})]})})})]})})]})})}function ze({sales:t,dateFormatter:j,currencyFormatter:l}){var C;const g=r.useRef(null),[c,f]=r.useState(!1);return e.jsx("div",{children:e.jsxs(W,{children:[e.jsx(ge,{children:e.jsx(D,{className:"h-8 w-8 font-medium text-sm rounded-md border border-primary bg-gradient-to-br from-blue-500 to-blue-700 text-white shadow hover:from-blue-600 hover:to-blue-800 transition-all duration-200",children:e.jsx(n,{icon:Se})})}),e.jsxs(K,{className:"md:w-[95%] max-w-2xl h-full overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(le,{children:[e.jsxs(re,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:R,className:"text-blue-500"}),"View Receipt"]}),e.jsx(ne,{children:e.jsxs("div",{ref:g,className:"grid gap-6 py-6 text-start bg-white rounded-xl shadow-inner px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:Q,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Broker/Agent:"}),e.jsxs("span",{className:"ml-2 text-base text-gray-800 font-medium",children:[t.agent.personal_info.first_name," ",t.agent.personal_info.middle_name," ",t.agent.personal_info.last_name," ",(C=t.agent.personal_info)==null?void 0:C.extension_name]})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:Q,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Client Name:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:t.client_name})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:R,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Category:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:t.category})]}),t.category==="Block and lot"&&e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:T,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Block & Lot:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:t.block_and_lot||e.jsx("span",{className:"italic text-gray-400",children:"N/A"})})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:se,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Date of Sale:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:j.format(new Date(t.date_on_sale))})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:xe,className:"text-green-500 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Amount:"}),e.jsx("span",{className:"ml-2 text-base text-green-700 font-bold",children:l.format(t.amount)})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:T,className:"text-red-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Location:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:_e,className:"text-indigo-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Remarks:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:t.remarks})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs(d,{className:"text-gray-600 font-semibold flex items-center gap-2",children:[e.jsx(n,{icon:Ce,className:"text-pink-400 text-lg"}),"Proof of Transaction:"]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:`http://192.168.1.9:8000/${t.image}`,alt:t.image,className:"object-cover rounded-lg border-2 border-blue-200 shadow-md max-w-xs max-h-60 cursor-pointer transition-transform duration-200 hover:scale-105 hover:ring-2 hover:ring-primary",onClick:()=>f(!0),title:"Click to preview"})}),e.jsx(W,{open:c,onOpenChange:f,children:e.jsxs(K,{className:"md:max-w-[80vw] flex flex-col items-center bg-white rounded-xl shadow-2xl",children:[e.jsx("img",{src:`http://192.168.1.9:8000/${t.image}`,alt:t.image,className:"max-w-[80vw] max-h-[80vh] rounded shadow-lg"}),e.jsx(X,{children:e.jsxs(D,{className:"mt-4 bg-red-500 hover:bg-red-400 text-white",onClick:()=>f(!1),children:[e.jsx(n,{icon:ue,className:"mr-1"}),"Close"]})})]})})]})]})})]}),e.jsx(X,{children:e.jsx("div",{className:"flex flex-row justify-end gap-2",children:e.jsx(De,{asChild:!0,children:e.jsx(D,{className:"bg-red-500 hover:bg-red-400 h-8 rounded shadow",children:"Close"})})})})]})]})})}const $e=({sales:t,open:j,onOpenChange:l,fetchAgent:g,identityDetails:c})=>{var ce;const f=`http://192.168.1.9:8000/${t.image}`,[C,F]=r.useState(c.id?String(c.id):""),[u,E]=r.useState(t.category||""),[y,A]=r.useState(((ce=t.date_on_sale)==null?void 0:ce.split("T")[0])||""),[w,S]=r.useState(t.amount.toString()||""),[k,b]=r.useState(t.location||""),[P,s]=r.useState(f),[p,B]=r.useState(t.remarks||""),[V,J]=r.useState(t.client_name||""),[O,a]=r.useState(t.block_and_lot||""),[i,h]=r.useState(!1),[N,I]=r.useState(null),[oe,Y]=r.useState(null),[ie,q]=r.useState(null),Z=r.useRef(null),fe=x=>{var G;const m=(G=x.target.files)==null?void 0:G[0];if(m){const ve=["image/jpeg","image/png","image/jpg"];if(!m.type.startsWith("image/")||!ve.includes(m.type)){q("Please select a valid image file (JPEG, PNG, or JPG).");return}if(m.size>5242880){q("The selected file exceeds the maximum size of 5MB.");return}q(null);const U=new FileReader;U.onloadend=()=>{typeof U.result=="string"&&(s(U.result),Y(m))},U.readAsDataURL(m)}else q("Please select a valid image file.")},be=()=>{s(f),Z.current&&(Z.current.value=""),Y(null)};r.useEffect(()=>{var x;j&&(F(c.id?String(c.id):""),E(t.category||""),A(((x=t.date_on_sale)==null?void 0:x.split("T")[0])||""),S(t.amount.toString()||""),b(t.location||""),B(t.remarks||""),J(t.client_name||""),a(t.block_and_lot||""),s(f),I(null),Y(null),q(null))},[j,t]);const je=x=>{E(x),x!=="Block and lot"&&a("")},pe=async x=>{if(x.preventDefault(),!i){if(h(!0),I(null),u==="Block and lot"&&!O){I("Block & Lot is required."),h(!1);return}try{const m=new FormData;m.append("agent_id",C),m.append("category",u),m.append("date_on_sale",y),m.append("amount",w),m.append("location",k),m.append("remarks",p),m.append("client_name",V),u==="Block and lot"&&m.append("block_and_lot",O),oe&&m.append("image",oe),(await ae.post(`updateSalesEncodingAgent/${t.id}`,m,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"multipart/form-data"}})).status===200&&(l(!1),S(""),g(),te.fire({icon:"success",title:"Success",text:"Sales encoding updated successfully!",timer:2e3,timerProgressBar:!0,showConfirmButton:!1}))}catch(m){if(m.response&&m.response.data&&m.response.data.errors){const G=Object.values(m.response.data.errors).flat().join(", ");I(G)}else I("An error occurred while updating.")}finally{h(!1)}}},Ne=x=>{const{value:m}=x;S(m)};return e.jsx(W,{open:j,onOpenChange:l,children:e.jsxs(K,{className:"md:w-[90%] h-full overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(le,{className:"text-start",children:[e.jsxs(re,{className:"text-2xl font-bold text-blue-900 flex items-center gap-2 mb-2",children:[e.jsx(n,{icon:R,className:"text-blue-500"}),"Edit Sales Encoding"]}),e.jsx(ne,{children:e.jsx("span",{className:"text-blue-800 md:text-sm mt-1",children:"Make changes to your sales here. Click save when you're done."})})]}),e.jsxs("form",{onSubmit:pe,className:"space-y-6 mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-5",children:[e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:R,className:"text-blue-400"}),"Category"]}),e.jsxs(z,{value:u,onValueChange:je,children:[e.jsx($,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(H,{placeholder:"Select category"})}),e.jsxs(M,{children:[e.jsx(o,{value:"Lot only",children:"Lot only"}),e.jsx(o,{value:"House and lot",children:"House and lot"}),e.jsx(o,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(o,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(o,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(o,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(o,{value:"Block and lot",children:"Block and lot"})]})]})]}),u==="Block and lot"&&e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:T,className:"text-blue-400"}),"Block & Lot ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{type:"text",value:O,onChange:x=>a(x.target.value),placeholder:"e.g. Block 01, Lot 10",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",required:u==="Block and lot",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:Q,className:"text-blue-400"}),"Client Name"]}),e.jsx(v,{value:V,onChange:x=>J(x.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:se,className:"text-blue-400"}),"Date"]}),e.jsx(v,{type:"date",value:y,onChange:x=>A(x.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:xe,className:"text-green-500"}),"Amount"]}),e.jsx(he,{value:w,thousandSeparator:!0,decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,placeholder:"0.00",onValueChange:Ne,className:"flex h-9 w-full rounded-lg border border-blue-300 bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:T,className:"text-blue-400"}),"Location"]}),e.jsx(v,{value:k,onChange:x=>b(x.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:R,className:"text-blue-400"}),"Remarks"]}),e.jsxs(z,{value:p,onValueChange:B,children:[e.jsx($,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(H,{placeholder:"Select remarks"})}),e.jsxs(M,{children:[e.jsx(o,{value:"Sold",children:"Sold"}),e.jsx(o,{value:"Not Sold",children:"Not Sold"}),e.jsx(o,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(o,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:de,className:"text-blue-400"}),"Proof of Transaction",e.jsx("span",{className:"text-xs text-red-500 ml-2",children:"(JPEG, PNG, JPG only, max 5MB)"})]}),e.jsx(v,{type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:fe,ref:Z,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),ie&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:ie})]}),P&&e.jsxs("div",{className:"relative mt-4 flex justify-center",children:[e.jsx("img",{src:P,alt:"Selected Preview",className:"max-h-48 object-cover rounded-lg border border-blue-200 shadow"}),P!==f&&e.jsx(D,{type:"button",onClick:be,className:"absolute top-2 right-2 h-8 w-8 bg-red-500 hover:bg-red-400 rounded-full p-1 shadow-md",children:e.jsx(n,{icon:ue,className:"text-white"})})]})]}),N&&e.jsx("div",{className:"text-red-500 text-center",children:N}),e.jsx(X,{children:e.jsx(D,{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:me}),e.jsx("span",{children:"Save changes"})]})})})]})]})})};function Ye(){const[t,j]=r.useState([]),[l,g]=r.useState({}),[c,f]=r.useState({}),[C,F]=r.useState(null),[u,E]=r.useState(""),[y,A]=r.useState("all"),w=async()=>{try{const s=await ae.get("user/agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});j(s.data.salesEncoding.map(p=>({...p,amount:typeof p.amount=="number"?p.amount:parseFloat(p.amount)}))),g(s.data.personalInfo),f(s.data.identityDetails),j(s.data.salesEncoding)}catch{}};r.useEffect(()=>{w()},[]);const S=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),k=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),b=t.filter(s=>s.category.toLowerCase().includes(u.toLowerCase())||new Date(s.date_on_sale).toLocaleDateString().toLowerCase().includes(u.toLowerCase())||s.amount.toString().toLowerCase().includes(u.toLowerCase())||s.location.toLowerCase().includes(u.toLowerCase())||s.remarks.toLowerCase().includes(u.toLowerCase())||s.client_name.toLowerCase().includes(u.toLowerCase())),P=y==="all"?b:b.slice(0,parseInt(y,10));return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0  gap-2 items-start justify-center mr-5 md:px-2 ",children:[e.jsx(qe,{}),e.jsxs(Pe,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left md:w-[380px]",children:[e.jsx(Be,{children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 justify-between",children:[e.jsxs("div",{className:"flex flex-col items-start bg-gradient-to-r from-blue-100 to-blue-200 px-4 py-2 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-xs text-blue-700 font-semibold",children:"Total Sales Encodings"}),e.jsx("span",{className:"text-2xl font-bold text-blue-900",children:b.length})]}),e.jsx("div",{className:"flex items-center",children:e.jsx(Ge,{fetchAgent:w,personalInfo:l,identityDetails:c})})]})}),e.jsxs(Le,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(z,{value:y,onValueChange:s=>A(s),children:[e.jsxs($,{className:"w-[120px] border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(H,{})]}),e.jsxs(M,{children:[e.jsx(o,{value:"all",children:"All"}),e.jsx(o,{value:"5",children:"5"}),e.jsx(o,{value:"10",children:"10"}),e.jsx(o,{value:"20",children:"20"}),e.jsx(o,{value:"30",children:"30"}),e.jsx(o,{value:"40",children:"40"}),e.jsx(o,{value:"50",children:"50"})]})]}),e.jsx(v,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:u,onChange:s=>E(s.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Fe,{className:"w-full",children:[e.jsx(Ee,{className:"bg-primary text-base",children:e.jsxs(ee,{children:[e.jsx(L,{children:"#"}),e.jsx(L,{children:"Client name"}),e.jsx(L,{children:"Category"}),e.jsx(L,{children:"Reservation Date"}),e.jsx(L,{children:"Amount"}),e.jsx(L,{children:"Location"}),e.jsx(L,{children:"Remarks"}),e.jsx(L,{className:"text-right",children:"Action"})]})}),e.jsxs(Ae,{children:[P.length===0&&e.jsx(ee,{children:e.jsx(_,{colSpan:8,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),P.map((s,p)=>e.jsxs(ee,{children:[e.jsx(_,{className:"font-medium border border-[#bfdbfe]",children:p+1}),e.jsx(_,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(_,{className:"font-medium border border-[#bfdbfe]",children:s.category}),e.jsx(_,{className:"border border-[#bfdbfe]",children:S.format(new Date(s.date_on_sale))}),e.jsx(_,{className:"border border-[#bfdbfe]",children:e.jsx("span",{children:k.format(s.amount)})}),e.jsx(_,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(_,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(_,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(ze,{sales:s,dateFormatter:S,currencyFormatter:k}),e.jsx(D,{className:"h-8 w-8 font-medium bg-green-500 hover:bg-green-400 text-sm rounded-md",onClick:()=>F(s.id),children:e.jsx(n,{icon:ke})}),e.jsx($e,{sales:s,open:C===s.id,onOpenChange:B=>F(B?s.id:null),fetchAgent:w,identityDetails:c})]})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",y==="all"?b.length:Math.min(parseInt(y,10),b.length)," of ",b.length," entries"]})})})]})]})]})})}export{Ye as default};
