import{j as e,L as Fe,r as t,B as W,F as l,$ as ke,ak as Oe,a5 as Le,ad as Ae,a4 as Te,al as ne,am as ye,an as U,ao as we,a0 as Ee,a1 as Se,d as ie,S as O,a as $e,u as qe,a3 as ze,a2 as Ve}from"./index-DzP73YiP.js";import{c as Ge,C as He,b as Je}from"./card-CDyzF-Gu.js";import{B as Me,a as Ue,b as We,c as Ke}from"./breadcrumb-rxFn7GaQ.js";import{S as oe,a as ce,b as de,c as me,d as c}from"./select-CDDnd22d.js";import{I as b}from"./input-Dz3A7Y41.js";import{D as ue,a as De,b as xe,c as ge,d as he,g as fe,e as _e,f as Qe,T as Ye,h as Xe,i as Pe,j as M,k as Ze,l as k}from"./dialog-BXUA4-iJ.js";import{L as u}from"./label-D6n5wU68.js";import{T as Re}from"./textarea-BF4E-VXM.js";function es(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Me,{children:e.jsxs(Ue,{children:[e.jsx(We,{className:"text-accent",children:e.jsx(Fe,{to:"/admin/brokerage-property",children:"Property Listing"})}),e.jsx(Ke,{})]})})})})}function Ie(s){return s.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function ss({onClose:s,fetchPropertiesData:v}){const[x,f]=t.useState(""),[h,y]=t.useState(null),[w,K]=t.useState(()=>new Date().toISOString().split("T")[0]),[C,T]=t.useState(""),[E,P]=t.useState(""),[L,Q]=t.useState(""),[D,n]=t.useState(""),[_,$]=t.useState(""),[I,q]=t.useState(""),[S,j]=t.useState([]),[se,R]=t.useState([]),[z,Y]=t.useState(!1),[m,V]=t.useState({}),[te,ae]=t.useState(!1),[X,Z]=t.useState(null),[re,pe]=t.useState(""),[le,be]=t.useState(""),G=t.useRef(null),Ce=a=>{const r=a.target.value.replace(/,/g,"");/^\d*$/.test(r)&&pe(r)},i=a=>{const r=a.target.value.replace(/,/g,"");/^\d*$/.test(r)&&be(r)},o=a=>{y(null);const r=a.target.files;if(r){const d=Array.from(r),p=["image/jpeg","image/png","image/jpg"],A=5*1024*1024,F=d.find(J=>!p.includes(J.type)||J.size>A);if(F){p.includes(F.type)?F.size>A&&y("Each image must be 5MB or less."):y("Only JPG, JPEG, and PNG files are allowed."),j([]),R([]),G.current&&(G.current.value="");return}const N=d.filter(J=>!S.some(Ne=>Ne.name===J.name&&Ne.size===J.size)),ee=[...S,...N];if(j(ee),N.length===0)return;const H=[];let je=0;N.forEach((J,Ne)=>{const ve=new FileReader;ve.onload=()=>{ve.result&&(H[Ne]=ve.result,je++,je===N.length&&R(Be=>[...Be,...H]))},ve.readAsDataURL(J)})}},g=(a,r)=>{r.preventDefault();const d=S.filter((p,A)=>A!==a);if(j(d),R(p=>p.filter((A,F)=>F!==a)),G.current){const p=new DataTransfer;d.forEach(A=>p.items.add(A)),G.current.files=p.files}},B=async a=>{if(a.preventDefault(),z)return;const r={};if(x||(r.category="Category is required."),w||(r.dateListed="Date listed is required."),C||(r.lotArea="Lot area is required."),E||(r.floorArea="Floor area is required."),L||(r.otherDetails="Other details are required."),D||(r.location="Location is required."),_||(r.type="Type of listing is required."),I||(r.status="Status is required."),S.length===0&&(r.images="At least one image is required."),x==="Rental Properties"&&!re&&(r.rentalRate="Rental rate is required."),x==="Commercial Properties"&&!le&&(r.sellingPrice="Selling price is required."),V(r),Object.keys(r).length>0)return;Y(!0);const d=new FormData;d.append("category",x),d.append("date_listed",w),d.append("lot_area",C),d.append("floor_area",E),d.append("details",L),d.append("location",D),d.append("type_of_listing",_),d.append("status",I),x==="Rental Properties"?d.append("price_and_rate",re):x==="Commercial Properties"?d.append("price_and_rate",le):d.append("price_and_rate",""),S.forEach(p=>{d.append("images[]",p)});try{await ie.post("property-listings",d,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),ae(!1),v(),O.fire({icon:"success",title:"Success",text:"Property listing created successfully.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),f(""),T(""),P(""),Q(""),n(""),$(""),q(""),j([]),R([]),pe(""),be(""),s()}catch(p){console.error("Error creating property listing:",p),O.fire({icon:"error",title:"Error",text:"There was an error creating the property listing. Please try again."})}finally{Y(!1)}};return e.jsxs(ue,{open:te,onOpenChange:ae,children:[e.jsx(De,{children:e.jsxs(W,{className:"bg-gradient-to-r from-blue-500 to-blue-700 text-white shadow-md hover:from-blue-600 hover:to-blue-800 transition-all duration-200 rounded-lg",children:[e.jsx(l,{icon:ke,className:"mr-2"}),"Add Brokerage"]})}),e.jsx(xe,{className:"md:w-[90%] max-w-xl h-full overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(ge,{className:"text-start",children:[e.jsxs(he,{className:"text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Oe,className:"text-blue-500"}),"Add New Property Listing"]}),e.jsx(fe,{children:e.jsxs("form",{onSubmit:B,className:"space-y-6 mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Le,className:"text-blue-400"}),"Category"]}),e.jsxs(oe,{value:x,onValueChange:f,children:[e.jsx(ce,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2",children:e.jsx(de,{placeholder:"Select category"})}),e.jsxs(me,{children:[e.jsx(c,{value:"Lot only",children:"Lot only"}),e.jsx(c,{value:"House and lot",children:"House and lot"}),e.jsx(c,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(c,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(c,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(c,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(c,{value:"For Assumption",children:"For Assumption"})]})]}),m.category&&e.jsx("p",{className:"text-red-500 text-xs",children:m.category})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Ae,className:"text-blue-400"}),"Date Listed"]}),e.jsx(b,{type:"date",value:w,onChange:a=>K(a.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2"}),m.dateListed&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.dateListed})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Te,className:"text-blue-400"}),"Location"]}),e.jsx(b,{type:"text",value:D,onChange:a=>n(a.target.value),placeholder:"e.g. Cagayan de Oro City, Misamis Oriental",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2"}),m.location&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.location})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ne,className:"text-blue-400"}),"Type of Listing"]}),e.jsxs("div",{className:"flex space-x-4 mt-2",children:[e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Exclusive",checked:_==="Exclusive",onChange:a=>$(a.target.value),className:"accent-blue-500"}),e.jsx("span",{children:"Exclusive"})]}),e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Non-Exclusive",checked:_==="Non-Exclusive",onChange:a=>$(a.target.value),className:"accent-blue-500"}),e.jsx("span",{children:"Non-Exclusive"})]})]}),m.type&&e.jsx("p",{className:"text-red-500 text-xs",children:m.type})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ye,className:"text-blue-400"}),"Status of Property"]}),e.jsxs(oe,{value:I,onValueChange:q,children:[e.jsx(ce,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2",children:e.jsx(de,{placeholder:"Select status"})}),e.jsxs(me,{children:[e.jsx(c,{value:"Sold",children:"Sold"}),e.jsx(c,{value:"Not Sold",children:"Not Sold"}),e.jsx(c,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(c,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),m.status&&e.jsx("p",{className:"text-red-500 text-xs ",children:m.status})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),"Lot Area (sqm)"]}),e.jsx(b,{type:"number",min:"0",value:C,onChange:a=>T(a.target.value),placeholder:"e.g. 100",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2"}),m.lotArea&&e.jsx("p",{className:"text-red-500 text-xs",children:m.lotArea})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),"Floor Area (sqm)"]}),e.jsx(b,{type:"number",min:"0",value:E,onChange:a=>P(a.target.value),placeholder:"e.g. 100",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2"}),m.floorArea&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.floorArea})]}),x==="Rental Properties"&&e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),"Rental Rate"]}),e.jsx(b,{type:"text",value:Ie(re),onChange:Ce,placeholder:"0.00",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2"}),m.rentalRate&&e.jsx("p",{className:"text-red-500 text-xs",children:m.rentalRate})]}),x==="Commercial Properties"&&e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),"Selling Price"]}),e.jsx(b,{type:"text",value:Ie(le),onChange:i,placeholder:"0.00",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2"}),m.sellingPrice&&e.jsx("p",{className:"text-red-500 text-xs",children:m.sellingPrice})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:we,className:"text-indigo-400"}),"Upload Property Images ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"text-xs font-normal text-red-600 ml-2",children:"(JPG, JPEG, PNG only, max 5MB each)"})]}),e.jsxs("label",{htmlFor:"property-image-upload",className:"flex flex-col items-center justify-center border-2 border-dashed border-blue-300 rounded-lg p-4 bg-white hover:bg-blue-50 cursor-pointer transition-all duration-200 mt-2",children:[e.jsx(l,{icon:Ee,className:"text-blue-400 text-3xl mb-2"}),e.jsx("span",{className:"text-blue-700 font-medium",children:"Click to upload images here"}),e.jsx(b,{id:"property-image-upload",type:"file",multiple:!0,accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:o,ref:G,className:"hidden"})]}),e.jsx("div",{className:"relative mt-2",children:e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-600 pointer-events-none bg-white px-2 rounded",style:{zIndex:2,background:"white",opacity:.85,fontWeight:500},children:S.length===0?"No image":`${S.length} image${S.length>1?"s":""}`})}),(h||m.images)&&e.jsx("p",{className:"text-red-500 text-xs",children:h||m.images}),e.jsx("div",{className:"grid grid-cols-5 md:grid-cols-3 gap-2 mt-4",children:se.map((a,r)=>e.jsxs("div",{className:"relative w-24 h-24 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer group",title:"Click to preview",onClick:()=>Z(a),children:[e.jsx("img",{src:a,alt:`Preview ${r+1}`,className:"object-cover w-full h-full transform transition-transform duration-300 group-hover:scale-110"}),e.jsx("button",{className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-400 transition",onClick:d=>g(r,d),type:"button",children:e.jsx(l,{icon:Se})})]},r))}),X&&e.jsx(ue,{open:!!X,onOpenChange:()=>Z(null),children:e.jsx(xe,{className:"max-w-[425px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(ge,{className:"text-start",children:[e.jsx(he,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(fe,{children:e.jsx("img",{src:X,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ne,className:"text-blue-400"}),"Other Details"]}),e.jsx(Re,{value:L,onChange:a=>Q(a.target.value),className:"w-full border rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 p-2 mt-2",rows:3}),m.otherDetails&&e.jsx("p",{className:"text-red-500 text-xs",children:m.otherDetails})]})]}),e.jsx(_e,{className:"flex justify-end space-x-2 mt-6",children:e.jsx(W,{type:"submit",disabled:z,className:"bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center gap-2 px-6 py-2",children:z?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Submit"})})})})]})})]})})]})}function ts(s){if(s==null)return"";const v=s.toString().replace(/[^0-9.]/g,""),[x,f]=v.split("."),h=x.replace(/\B(?=(\d{3})+(?!\d))/g,",");return f!==void 0?`${h}.${f}`:h}function as({property:s,dateFormatter:v}){const[x,f]=t.useState(null),h=s.category==="Commercial Properties"||s.category==="Rental Properties";return e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(De,{children:e.jsx(W,{className:"h-8 w-8 font-medium bg-gradient-to-br from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white text-sm rounded-md shadow transition-all duration-200",children:e.jsx(l,{icon:$e})})}),e.jsx(xe,{className:"md:w-[90%] p-6 overflow-auto max-h-[95%] bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl shadow-2xl border border-blue-200",children:e.jsxs(ge,{className:"text-start",children:[e.jsxs(he,{className:"text-2xl font-bold text-blue-900 flex items-center gap-2 mb-2",children:[e.jsx(l,{icon:ye,className:"text-blue-500"}),"View Property Listing"]}),e.jsx(fe,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{icon:Le,className:"text-blue-400"}),e.jsx("h3",{className:"font-semibold text-lg text-blue-800",children:"General Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-gray-700 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Category:"})," ",s.category]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date Listed:"})," ",v.format(new Date(s.date_listed))]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Location:"})," ",s.location]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Type of Listing:"})," ",s.type_of_listing]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Status:"})," ",s.status]}),h&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Price:"})," ₱",ts(s.price_and_rate)]})]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{icon:ne,className:"text-blue-400"}),e.jsx("h3",{className:"font-semibold text-lg text-blue-800",children:"Description of Property"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-gray-700 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Lot Area:"})," ",s.lot_area," sqm"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Floor Area:"})," ",s.floor_area," sqm"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Other Details:"})," ",s.details||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{icon:we,className:"text-indigo-400"}),e.jsx("h3",{className:"font-semibold text-lg text-blue-800",children:"Property Images"})]}),e.jsx("div",{className:"grid grid-cols-5 md:grid-cols-4 gap-2 mt-2",children:s.property_images&&s.property_images.length>0?s.property_images.map((y,w)=>e.jsx("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer group",onClick:()=>f(`https://athomes.site/${y.images}`),title:"Click to preview",children:e.jsx("img",{src:`https://athomes.site/${y.images}`,className:"object-cover w-full h-full transform transition-transform duration-300 group-hover:scale-110",alt:`Property Image ${w+1}`})},w)):e.jsx("span",{className:"text-gray-500 text-xs",children:"No images available"})})]})]})})]})})]}),x&&e.jsx(ue,{open:!!x,onOpenChange:()=>f(null),children:e.jsxs(xe,{className:"max-w-[425px] p-4 bg-white rounded-lg shadow-lg flex flex-col items-center",children:[e.jsxs(ge,{className:"text-start w-full",children:[e.jsxs(he,{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(l,{icon:we,className:"text-indigo-400"}),"Image Preview"]}),e.jsx(fe,{children:e.jsx("img",{src:x,alt:"Selected Property",className:"w-full h-auto rounded-md shadow"})})]}),e.jsx(_e,{className:"w-full flex justify-end mt-2",children:e.jsx(Qe,{asChild:!0,children:e.jsxs(W,{className:"bg-red-500 hover:bg-red-400 text-white rounded shadow",children:[e.jsx(l,{icon:Se,className:"mr-1"}),"Close"]})})})]})})]})}function rs(s){return s.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function ls({property:s,onClose:v,fetchPropertiesData:x}){const[f,h]=t.useState(""),[y,w]=t.useState(""),[K,C]=t.useState(""),[T,E]=t.useState(""),[P,L]=t.useState(""),[Q,D]=t.useState(""),[n,_]=t.useState(""),[$,I]=t.useState(""),[q,S]=t.useState(""),[j,se]=t.useState([]),[R,z]=t.useState([]),[Y,m]=t.useState([]),V=t.useRef(null),[te,ae]=t.useState(!1),[X,Z]=t.useState(null);t.useEffect(()=>{s&&(h(s.category||""),w(s.date_listed||""),C(s.location||""),E(s.type_of_listing||""),L(s.status||""),D(s.lot_area||""),_(s.floor_area||""),I(s.details||""),S(s.price_and_rate?s.price_and_rate.toString():""),m(s.property_images||[]))},[s]);const re=i=>{const o=i.target.value.replace(/,/g,"");/^\d*$/.test(o)&&S(o)},pe=i=>{Z(null);const o=i.target.files;if(o){const g=Array.from(o),B=["image/jpeg","image/png","image/jpg"],a=5*1024*1024,r=g.find(N=>!B.includes(N.type)||N.size>a);if(r){B.includes(r.type)?r.size>a&&Z("Each image must be 5MB or less."):Z("Only JPG, JPEG, and PNG files are allowed."),se([]),z([]),V.current&&(V.current.value="");return}const d=g.filter(N=>!j.some(ee=>ee.name===N.name&&ee.size===N.size)),p=[...j,...d];if(se(p),d.length===0)return;const A=[];let F=0;d.forEach((N,ee)=>{const H=new FileReader;H.onload=()=>{H.result&&(A[ee]=H.result,F++,F===d.length&&z(je=>[...je,...A]))},H.readAsDataURL(N)})}},le=(i,o)=>{o.preventDefault(),o.stopPropagation();const g=R.filter((a,r)=>r!==i);z(g);const B=j.filter((a,r)=>r!==i);if(se(B),V.current){const a=new DataTransfer;B.forEach(r=>a.items.add(r)),V.current.files=a.files}},be=i=>{m(i)},G=async i=>{if(te)return;ae(!0),i.preventDefault();const o=new FormData;o.append("category",f),o.append("date_listed",y),o.append("lot_area",Q),o.append("floor_area",n),o.append("details",$),o.append("location",K),o.append("type_of_listing",T),o.append("status",P),o.append("price_and_rate",q),j.forEach(g=>{o.append("images[]",g)});try{await ie.post(`property-listings/${s.id}?_method=PUT`,o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),x(),v(),O.fire({icon:"success",title:"Success",text:"Property listing updated successfully.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(g){console.error("Error updating property:",g)}finally{ae(!1)}},Ce=async(i,o)=>{try{await ie.delete(`property-listings/${i}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});const g=Y.filter((B,a)=>a!==o);be(g),x()}catch(g){console.error("Error deleting image:",g),O.fire({icon:"error",title:"Error",text:"Failed to delete image."})}};return e.jsxs(xe,{className:"md:w-[90%] overflow-auto h-full p-6 bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(ge,{className:"text-start",children:[e.jsxs(he,{className:"text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ye,className:"text-blue-500"}),"Edit Brokerage Listing"]}),e.jsx(fe,{children:"Make changes to your brokerage here. Click save when you're done."})]}),e.jsxs("form",{onSubmit:G,className:"space-y-6 mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Le,className:"text-blue-400"}),"Category"]}),e.jsxs(oe,{value:f,onValueChange:h,children:[e.jsx(ce,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 ",children:e.jsx(de,{placeholder:"Select category"})}),e.jsxs(me,{children:[e.jsx(c,{value:"Lot only",children:"Lot only"}),e.jsx(c,{value:"House and lot",children:"House and lot"}),e.jsx(c,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(c,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(c,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(c,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(c,{value:"For Assumption",children:"For Assumption"})]})]})]}),(f==="Commercial Properties"||f==="Rental Properties")&&e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),f==="Commercial Properties"?"Selling Price":"Rental Rate"]}),e.jsx(b,{type:"text",value:rs((q==null?void 0:q.toString())||""),onChange:re,placeholder:"0.00",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 "})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Ae,className:"text-blue-400"}),"Date Listed"]}),e.jsx(b,{type:"date",value:y,onChange:i=>w(i.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 "})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:Te,className:"text-blue-400"}),"Location"]}),e.jsx(b,{type:"text",value:K,onChange:i=>C(i.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 "})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ne,className:"text-blue-400"}),"Type of Listing"]}),e.jsxs("div",{className:"flex space-x-4 mt-2",children:[e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Exclusive",checked:T==="Exclusive",onChange:i=>E(i.target.value),className:"accent-blue-500"}),e.jsx("span",{children:"Exclusive"})]}),e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Non-Exclusive",checked:T==="Non-Exclusive",onChange:i=>E(i.target.value),className:"accent-blue-500"}),e.jsx("span",{children:"Non-Exclusive"})]})]})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ye,className:"text-blue-400"}),"Status of Property"]}),e.jsxs(oe,{value:P,onValueChange:L,children:[e.jsx(ce,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 ",children:e.jsx(de,{placeholder:"Select status"})}),e.jsxs(me,{children:[e.jsx(c,{value:"Sold",children:"Sold"}),e.jsx(c,{value:"Not Sold",children:"Not Sold"}),e.jsx(c,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(c,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),"Lot Area (sqm)"]}),e.jsx(b,{type:"text",value:Q,onChange:i=>D(i.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 "})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:U,className:"text-green-500"}),"Floor Area (sqm)"]}),e.jsx(b,{type:"text",value:n,onChange:i=>_(i.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-2 "})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(l,{icon:ne,className:"text-blue-400"}),"Other Details"]}),e.jsx(Re,{value:$,onChange:i=>I(i.target.value),className:"w-full border rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 p-2 mt-2",rows:3})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"font-semibold flex items-center gap-1",children:[e.jsx(l,{icon:we,className:"text-indigo-400"}),"Update Property Images ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"text-xs font-normal text-red-600 ml-2",children:"(JPG, JPEG, PNG only, max 5MB each)"})]}),e.jsxs("label",{htmlFor:"property-image-upload",className:"flex flex-col items-center justify-center border-2 border-dashed border-blue-300 rounded-lg p-4 bg-white hover:bg-blue-50 cursor-pointer transition-all duration-200 mt-2",children:[e.jsx(l,{icon:Ee,className:"text-blue-400 text-3xl mb-2"}),e.jsx("span",{className:"text-blue-700 font-medium",children:"Click to upload images here"}),e.jsx(b,{id:"property-image-upload",type:"file",multiple:!0,accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:pe,ref:V,className:"hidden"})]}),e.jsx("div",{className:"relative mt-2",children:e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-600 pointer-events-none bg-white px-2 rounded",style:{zIndex:2,background:"white",opacity:.85,fontWeight:500},children:j.length===0?"No image":`${j.length} image${j.length>1?"s":""}`})}),X&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:X}),e.jsxs("div",{className:"grid grid-cols-5 md:grid-cols-3 gap-2 mt-4",children:[Y.length>0&&Y.map((i,o)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer group",children:[e.jsx("img",{src:`https://athomes.site/${i.images}`,className:"object-cover w-full h-full transform transition-transform duration-300 group-hover:scale-110",alt:`Property Image ${o+1}`}),e.jsx("button",{className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-400 transition",onClick:g=>{g.preventDefault(),g.stopPropagation(),Ce(i.id,o)},type:"button",children:e.jsx(l,{icon:Se})})]},o)),R.length>0&&R.map((i,o)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer group",children:[e.jsx("img",{src:i,className:"object-cover w-full h-full transform transition-transform duration-300 group-hover:scale-110",alt:`Selected Image ${o+1}`}),e.jsx("button",{className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-400 transition",onClick:g=>le(o,g),type:"button",children:e.jsx(l,{icon:Se})})]},o))]})]})]}),e.jsx(_e,{className:"flex justify-end space-x-2 mt-6",children:e.jsx(W,{type:"submit",className:"bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center gap-2 px-6 py-2",disabled:te,children:te?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save Changes"})})})})]})]})}function gs(){const[s,v]=t.useState(!1),[x,f]=t.useState([]),[h,y]=t.useState(""),[w,K]=t.useState(10),[C,T]=t.useState(null),E=qe(),P=async()=>{try{const n=await ie.get("property-listings",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});f(n.data.property)}catch(n){console.error("Error fetching data:",n),O.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),E("/")}};t.useEffect(()=>{P()},[]);const L=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),D=x.filter(n=>n.category.toLowerCase().includes(h.toLowerCase())||n.location.toLowerCase().includes(h.toLowerCase())||n.type_of_listing.toLowerCase().includes(h.toLowerCase())||n.status.toLowerCase().includes(h.toLowerCase())||L.format(new Date(n.date_listed)).toLowerCase().includes(h.toLowerCase())).slice(0,w);return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0  gap-2 items-start justify-center mr-5 md:px-2 ",children:[e.jsx(es,{}),e.jsxs(Ge,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left md:w-[380px]",children:[e.jsx(He,{children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 justify-between",children:[e.jsxs("div",{className:"flex flex-col items-start bg-gradient-to-r from-blue-100 to-blue-200 px-4 py-2 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-xs text-blue-700 font-semibold",children:"Total Properties"}),e.jsx("span",{className:"text-2xl font-bold text-blue-900",children:x.length})]}),e.jsx("div",{className:"flex items-center",children:e.jsx(ss,{isOpen:s,fetchPropertiesData:P,onClose:()=>v(!1)})})]})}),e.jsxs(Je,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(oe,{onValueChange:n=>K(n==="all"?x.length:parseInt(n,10)),children:[e.jsxs(ce,{className:"w-[120px] border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(de,{placeholder:"All"})]}),e.jsxs(me,{children:[e.jsx(c,{value:"all",children:"All"}),e.jsx(c,{value:"5",children:"5"}),e.jsx(c,{value:"10",children:"10"}),e.jsx(c,{value:"20",children:"20"}),e.jsx(c,{value:"30",children:"30"}),e.jsx(c,{value:"40",children:"40"}),e.jsx(c,{value:"50",children:"50"})]})]}),e.jsx(b,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:h,onChange:n=>y(n.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Ye,{children:[e.jsx(Xe,{className:"bg-primary text-base",children:e.jsxs(Pe,{children:[e.jsx(M,{children:"#"}),e.jsx(M,{children:"Category"}),e.jsx(M,{children:"Date Listed"}),e.jsx(M,{children:"Location"}),e.jsx(M,{children:"Type"}),e.jsx(M,{children:"Status"}),e.jsx(M,{className:"text-right",children:"Action"})]})}),e.jsxs(Ze,{children:[D.length===0&&e.jsx(Pe,{children:e.jsx(k,{colSpan:7,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),D.map((n,_)=>e.jsxs(Pe,{children:[e.jsx(k,{className:"font-medium border border-[#bfdbfe]",children:_+1}),e.jsx(k,{className:"font-medium border border-[#bfdbfe]",children:n.category}),e.jsx(k,{className:"border border-[#bfdbfe]",children:L.format(new Date(n.date_listed))}),e.jsx(k,{className:"border border-[#bfdbfe]",children:n.location}),e.jsx(k,{className:"border border-[#bfdbfe]",children:n.type_of_listing}),e.jsx(k,{className:"border border-[#bfdbfe]",children:n.status==="Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:n.status}):n.status==="Not Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:n.status}):n.status==="Pre-Selling"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-red-700/10 ring-inset",children:n.status}):n.status==="RFO"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Ready for Occupancy"}):null}),e.jsx(k,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(as,{property:n,dateFormatter:L}),e.jsxs(ue,{children:[e.jsx(De,{onClick:()=>T(n),children:e.jsx(W,{className:"h-8 w-8 rounded-md font-medium bg-green-500 hover:bg-green-400 text-sm",children:e.jsx(l,{icon:ze})})}),C&&e.jsx(ls,{property:C,onClose:()=>T(null),fetchPropertiesData:P},C.id)]}),e.jsx(W,{className:"h-8 w-8 rounded-md font-medium bg-red-500 hover:bg-red-400 text-sm flex items-center justify-center",onClick:async()=>{if((await O.fire({icon:"warning",title:"Are you sure?",text:"This action will permanently delete the property. Continue?",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed)try{const I=await ie.delete(`property-listings/${n.id}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});O.fire({icon:"success",title:"Success",text:I.data.message,timerProgressBar:!0,timer:2e3,showConfirmButton:!1}),P()}catch(I){console.error("Error deleting property:",I),O.fire({icon:"error",title:"Error",text:"Failed to delete property. Please try again.",confirmButtonText:"OK"})}},children:e.jsx(l,{icon:Ve})})]})})]},n.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",D.length," of ",x.length," entries"]})})})]})]})]})})}export{gs as default};
