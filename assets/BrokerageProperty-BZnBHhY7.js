import{j as e,L as ye,r as s,B as se,F as xe,$ as Ne,a2 as we,d as he,S as te,a as Se,u as Ce,a1 as Pe}from"./index-B1xux7nW.js";import{c as Le,C as De,b as _e}from"./card-BENweYTJ.js";import{B as Ie,a as Ae,b as Ee,c as Re}from"./breadcrumb-CXSnjQSM.js";import{L as c}from"./label-8qc7pw4D.js";import{S as J,a as U,b as z,c as W,d as r}from"./select-S8dYOqu_.js";import{I as p}from"./input-DilSF8vW.js";import{D as ae,a as pe,b as re,c as le,d as ne,g as ie,e as ve,T as Te,h as Fe,i as je,j as H,k as ke,l as T}from"./dialog-DXga8jYz.js";import{T as be}from"./textarea-vipqo2i6.js";function Be(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Ie,{children:e.jsxs(Ae,{children:[e.jsx(Ee,{className:"text-accent",children:e.jsx(ye,{to:"/admin/brokerage-property",children:"Property Listing"})}),e.jsx(Re,{})]})})})})}function fe(t){return t.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Oe({onClose:t,fetchPropertiesData:f}){const[x,g]=s.useState(""),[u,y]=s.useState(null),[v,Q]=s.useState(()=>new Date().toISOString().split("T")[0]),[N,L]=s.useState(""),[w,F]=s.useState(""),[S,k]=s.useState(""),[D,B]=s.useState(""),[_,C]=s.useState(""),[O,b]=s.useState(""),[I,a]=s.useState([]),[A,P]=s.useState([]),[E,R]=s.useState(!1),[d,$]=s.useState({}),[K,M]=s.useState(!1),[q,X]=s.useState(null),[Y,oe]=s.useState(""),[Z,ce]=s.useState(""),V=s.useRef(null),ue=n=>{const l=n.target.value.replace(/,/g,"");/^\d*$/.test(l)&&oe(l)},i=n=>{const l=n.target.value.replace(/,/g,"");/^\d*$/.test(l)&&ce(l)},o=n=>{y(null);const l=n.target.files;if(l){const m=Array.from(l),j=["image/jpeg","image/png","image/jpg"];if(m.find(ge=>!j.includes(ge.type))){y("Only JPG, JPEG, and PNG files are allowed."),a([]),P([]),V.current&&(V.current.value="");return}a(m);const de=[];m.forEach(ge=>{const me=new FileReader;me.onload=()=>{me.result&&(de.push(me.result),P([...de]))},me.readAsDataURL(ge)})}},h=(n,l)=>{l.preventDefault();const m=I.filter((j,ee)=>ee!==n);if(a(m),P(j=>j.filter((ee,de)=>de!==n)),V.current){const j=new DataTransfer;m.forEach(ee=>j.items.add(ee)),V.current.files=j.files}},G=async n=>{if(n.preventDefault(),E)return;const l={};if(x||(l.category="Category is required."),v||(l.dateListed="Date listed is required."),N||(l.lotArea="Lot area is required."),w||(l.floorArea="Floor area is required."),S||(l.otherDetails="Other details are required."),D||(l.location="Location is required."),_||(l.type="Type of listing is required."),O||(l.status="Status is required."),I.length===0&&(l.images="At least one image is required."),x==="Rental Properties"&&!Y&&(l.rentalRate="Rental rate is required."),x==="Commercial Properties"&&!Z&&(l.sellingPrice="Selling price is required."),$(l),Object.keys(l).length>0)return;R(!0);const m=new FormData;m.append("category",x),m.append("date_listed",v),m.append("lot_area",N),m.append("floor_area",w),m.append("details",S),m.append("location",D),m.append("type_of_listing",_),m.append("status",O),x==="Rental Properties"?m.append("price_and_rate",Y):x==="Commercial Properties"?m.append("price_and_rate",Z):m.append("price_and_rate",""),I.forEach(j=>{m.append("images[]",j)});try{await he.post("property-listings",m,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),M(!1),f(),te.fire({icon:"success",title:"Success",text:"Property listing created successfully.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),g(""),L(""),F(""),k(""),B(""),C(""),b(""),a([]),P([]),oe(""),ce(""),t()}catch(j){console.error("Error creating property listing:",j),te.fire({icon:"error",title:"Error",text:"There was an error creating the property listing. Please try again."})}finally{R(!1)}};return e.jsxs(ae,{open:K,onOpenChange:M,children:[e.jsx(pe,{children:e.jsxs(se,{className:"",children:[e.jsx(xe,{icon:Ne}),"Add Brokerage"]})}),e.jsx(re,{className:"md:w-[90%] overflow-auto max-h-[95%]",children:e.jsxs(le,{className:"text-start",children:[e.jsx(ne,{children:"Add New Property Listing"}),e.jsx(ie,{children:e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Category"}),e.jsxs(J,{value:x,onValueChange:g,children:[e.jsx(U,{children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(W,{children:[e.jsx(r,{value:"Lot only",children:"Lot only"}),e.jsx(r,{value:"House and lot",children:"House and lot"}),e.jsx(r,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(r,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(r,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(r,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(r,{value:"Block and lot",children:"Block and lot"})]})]}),d.category&&e.jsx("p",{className:"text-red-500 text-sm",children:d.category})]}),x==="Rental Properties"&&e.jsxs("div",{children:[e.jsx(c,{children:"Rental Rate"}),e.jsx(p,{type:"text",value:fe(Y),onChange:ue,placeholder:"0.00"}),d.rentalRate&&e.jsx("p",{className:"text-red-500 text-sm",children:d.rentalRate})]}),x==="Commercial Properties"&&e.jsxs("div",{children:[e.jsx(c,{children:"Selling Price"}),e.jsx(p,{type:"text",value:fe(Z),onChange:i,placeholder:"0.00"}),d.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm",children:d.sellingPrice})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Date Listed"}),e.jsx(p,{type:"date",value:v,onChange:n=>Q(n.target.value)}),d.dateListed&&e.jsx("p",{className:"text-red-500 text-sm",children:d.dateListed})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Lot Area (sqm)"}),e.jsx(p,{type:"number",value:N,onChange:n=>L(n.target.value)}),d.lotArea&&e.jsx("p",{className:"text-red-500 text-sm",children:d.lotArea})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Floor Area (sqm)"}),e.jsx(p,{type:"number",value:w,onChange:n=>F(n.target.value)}),d.floorArea&&e.jsx("p",{className:"text-red-500 text-sm",children:d.floorArea})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Other Details"}),e.jsx(be,{value:S,onChange:n=>k(n.target.value),className:"w-full border rounded-md p-2",rows:3}),d.otherDetails&&e.jsx("p",{className:"text-red-500 text-sm",children:d.otherDetails})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Location"}),e.jsx(p,{type:"text",value:D,onChange:n=>B(n.target.value)}),d.location&&e.jsx("p",{className:"text-red-500 text-sm",children:d.location})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Type of Listing"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(c,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Exclusive",checked:_==="Exclusive",onChange:n=>C(n.target.value)}),e.jsx("span",{children:"Exclusive"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Non-Exclusive",checked:_==="Non-Exclusive",onChange:n=>C(n.target.value)}),e.jsx("span",{children:"Non-Exclusive"})]})]}),d.type&&e.jsx("p",{className:"text-red-500 text-sm",children:d.type})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Status of Property"}),e.jsxs(J,{value:O,onValueChange:b,children:[e.jsx(U,{children:e.jsx(z,{placeholder:"Select status"})}),e.jsxs(W,{children:[e.jsx(r,{value:"Sold",children:"Sold"}),e.jsx(r,{value:"Not Sold",children:"Not Sold"}),e.jsx(r,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(r,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),d.status&&e.jsx("p",{className:"text-red-500 text-sm",children:d.status})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold flex items-center gap-1",children:["Upload Property Images ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"text-xs font-normal text-red-600 ml-2",children:"(JPG, JPEG, PNG only)"})]}),e.jsx(p,{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:o,ref:V,className:u||d.images?"border-red-500":""}),(u||d.images)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u||d.images}),e.jsx("div",{className:"flex space-x-2 mt-2",children:A.map((n,l)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",children:[e.jsx("img",{src:n,alt:`Preview ${l+1}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",onClick:()=>X(n)}),e.jsx("button",{className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center",onClick:m=>h(l,m),children:e.jsx(xe,{icon:we})})]},l))}),q&&e.jsx(ae,{open:!!q,onOpenChange:()=>X(null),children:e.jsx(re,{className:"max-w-[425px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(le,{className:"text-start",children:[e.jsx(ne,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(ie,{children:e.jsx("img",{src:q,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]})]}),e.jsx(ve,{className:"flex justify-end space-x-2",children:e.jsx(se,{type:"submit",disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Submit"})})})})]})})]})})]})}function $e(t){if(t==null)return"";const f=t.toString().replace(/[^0-9.]/g,""),[x,g]=f.split("."),u=x.replace(/\B(?=(\d{3})+(?!\d))/g,",");return g!==void 0?`${u}.${g}`:u}function qe({property:t,dateFormatter:f}){const[x,g]=s.useState(null),u=t.category==="Commercial Properties"||t.category==="Rental Properties";return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx(pe,{children:e.jsx(se,{className:"h-8 w-8 font-medium bg-blue-500 hover:bg-blue-400 text-sm rounded-md",children:e.jsx(xe,{icon:Se})})}),e.jsx(re,{className:"md:max-w-[400px] p-6 overflow-auto max-h-[95%] bg-white rounded-lg shadow-lg",children:e.jsxs(le,{className:"text-start",children:[e.jsx(ne,{className:"text-xl font-bold mb-4",children:"View Property Listing"}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"General Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",t.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date Listed:"})," ",f.format(new Date(t.date_listed))]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",t.location]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type of Listing:"})," ",t.type_of_listing]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),u&&e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ",$e(t.price_and_rate)]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Description of Property"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lot Area:"})," ",t.lot_area," sqm"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Floor Area:"})," ",t.floor_area," sqm"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Other Details:"})," ",t.details||"N/A"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Property Images"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 flex-wrap mt-4",children:t.property_images&&t.property_images.length>0?t.property_images.map((y,v)=>e.jsx("div",{className:"w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",onClick:()=>g(`https://athomes.site/${y.images}`),children:e.jsx("img",{src:`https://athomes.site/${y.images}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",alt:`Property Image ${v+1}`})},v)):e.jsx("p",{children:"No images available"})})]})]})})]})})]}),x&&e.jsx(ae,{open:!!x,onOpenChange:()=>g(null),children:e.jsx(re,{className:"max-w-[425px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(le,{className:"text-start",children:[e.jsx(ne,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(ie,{children:e.jsx("img",{src:x,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]})}function Ve(t){return t.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Ge({property:t,onClose:f,fetchPropertiesData:x}){const[g,u]=s.useState(""),[y,v]=s.useState(""),[Q,N]=s.useState(""),[L,w]=s.useState(""),[F,S]=s.useState(""),[k,D]=s.useState(""),[B,_]=s.useState(""),[C,O]=s.useState(""),[b,I]=s.useState(""),[a,A]=s.useState([]),[P,E]=s.useState([]),[R,d]=s.useState([]),$=s.useRef(null),[K,M]=s.useState(!1),[q,X]=s.useState(null),Y=i=>{const o=i.target.value.replace(/,/g,"");/^\d*$/.test(o)&&I(o)};s.useEffect(()=>{t&&(u(t.category||""),v(t.date_listed||""),N(t.location||""),w(t.type_of_listing||""),S(t.status||""),D(t.lot_area||""),_(t.floor_area||""),O(t.details||""),I(t.price_and_rate?t.price_and_rate.toString():""),d(t.property_images||[]))},[t]);const oe=i=>{X(null);const o=i.target.files;if(o){const h=Array.from(o),G=["image/jpeg","image/png","image/jpg"];if(h.find(m=>!G.includes(m.type))){E([]),A([]),X("Only JPG, JPEG, and PNG files are allowed."),$.current&&($.current.value="");return}A(h);const l=[];h.forEach(m=>{const j=new FileReader;j.onload=()=>{j.result&&(l.push(j.result),E([...l]))},j.readAsDataURL(m)})}},Z=(i,o)=>{o.preventDefault(),o.stopPropagation();const h=P.filter((n,l)=>l!==i);E(h);const G=a.filter((n,l)=>l!==i);if(A(G),$.current){const n=new DataTransfer;G.forEach(l=>n.items.add(l)),$.current.files=n.files}},ce=i=>{d(i)},V=async i=>{if(K)return;M(!0),i.preventDefault();const o=new FormData;o.append("category",g),o.append("date_listed",y),o.append("lot_area",k),o.append("floor_area",B),o.append("details",C),o.append("location",Q),o.append("type_of_listing",L),o.append("status",F),o.append("price_and_rate",b),a.forEach(h=>{o.append("images[]",h)});try{await he.post(`property-listings/${t.id}?_method=PUT`,o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),x(),f(),te.fire({icon:"success",title:"Success",text:"Property listing updated successfully.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(h){console.error("Error updating property:",h)}finally{M(!1)}},ue=async(i,o)=>{try{await he.delete(`property-listings/${i}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});const h=R.filter((G,n)=>n!==o);ce(h),x()}catch(h){console.error("Error deleting image:",h),te.fire({icon:"error",title:"Error",text:"Failed to delete image."})}};return e.jsxs(re,{className:"md:max-w-[400px] overflow-auto max-h-[95%] p-6 bg-white rounded-lg shadow-lg",children:[e.jsxs(le,{className:"text-start",children:[e.jsx(ne,{className:"text-xl font-bold",children:"Edit Brokerage Listing"}),e.jsx(ie,{children:"Make changes to your brokerage here. Click save when you're done."})]}),e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Category"}),e.jsxs(J,{value:g,onValueChange:u,children:[e.jsx(U,{className:"col-span-3",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(W,{children:[e.jsx(r,{value:"Lot only",children:"Lot only"}),e.jsx(r,{value:"House and lot",children:"House and lot"}),e.jsx(r,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(r,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(r,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(r,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(r,{value:"Block and lot",children:"Block and lot"})]})]})]}),(g==="Commercial Properties"||g==="Rental Properties")&&e.jsxs("div",{children:[e.jsx(c,{children:g==="Commercial Properties"?"Selling Price":"Rental Rate"}),e.jsx(p,{type:"text",value:Ve((b==null?void 0:b.toString())||""),onChange:Y,placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Date Listed"}),e.jsx(p,{type:"date",value:y,onChange:i=>v(i.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Location"}),e.jsx(p,{type:"text",value:Q,onChange:i=>N(i.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Type of Listing"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(c,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Exclusive",checked:L==="Exclusive",onChange:i=>w(i.target.value)}),e.jsx("span",{children:"Exclusive"})]}),e.jsxs(c,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Non-Exclusive",checked:L==="Non-Exclusive",onChange:i=>w(i.target.value)}),e.jsx("span",{children:"Non-Exclusive"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Status"}),e.jsxs(J,{value:F,onValueChange:S,children:[e.jsx(U,{children:e.jsx(z,{placeholder:"Select status"})}),e.jsxs(W,{children:[e.jsx(r,{value:"Sold",children:"Sold"}),e.jsx(r,{value:"Not Sold",children:"Not Sold"}),e.jsx(r,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(r,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Lot Area (sqm)"}),e.jsx(p,{type:"text",value:k,onChange:i=>D(i.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Floor Area (sqm)"}),e.jsx(p,{type:"text",value:B,onChange:i=>_(i.target.value)})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Other Details"}),e.jsx(be,{value:C,onChange:i=>O(i.target.value),className:"w-full border rounded-md p-2",rows:3})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold flex items-center gap-1",children:["Upload Property Images ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"text-xs font-normal text-red-600  ml-2",children:"(JPG, JPEG, PNG only)"})]}),e.jsx(p,{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:oe,ref:$,className:q?"border-red-500":"",required:!0}),q&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:q}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mt-2",children:[R.length>0&&R.map((i,o)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",children:[e.jsx("img",{src:`https://athomes.site/${i.images}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",alt:`Property Image ${o+1}`}),e.jsx("button",{className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center",onClick:h=>{h.preventDefault(),h.stopPropagation(),ue(i.id,o)},children:"×"})]},o)),P.length>0&&P.map((i,o)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",children:[e.jsx("img",{src:i,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",alt:`Selected Image ${o+1}`}),e.jsx("button",{className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center",onClick:h=>Z(o,h),children:"×"})]},o))]})]})]}),e.jsx(ve,{className:"flex justify-end space-x-2",children:e.jsx(se,{type:"submit",className:"bg-blue-500 hover:bg-blue-400 text-white",disabled:K,children:K?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save Changes"})})})})]})]})}function Xe(){const[t,f]=s.useState(!1),[x,g]=s.useState([]),[u,y]=s.useState(""),[v,Q]=s.useState(10),[N,L]=s.useState(null),[w,F]=s.useState("all"),[S,k]=s.useState(""),[D,B]=s.useState("all"),_=Ce(),C=async()=>{try{const a=await he.get("property-listings",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});g(a.data.property)}catch(a){console.error("Error fetching data:",a),te.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),_("/")}};s.useEffect(()=>{C()},[]);const b=x.filter(a=>{const A=w==="all"||a.category===w,P=!S||new Date(a.date_listed).toISOString().split("T")[0]===S,E=D==="all"||a.status===D,R=a.category.toLowerCase().includes(u.toLowerCase())||a.location.toLowerCase().includes(u.toLowerCase())||a.type_of_listing.toLowerCase().includes(u.toLowerCase())||a.status.toLowerCase().includes(u.toLowerCase());return A&&P&&E&&R}).slice(0,v),I=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"});return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0  gap-2 items-start justify-center mr-5 md:px-2 ",children:[e.jsx(Be,{}),e.jsxs(Le,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left md:w-[380px]",children:[e.jsx(De,{children:e.jsxs("div",{className:"flex flex-row md:flex-col gap-4 justify-between",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-1 gap-4 md:mt-0",children:[e.jsxs("div",{className:"grid w-full gap-1.5",children:[e.jsx(c,{children:"Category"}),e.jsxs(J,{onValueChange:F,children:[e.jsx(U,{className:"md:w-full ",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(W,{children:[e.jsx(r,{value:"all",children:"All"}),e.jsx(r,{value:"Lot only",children:"Lot only"}),e.jsx(r,{value:"House and lot",children:"House and lot"}),e.jsx(r,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(r,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(r,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(r,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(r,{value:"Block and lot",children:"Block and lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(c,{children:"Date Listed"}),e.jsx(p,{type:"date",className:"md:w-full",value:S,onChange:a=>k(a.target.value)})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(c,{children:"Filter Status"}),e.jsxs(J,{onValueChange:B,children:[e.jsx(U,{children:e.jsx(z,{placeholder:"Select status"})}),e.jsxs(W,{children:[e.jsx(r,{value:"all",children:"All"}),e.jsx(r,{value:"Sold",children:"Sold"}),e.jsx(r,{value:"Not Sold",children:"Not Sold"})]})]})]})]}),e.jsx("div",{className:"md:flex md:justify-end md:items-center md:w-full",children:e.jsx(Oe,{isOpen:t,fetchPropertiesData:C,onClose:()=>f(!1)})})]})}),e.jsxs(_e,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(J,{onValueChange:a=>Q(a==="all"?x.length:parseInt(a,10)),children:[e.jsxs(U,{className:"w-[120px] border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(z,{placeholder:"All"})]}),e.jsxs(W,{children:[e.jsx(r,{value:"all",children:"All"}),e.jsx(r,{value:"5",children:"5"}),e.jsx(r,{value:"10",children:"10"}),e.jsx(r,{value:"20",children:"20"}),e.jsx(r,{value:"30",children:"30"}),e.jsx(r,{value:"40",children:"40"}),e.jsx(r,{value:"50",children:"50"})]})]}),e.jsx(p,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:u,onChange:a=>y(a.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Te,{children:[e.jsx(Fe,{className:"bg-primary text-base",children:e.jsxs(je,{children:[e.jsx(H,{children:"#"}),e.jsx(H,{children:"Category"}),e.jsx(H,{children:"Date Listed"}),e.jsx(H,{children:"Location"}),e.jsx(H,{children:"Type"}),e.jsx(H,{children:"Status"}),e.jsx(H,{className:"text-right",children:"Action"})]})}),e.jsxs(ke,{children:[b.length===0&&e.jsx(je,{children:e.jsx(T,{colSpan:7,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),b.map((a,A)=>e.jsxs(je,{children:[e.jsx(T,{className:"font-medium border border-[#bfdbfe]",children:A+1}),e.jsx(T,{className:"font-medium border border-[#bfdbfe]",children:a.category}),e.jsx(T,{className:"border border-[#bfdbfe]",children:I.format(new Date(a.date_listed))}),e.jsx(T,{className:"border border-[#bfdbfe]",children:a.location}),e.jsx(T,{className:"border border-[#bfdbfe]",children:a.type_of_listing}),e.jsx(T,{className:"border border-[#bfdbfe]",children:a.status==="Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:a.status}):a.status==="Not Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:a.status}):a.status==="Pre-Selling"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-red-700/10 ring-inset",children:a.status}):a.status==="RFO"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Ready for Occupancy"}):null}),e.jsx(T,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(qe,{property:a,dateFormatter:I}),e.jsxs(ae,{children:[e.jsx(pe,{onClick:()=>L(a),children:e.jsx(se,{className:"h-8 w-8 rounded-md font-medium bg-green-500 hover:bg-green-400 text-sm",children:e.jsx(xe,{icon:Pe})})}),N&&e.jsx(Ge,{property:N,onClose:()=>L(null),fetchPropertiesData:C},N.id)]})]})})]},a.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",b.length," of ",x.length," entries"]})})})]})]})]})})}export{Xe as default};
