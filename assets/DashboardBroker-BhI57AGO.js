import{r,j as e,F as c,af as A,ab as I,ac as T,ad as $,ae as M,ag as C,ah as L,ai as k,aj as R,d as D,e as E,u as z,c as B,S as F}from"./index-xgvVzwjv.js";import{f as U}from"./dateUtils-D6w6W0GJ.js";import{c as j,C as _,a as v,b as y}from"./card-DfGv4U6O.js";import{C as G}from"./react-apexcharts.min-BCszHVwW.js";import{I as P}from"./input-D7RsSNb2.js";function H({chartData:d,totalSales:x,currencyFormatter:n}){const[m,i]=r.useState(!1),l={series:[{name:"Sales",data:d}],options:{chart:{type:"line",height:350,toolbar:{show:!1},zoom:{enabled:!1},background:"transparent"},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{style:{colors:"#64748b",fontWeight:500}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"#64748b",fontWeight:500}}},stroke:{curve:"smooth",width:3,colors:["#2563eb"]},markers:{size:5,colors:["#2563eb"],strokeColors:"#fff",strokeWidth:2,hover:{size:7}},grid:{borderColor:"#e0e7ef",strokeDashArray:4,yaxis:{lines:{show:!0}},xaxis:{lines:{show:!1}}},title:{text:"Sales from January to December",align:"left",style:{fontSize:"16px",fontWeight:600,color:"#172554"}},tooltip:{theme:"light",y:{formatter:s=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s)}},colors:["#2563eb"]}};return r.useEffect(()=>{i(!0)},[]),e.jsxs(j,{className:"bg-gradient-to-br from-green-50 to-blue-50 border-b-4 border-primary w-full md:w-full shadow-xl rounded-2xl",children:[e.jsxs(_,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-blue-100 p-3 shadow",children:e.jsx(c,{icon:A,className:"text-blue-600 text-xl"})}),e.jsx(v,{className:"text-xl font-bold text-primary",children:"Total Sales"})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-200 px-3 py-1 text-xs font-semibold text-blue-700 shadow",children:n.format(x)})]}),e.jsxs(y,{children:[e.jsx("div",{className:"w-full mt-2",children:m&&e.jsx(G,{options:l.options,series:l.series,type:"line",height:320})}),e.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[e.jsxs("span",{className:"text-green-600 text-2xl font-bold",children:["+ ",n.format(x)]}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Total sales for the year"})]})]})]})}function W({topPerformers:d,currencyFormatter:x}){const[n,m]=r.useState(""),i=r.useMemo(()=>{if(!n.trim())return d;const s=n.toLowerCase();return d.filter(a=>[a.first_name,a.middle_name,a.last_name,a.extension_name,a.role,a.profile_pic,String(a.totalReserved),String(a.totalSales)].filter(Boolean).join(" ").toLowerCase().includes(s))},[n,d]),l=s=>s===1?"bg-green-400 text-white":s===2?"bg-gray-300 text-gray-800":s===3?"bg-orange-400 text-white":"bg-blue-100 text-blue-700";return e.jsx(j,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full",children:e.jsxs(y,{className:"flex flex-col h-[400px]",children:[e.jsxs("div",{className:"py-5 flex flex-row justify-between items-center flex-shrink-0",children:[e.jsx(v,{children:"Top Affiliated Rankings"}),e.jsx(P,{type:"text",placeholder:"Search",className:"w-52",value:n,onChange:s=>m(s.target.value)})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 h-full",children:[i.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No data available"}),i.map((s,a)=>{var g,N;return e.jsx(j,{className:"flex flex-col h-full bg-white border border-[#bfdbfe] rounded-xl shadow hover:shadow-lg transition",children:e.jsxs(y,{className:"flex flex-col gap-2 p-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold shadow ${l(a+1)}`,children:[e.jsx(c,{icon:I,className:"mr-1"}),"Rank ",a+1]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-700 text-xs font-semibold",children:[e.jsx(c,{icon:T,className:"mr-1"}),s.role]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-primary",children:[s.profile_pic?e.jsx("img",{src:`https://athomes.site/${s.profile_pic}`,alt:"User Avatar",className:"w-8 h-8 rounded-full object-cover border-2 border-primary"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center font-bold text-base border-2 border-primary",children:`${((g=s.first_name)==null?void 0:g.charAt(0))??""}${((N=s.last_name)==null?void 0:N.charAt(0))??""}`}),e.jsxs("span",{children:[s.first_name," ",s.middle_name?s.middle_name+" ":"",s.last_name," ",s.extension_name]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(c,{icon:$,className:"text-green-500"}),e.jsx("span",{className:"font-medium",children:"Total Reserved:"}),e.jsx("span",{className:"font-bold",children:s.totalReserved})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(c,{icon:M,className:"text-indigo-400"}),e.jsx("span",{className:"font-medium",children:"Total Sales:"}),e.jsx("span",{className:"font-bold text-green-700",children:x.format(s.totalSales)})]})]})},s.id)})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3 flex-shrink-0",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing ",i.length===0?0:1," to ",i.length," of ",i.length," entries"]})})})]})})}function J({sales:d,formatDateToMMDDYYYYDateApproved:x,currencyFormatter:n}){const[m,i]=r.useState(""),l=r.useMemo(()=>{if(!m.trim())return d;const s=m.toLowerCase();return d.filter(a=>[a.category,a.remarks,x(a.date_on_sale),String(a.amount)].filter(Boolean).join(" ").toLowerCase().includes(s))},[m,d,x]);return e.jsx(j,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full",children:e.jsxs(y,{className:"flex flex-col h-[400px]",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center py-5 flex-shrink-0",children:[e.jsx(v,{children:"Top 5 Recent Sales"}),e.jsx(P,{type:"text",placeholder:"Search",className:"w-52",value:m,onChange:s=>i(s.target.value)})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-4",children:[l.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No data available"}),l.map(s=>e.jsx(j,{className:"bg-white border border-[#bfdbfe] rounded-xl shadow hover:shadow-lg transition flex flex-col",children:e.jsxs(y,{className:"flex flex-col gap-2 p-4",children:[e.jsxs("span",{className:"inline-block bg-yellow-100 text-yellow-800 text-[11px] font-semibold px-3 py-1 rounded-full mb-1",children:["Reservation Date: ",x(s.date_on_sale)]}),e.jsx("div",{className:"font-semibold text-lg text-[#172554] truncate",children:s.category}),e.jsx("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-semibold px-3 py-1 rounded-full mb-1",children:s.remarks}),e.jsxs("div",{className:"flex flex-row justify-between items-end mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Amount"}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:n.format(s.amount)})]})]})},s.id))]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3 flex-shrink-0",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing ",l.length===0?0:1," to ",l.length," of ",l.length," entries"]})})})]})})}const V=({topPropoerty:d})=>{const[x,n]=r.useState("recent"),[m,i]=r.useState(null),[l,s]=r.useState(null),[a,g]=r.useState(0),N=({url:t,onClose:o})=>e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",children:e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl p-4 max-w-full max-h-full flex flex-col items-center",children:[e.jsx("button",{className:"absolute top-2 right-2 text-white bg-red-500 rounded-full px-3 py-1 text-xl hover:bg-red-400 transition",onClick:o,children:"×"}),e.jsx("img",{src:t,alt:"Preview",className:"max-h-[80vh] max-w-[90vw] rounded-xl shadow-lg"})]})}),S=({images:t,index:o,onClose:u,onPrev:b,onNext:p})=>e.jsx("div",{className:"fixed inset-0  z-50 flex items-center justify-center bg-black bg-opacity-90",children:e.jsxs("div",{className:"relative md:w-[90%] bg-white rounded-xl shadow-2xl p-4 max-w-full max-h-full flex flex-col items-center",children:[e.jsx("button",{className:"absolute top-2 right-2 text-white bg-red-500 rounded-full px-3 py-1 text-xl hover:bg-red-400 transition",onClick:u,children:"×"}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("button",{className:"mr-2 px-3 py-2 text-2xl font-bold text-white bg-primary rounded-full hover:bg-blue-500 transition disabled:opacity-30",onClick:b,disabled:o===0,children:e.jsx(c,{icon:D})}),e.jsx("img",{src:t[o],alt:`Gallery Preview ${o+1}`,className:"max-h-[70vh] max-w-[70vw] rounded-xl shadow-lg"}),e.jsx("button",{className:"ml-4 px-3 py-2 text-2xl font-bold text-white bg-primary rounded-full hover:bg-blue-500 transition disabled:opacity-30",onClick:p,disabled:o===t.length-1,children:e.jsx(c,{icon:E})})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-gray-700",children:[e.jsx(c,{icon:k}),e.jsxs("span",{className:"font-semibold",children:[o+1," / ",t.length]})]}),e.jsx("div",{className:"mt-2 flex gap-2",children:t.map((f,h)=>e.jsx("button",{className:`w-4 h-4 rounded-full border-2 ${h===o?"border-primary bg-primary":"border-gray-300 bg-gray-200"} transition`,onClick:()=>g(h),"aria-label":`Go to image ${h+1}`},f))})]})});return e.jsx(j,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-b-4 border-primary w-full md:w-full shadow-xl rounded-2xl h-full",children:e.jsxs(y,{className:"flex flex-col h-[500px]",children:[e.jsxs("div",{className:"py-5 flex flex-row justify-between items-center flex-shrink-0",children:[e.jsxs("div",{className:"flex flex-row gap-4 items-center",children:[e.jsx(v,{className:"text-base font-bold text-primary",children:"Property Listing"}),e.jsxs("span",{className:"inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-700 ring-2 ring-green-400/30 shadow",children:[e.jsx(c,{icon:C,className:"mr-1"}),"Newly added"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"property-view",value:"recent",checked:x==="recent",onChange:()=>n("recent"),className:"form-radio text-blue-600 accent-primary"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 font-medium",children:"Recently Listed"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"property-view",value:"all",checked:x==="all",onChange:()=>n("all"),className:"form-radio text-blue-600 accent-primary"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 font-medium",children:"View All"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:d.map((t,o)=>{const u=t.property_images||[],b=u.slice(0,3),p=u.length-3,f=u.map(h=>`https://athomes.site/${h.images}`);return e.jsxs(j,{className:"flex flex-col h-full bg-white border border-primary rounded-xl shadow-md hover:shadow-xl transition",children:[e.jsx(_,{className:"pb-0",children:e.jsx("div",{className:"flex items-center justify-center w-full",children:b.length>0?e.jsx("div",{className:"flex flex-row gap-3 py-3 w-full justify-center",children:b.map((h,w)=>e.jsxs("div",{className:"relative w-24 h-24 bg-gray-100 flex items-center justify-center rounded-xl shadow-md overflow-hidden cursor-pointer group",onClick:()=>{w===2&&p>0?(s(f),g(0)):i(`https://athomes.site/${h.images}`)},title:w===2&&p>0?"View all images":"Click to preview",children:[e.jsx("img",{src:`https://athomes.site/${h.images}`,className:"object-cover w-full h-full transition-transform duration-300 group-hover:scale-110",alt:`Property Image ${w+1}`}),w===2&&p>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-bold text-lg drop-shadow-lg",children:["+",p]})})]},h.id))}):e.jsx("div",{className:"w-24 h-24 bg-gray-200 flex items-center justify-center rounded-xl shadow-md",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No Image"})})})}),e.jsx(y,{className:"flex flex-col flex-1 justify-between",children:e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-primary",children:[e.jsx(c,{icon:C,className:"text-primary"}),t.name||`Property #${o+1}`]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(c,{icon:L,className:"text-blue-400"}),e.jsx("span",{className:"font-medium",children:"Location:"})," ",e.jsx("span",{className:"md:text-[12px] md:font-bold",children:t.location})]}),t.price&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(c,{icon:C,className:"text-green-500"}),e.jsx("span",{className:"font-medium",children:"Price:"})," ",e.jsxs("span",{className:"text-green-700 font-bold",children:["₱",t.price.toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(c,{icon:k,className:"text-indigo-400"}),e.jsx("span",{className:"font-medium",children:"Images:"})," ",u.length]}),t.created_at&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(c,{icon:R,className:"text-gray-400"}),e.jsx("span",{className:"font-medium",children:"Date created:"})," ",new Date(t.created_at).toLocaleDateString()]})]})})]},t.id)})})}),m&&e.jsx(N,{url:m,onClose:()=>i(null)}),l&&e.jsx(S,{images:l,index:a,onClose:()=>s(null),onPrev:()=>g(t=>Math.max(0,t-1)),onNext:()=>g(t=>l&&t<l.length-1?t+1:t)})]})})};function Z(){const[d,x]=r.useState([]),[n,m]=r.useState([]),[i,l]=r.useState([]),[s,a]=r.useState(Array(12).fill(0)),[g,N]=r.useState(0),S=z(),t=async()=>{try{const u=await B.get("user/broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),b=u.data.salesEncodingDashboardYearly.map(f=>({...f,amount:typeof f.amount=="number"?f.amount:parseFloat(f.amount)})),p=Array(12).fill(0);b.forEach(f=>{const h=new Date(f.date_on_sale).getMonth();p[h]+=f.amount}),a(p),x(u.data.topPerformers),m(u.data.property),l(u.data.salesEncodingTop5),N(b.reduce((f,h)=>f+h.amount,0))}catch{F.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),S("/")}};r.useEffect(()=>{t()},[]);const o=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"});return e.jsxs("div",{className:"py-5 md:pt-20",children:[e.jsx("div",{className:"flex justify-between md:flex-row",children:e.jsx("h1",{className:"text-4xl font-bold ml-72 md:ml-0 md:grid-cols-1 md:text-2xl md:gap-2 md:px-5 md:mt-0",children:"Dashboard"})}),e.jsxs("div",{className:"ml-72 md:ml-0 grid grid-cols-2 md:grid-cols-1 md:gap-4 md:p-6 md:mt-0 gap-4 items-start justify-center mt-6 md:px-6 mr-4",children:[e.jsx(H,{chartData:s,totalSales:g,currencyFormatter:o}),e.jsx(V,{topPropoerty:n})]}),e.jsxs("div",{className:"ml-72 md:ml-0 grid grid-cols-2 md:grid-cols-1 md:gap-4 md:p-6 md:mt-0 gap-4 items-start justify-center mt-6 md:px-6 mr-4",children:[e.jsx(J,{sales:i,formatDateToMMDDYYYYDateApproved:U,currencyFormatter:o}),e.jsx(W,{topPerformers:d,currencyFormatter:o})]})]})}export{Z as default};
