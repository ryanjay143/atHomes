import{r as i,j as e,F as m,au as A,as as D,ac as M,at as L,ah as R,a5 as P,a4 as E,ao as I,ad as F,e as z,g as B,u as U,d as G,S as H}from"./index-Dk1_FMbU.js";import{f as W}from"./dateUtils-D6w6W0GJ.js";import{c as b,C as T,a as S,b as j}from"./card-CBUDeD1Y.js";import{C as J}from"./react-apexcharts.min-BVJGaoTD.js";import{I as $}from"./input-lhyLM1nK.js";function O({chartData:o,totalSales:r,currencyFormatter:c}){const[f,d]=i.useState(!1),l={series:[{name:"Sales",data:o}],options:{chart:{type:"line",height:350,toolbar:{show:!1},zoom:{enabled:!1},background:"transparent"},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],labels:{style:{colors:"#64748b",fontWeight:500}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"#64748b",fontWeight:500}}},stroke:{curve:"smooth",width:3,colors:["#2563eb"]},markers:{size:5,colors:["#2563eb"],strokeColors:"#fff",strokeWidth:2,hover:{size:7}},grid:{borderColor:"#e0e7ef",strokeDashArray:4,yaxis:{lines:{show:!0}},xaxis:{lines:{show:!1}}},title:{text:"Sales from January to December",align:"left",style:{fontSize:"16px",fontWeight:600,color:"#172554"}},tooltip:{theme:"light",y:{formatter:s=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s)}},colors:["#2563eb"]}};return i.useEffect(()=>{d(!0)},[]),e.jsxs(b,{className:"bg-gradient-to-br from-green-50 to-blue-50 border-b-4 border-primary w-full md:w-full shadow-xl rounded-2xl",children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-blue-100 p-3 shadow",children:e.jsx(m,{icon:A,className:"text-blue-600 text-xl"})}),e.jsx(S,{className:"text-xl font-bold text-primary",children:"Total Sales"})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-200 px-3 py-1 text-xs font-semibold text-blue-700 shadow",children:c.format(r)})]}),e.jsxs(j,{children:[e.jsx("div",{className:"w-full mt-2",children:f&&e.jsx(J,{options:l.options,series:l.series,type:"line",height:320})}),e.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[e.jsxs("span",{className:"text-green-600 text-2xl font-bold",children:["+ ",c.format(r)]}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Total sales for the year"})]})]})]})}function V({topPerformers:o,currencyFormatter:r}){const[c,f]=i.useState(""),d=i.useMemo(()=>{if(!c.trim())return o;const s=c.toLowerCase();return o.filter(a=>[a.first_name,a.middle_name,a.last_name,a.extension_name,a.role,a.profile_pic,String(a.totalReserved),String(a.totalSales)].filter(Boolean).join(" ").toLowerCase().includes(s))},[c,o]),l=s=>s===1?"bg-green-400 text-white":s===2?"bg-gray-300 text-gray-800":s===3?"bg-orange-400 text-white":"bg-blue-100 text-blue-700";return e.jsx(b,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full",children:e.jsxs(j,{className:"flex flex-col h-[400px]",children:[e.jsxs("div",{className:"py-5 flex flex-row justify-between items-center flex-shrink-0",children:[e.jsx(S,{children:"Top Affiliated Rankings"}),e.jsx($,{type:"text",placeholder:"Search",className:"w-52",value:c,onChange:s=>f(s.target.value)})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 h-full",children:[d.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No data available"}),d.map((s,a)=>{var h,N;return e.jsx(b,{className:"flex flex-col h-full bg-white border border-[#bfdbfe] rounded-xl shadow hover:shadow-lg transition",children:e.jsxs(j,{className:"flex flex-col gap-2 p-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold shadow ${l(a+1)}`,children:[e.jsx(m,{icon:D,className:"mr-1"}),"Rank ",a+1]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-700 text-xs font-semibold",children:[e.jsx(m,{icon:M,className:"mr-1"}),s.role]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-primary",children:[s.profile_pic?e.jsx("img",{src:`http://192.168.1.9:8000/${s.profile_pic}`,alt:"User Avatar",className:"w-8 h-8 rounded-full object-cover border-2 border-primary"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center font-bold text-base border-2 border-primary",children:`${((h=s.first_name)==null?void 0:h.charAt(0))??""}${((N=s.last_name)==null?void 0:N.charAt(0))??""}`}),e.jsxs("span",{children:[s.first_name," ",s.middle_name?s.middle_name+" ":"",s.last_name," ",s.extension_name]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(m,{icon:L,className:"text-green-500"}),e.jsx("span",{className:"font-medium",children:"Total Reserved:"}),e.jsx("span",{className:"font-bold",children:s.totalReserved})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(m,{icon:R,className:"text-indigo-400"}),e.jsx("span",{className:"font-medium",children:"Total Sales:"}),e.jsx("span",{className:"font-bold text-green-700",children:r.format(s.totalSales)})]})]})},s.id)})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3 flex-shrink-0",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing ",d.length===0?0:1," to ",d.length," of ",d.length," entries"]})})})]})})}function K({sales:o,formatDateToMMDDYYYYDateApproved:r,currencyFormatter:c}){const[f,d]=i.useState(""),l=i.useMemo(()=>{if(!f.trim())return o;const s=f.toLowerCase();return o.filter(a=>[a.category,a.remarks,r(a.date_on_sale),String(a.amount)].filter(Boolean).join(" ").toLowerCase().includes(s))},[f,o,r]);return e.jsx(b,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full",children:e.jsxs(j,{className:"flex flex-col h-[400px]",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center py-5 flex-shrink-0",children:[e.jsx(S,{children:"Top 5 Recent Sales"}),e.jsx($,{type:"text",placeholder:"Search",className:"w-52",value:f,onChange:s=>d(s.target.value)})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-4",children:[l.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No data available"}),l.map(s=>e.jsx(b,{className:"bg-white border border-[#bfdbfe] rounded-xl shadow hover:shadow-lg transition flex flex-col",children:e.jsxs(j,{className:"flex flex-col gap-2 p-4",children:[e.jsxs("span",{className:"inline-block bg-yellow-100 text-yellow-800 text-[10px] font-bold px-3 py-1 rounded-full mb-1",children:["Reservation Date: ",r(s.date_on_sale)]}),e.jsx("div",{className:"font-semibold text-lg text-[#172554] truncate",children:s.category}),e.jsx("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-semibold px-3 py-1 rounded-full mb-1",children:s.remarks}),e.jsxs("div",{className:"flex flex-row justify-between items-end mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Amount"}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:c.format(s.amount)})]})]})},s.id))]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3 flex-shrink-0",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing ",l.length===0?0:1," to ",l.length," of ",l.length," entries"]})})})]})})}const q=({topPropoerty:o})=>{const[r,c]=i.useState("all"),[f,d]=i.useState(null),[l,s]=i.useState(null),[a,h]=i.useState(0),C=new Date().toISOString().split("T")[0],k=r==="all"?o:o.filter(t=>t.created_at?new Date(t.created_at).toISOString().split("T")[0]===C:!1),w=({url:t,onClose:x})=>e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",children:e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl p-4 max-w-full max-h-full flex flex-col items-center",children:[e.jsx("button",{className:"absolute top-2 right-2 text-white bg-red-500 rounded-full px-3 py-1 text-xl hover:bg-red-400 transition",onClick:x,children:"×"}),e.jsx("img",{src:t,alt:"Preview",className:"max-h-[80vh] max-w-[90vw] rounded-xl shadow-lg"})]})}),p=({images:t,index:x,onClose:n,onPrev:g,onNext:y})=>e.jsx("div",{className:"fixed inset-0  z-50 flex items-center justify-center bg-black bg-opacity-90",children:e.jsxs("div",{className:"relative md:w-[90%] bg-white rounded-xl shadow-2xl p-4 max-w-full max-h-full flex flex-col items-center",children:[e.jsx("button",{className:"absolute top-2 right-2 text-white bg-red-500 rounded-full px-3 py-1 text-xl hover:bg-red-400 transition",onClick:n,children:"×"}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("button",{className:"mr-2 px-3 py-2 text-2xl font-bold text-white bg-primary rounded-full hover:bg-blue-500 transition disabled:opacity-30",onClick:g,disabled:x===0,children:e.jsx(m,{icon:z})}),e.jsx("img",{src:t[x],alt:`Gallery Preview ${x+1}`,className:"max-h-[70vh] max-w-[70vw] rounded-xl shadow-lg"}),e.jsx("button",{className:"ml-4 px-3 py-2 text-2xl font-bold text-white bg-primary rounded-full hover:bg-blue-500 transition disabled:opacity-30",onClick:y,disabled:x===t.length-1,children:e.jsx(m,{icon:B})})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-gray-700",children:[e.jsx(m,{icon:I}),e.jsxs("span",{className:"font-semibold",children:[x+1," / ",t.length]})]}),e.jsx("div",{className:"mt-2 flex gap-2",children:t.map((_,u)=>e.jsx("button",{className:`w-4 h-4 rounded-full border-2 ${u===x?"border-primary bg-primary":"border-gray-300 bg-gray-200"} transition`,onClick:()=>h(u),"aria-label":`Go to image ${u+1}`},_))})]})});return e.jsx(b,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-b-4 border-primary w-full md:w-full shadow-xl rounded-2xl h-full",children:e.jsxs(j,{className:"flex flex-col h-[500px]",children:[e.jsxs("div",{className:"py-5 flex flex-col md:flex-row md:justify-between md:items-center gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex flex-row gap-4 items-center",children:[e.jsx(S,{className:"text-base font-bold text-primary tracking-wide",children:"Property Listing"}),e.jsxs("span",{className:"inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-xs md:text-[10px] font-semibold text-green-700 ring-2 ring-green-400/30 shadow",children:[e.jsx(m,{icon:P,className:"mr-1"}),"Newly added"]})]}),e.jsxs("div",{className:"flex items-center gap-4 md:gap-4 mt-2 md:mt-0",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"property-view",value:"all",checked:r==="all",onChange:()=>c("all"),className:"form-radio text-blue-600 accent-primary focus:ring-2 focus:ring-blue-400"}),e.jsx("span",{className:`ml-2 text-sm md:text-[10px] font-medium transition-colors duration-200 ${r==="all"?"text-blue-700 font-bold":"text-gray-700"}`,children:"View All"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"property-view",value:"recent",checked:r==="recent",onChange:()=>c("recent"),className:"form-radio text-blue-600 accent-primary focus:ring-2 focus:ring-blue-400"}),e.jsx("span",{className:`ml-2 text-sm md:text-[10px] font-medium transition-colors duration-200 ${r==="recent"?"text-blue-700 font-bold":"text-gray-700"}`,children:"Recently Listed"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:k.map((t,x)=>{const n=t.property_images||[],g=n.slice(0,3),y=n.length-3,_=n.map(u=>`http://192.168.1.9:8000/${u.images}`);return e.jsxs(b,{className:"flex flex-col h-full bg-white border border-primary rounded-xl shadow-md hover:shadow-xl transition",children:[e.jsx(T,{className:"pb-0",children:e.jsx("div",{className:"flex items-center justify-center w-full",children:g.length>0?e.jsx("div",{className:"flex flex-row gap-3 py-3 w-full justify-center",children:g.map((u,v)=>e.jsxs("div",{className:"relative w-24 h-24 bg-gray-100 flex items-center justify-center rounded-xl shadow-md overflow-hidden cursor-pointer group",onClick:()=>{v===2&&y>0?(s(_),h(0)):d(`http://192.168.1.9:8000/${u.images}`)},title:v===2&&y>0?"View all images":"Click to preview",children:[e.jsx("img",{src:`http://192.168.1.9:8000/${u.images}`,className:"object-cover w-full h-full transition-transform duration-300 group-hover:scale-110",alt:`Property Image ${v+1}`}),v===2&&y>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-bold text-lg drop-shadow-lg",children:["+",y]})})]},u.id))}):e.jsx("div",{className:"w-24 h-24 bg-gray-200 flex items-center justify-center rounded-xl shadow-md",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No Image"})})})}),e.jsx(j,{className:"flex flex-col flex-1 justify-between",children:e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-primary",children:[e.jsx(m,{icon:P,className:"text-primary"}),t.name||`Property #${x+1}`]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(m,{icon:E,className:"text-blue-400"}),e.jsx("span",{className:"font-medium",children:"Location:"})," ",e.jsx("span",{className:"md:text-[12px] md:font-bold",children:t.location})]}),t.price&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(m,{icon:P,className:"text-green-500"}),e.jsx("span",{className:"font-medium",children:"Price:"})," ",e.jsxs("span",{className:"text-green-700 font-bold",children:["₱",t.price.toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(m,{icon:I,className:"text-indigo-400"}),e.jsx("span",{className:"font-medium",children:"Images:"})," ",n.length]}),t.created_at&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(m,{icon:F,className:"text-gray-400"}),e.jsx("span",{className:"font-medium",children:"Date created:"})," ",new Date(t.created_at).toLocaleDateString()]})]})})]},t.id)})})}),f&&e.jsx(w,{url:f,onClose:()=>d(null)}),l&&e.jsx(p,{images:l,index:a,onClose:()=>s(null),onPrev:()=>h(t=>Math.max(0,t-1)),onNext:()=>h(t=>l&&t<l.length-1?t+1:t)})]})})};function se(){const[o,r]=i.useState([]),[c,f]=i.useState([]),[d,l]=i.useState([]),[s,a]=i.useState(Array(12).fill(0)),[h,N]=i.useState(0),C=U(),k=async()=>{try{const p=await G.get("user/broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),t=p.data.salesEncodingDashboardYearly.map(n=>({...n,amount:typeof n.amount=="number"?n.amount:parseFloat(n.amount)})),x=Array(12).fill(0);t.forEach(n=>{const g=new Date(n.date_on_sale).getMonth();x[g]+=n.amount}),a(x),r(p.data.topPerformers),f(p.data.property),l(p.data.salesEncodingTop5),N(t.reduce((n,g)=>n+g.amount,0))}catch{H.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),C("/")}};i.useEffect(()=>{k()},[]);const w=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-between md:flex-row",children:e.jsx("h1",{className:"text-4xl font-bold ml-72 md:ml-0 md:grid-cols-1 md:text-2xl md:gap-2 md:px-5 md:mt-0",children:"Dashboard"})}),e.jsxs("div",{className:"ml-72 md:ml-0 grid grid-cols-2 md:grid-cols-1 md:gap-4 md:p-6 md:mt-0 gap-4 items-start justify-center mt-6 md:px-6 mr-4",children:[e.jsx(O,{chartData:s,totalSales:h,currencyFormatter:w}),e.jsx(q,{topPropoerty:c})]}),e.jsxs("div",{className:"ml-72 md:ml-0 grid grid-cols-2 md:grid-cols-1 md:gap-4 md:p-6 md:mt-0 gap-4 items-start justify-center mt-6 md:px-6 mr-4",children:[e.jsx(K,{sales:d,formatDateToMMDDYYYYDateApproved:W,currencyFormatter:w}),e.jsx(V,{topPerformers:o,currencyFormatter:w})]})]})}export{se as default};
