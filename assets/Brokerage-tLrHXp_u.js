import{j as e,L as fe,r,B as se,F as te,$ as pe,a2 as be,d as de,S as ae,a as ve,u as Ne}from"./index-B1xux7nW.js";import{c as ye,C as we,b as Se}from"./card-BENweYTJ.js";import{L as o}from"./label-8qc7pw4D.js";import{S as _,a as R,b as F,c as E,d as t}from"./select-S8dYOqu_.js";import{I as u}from"./input-DilSF8vW.js";import{D as J,a as oe,b as U,c as z,d as Q,g as W,e as Ce,T as Pe,h as Le,i as ee,j as b,k as De,l as f}from"./dialog-DXga8jYz.js";import{B as Ae,a as Te,b as Ie,c as _e}from"./breadcrumb-CXSnjQSM.js";import{T as Re}from"./textarea-vipqo2i6.js";function Fe(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Ae,{children:e.jsxs(Te,{children:[e.jsx(Ie,{className:"text-accent",children:e.jsx(fe,{to:"/agent-broker/agent-brokerage",children:"Property Listing"})}),e.jsx(_e,{})]})})})})}function Ee(n){return n.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Be({onClose:n,fetchPropertiesData:g}){const[d,h]=r.useState(""),[m,v]=r.useState(()=>new Date().toISOString().split("T")[0]),[j,B]=r.useState(""),[N,O]=r.useState(""),[p,k]=r.useState(""),[y,q]=r.useState(""),[w,S]=r.useState(""),[$,C]=r.useState(""),[P,s]=r.useState([]),[D,L]=r.useState([]),[A,V]=r.useState(!1),[i,me]=r.useState({}),[xe,re]=r.useState(!1),[K,le]=r.useState(null),[M,ne]=r.useState(""),[X,ie]=r.useState(""),T=r.useRef(null),[Y,ce]=r.useState(null),he=a=>{const l=a.target.value.replace(/,/g,"");/^\d*$/.test(l)&&ie(l)},ue=a=>{ce(null);const l=a.target.files;if(l){const c=Array.from(l),x=["image/jpeg","image/png","image/jpg"];if(c.find(Z=>!x.includes(Z.type))){ce("Only JPG, JPEG, and PNG files are allowed."),s([]),L([]),T.current&&(T.current.value="");return}s(c);const H=[];c.forEach(Z=>{const G=new FileReader;G.onload=()=>{G.result&&(H.push(G.result),L([...H]))},G.readAsDataURL(Z)})}},ge=(a,l)=>{l.preventDefault();const c=P.filter((x,I)=>I!==a);if(s(c),L(x=>x.filter((I,H)=>H!==a)),T.current){const x=new DataTransfer;c.forEach(I=>x.items.add(I)),T.current.files=x.files}},je=async a=>{if(a.preventDefault(),A)return;const l={};if(d||(l.category="Category is required."),m||(l.dateListed="Date listed is required."),j||(l.lotArea="Lot area is required."),N||(l.floorArea="Floor area is required."),p||(l.otherDetails="Other details are required."),y||(l.location="Location is required."),w||(l.type="Type of listing is required."),$||(l.status="Status is required."),P.length===0&&(l.images="At least one image is required."),d==="Rental Properties"&&!M&&(l.rentalRate="Rental rate is required."),d==="Commercial Properties"&&!X&&(l.sellingPrice="Selling price is required."),me(l),Object.keys(l).length>0)return;V(!0);const c=new FormData;c.append("category",d),c.append("date_listed",m),c.append("lot_area",j),c.append("floor_area",N),c.append("details",p),c.append("location",y),c.append("type_of_listing",w),c.append("status",$),d==="Rental Properties"?c.append("price_and_rate",M):d==="Commercial Properties"?c.append("price_and_rate",X):c.append("price_and_rate",""),P.forEach(x=>{c.append("images[]",x)});try{await de.post("user/broker",c,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),re(!1),g(),ae.fire({icon:"success",title:"Success",text:"Property listing created successfully.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),h(""),B(""),O(""),k(""),q(""),S(""),C(""),s([]),L([]),ne(""),ie(""),n()}catch(x){console.error("Error creating property listing:",x),ae.fire({icon:"error",title:"Error",text:"There was an error creating the property listing. Please try again."})}finally{V(!1)}};return e.jsxs(J,{open:xe,onOpenChange:re,children:[e.jsx(oe,{children:e.jsxs(se,{className:"",children:[e.jsx(te,{icon:pe}),"Add Brokerage"]})}),e.jsx(U,{className:"md:w-[90%] overflow-auto max-h-[95%]",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{children:"Add New Property Listing"}),e.jsx(W,{children:e.jsxs("form",{onSubmit:je,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Category"}),e.jsxs(_,{value:d,onValueChange:h,children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select category"})}),e.jsxs(E,{children:[e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(t,{value:"Block and lot",children:"Block and lot"})]})]}),i.category&&e.jsx("p",{className:"text-red-500 text-sm",children:i.category})]}),d==="Rental Properties"&&e.jsxs("div",{children:[e.jsx(o,{children:"Rental Rate"}),e.jsx(u,{type:"number",value:M,onChange:a=>ne(a.target.value),placeholder:"0.00"}),i.rentalRate&&e.jsx("p",{className:"text-red-500 text-sm",children:i.rentalRate})]}),d==="Commercial Properties"&&e.jsxs("div",{children:[e.jsx(o,{children:"Selling Price"}),e.jsx(u,{type:"text",value:Ee(X),onChange:he,placeholder:"0.00"}),i.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm",children:i.sellingPrice})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Date Listed"}),e.jsx(u,{type:"date",value:m,onChange:a=>v(a.target.value)}),i.dateListed&&e.jsx("p",{className:"text-red-500 text-sm",children:i.dateListed})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Lot Area (sqm)"}),e.jsx(u,{type:"number",value:j,onChange:a=>B(a.target.value)}),i.lotArea&&e.jsx("p",{className:"text-red-500 text-sm",children:i.lotArea})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Floor Area (sqm)"}),e.jsx(u,{type:"number",value:N,onChange:a=>O(a.target.value)}),i.floorArea&&e.jsx("p",{className:"text-red-500 text-sm",children:i.floorArea})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Other Details"}),e.jsx(Re,{value:p,onChange:a=>k(a.target.value),className:"w-full border rounded-md p-2",rows:3}),i.otherDetails&&e.jsx("p",{className:"text-red-500 text-sm",children:i.otherDetails})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Location"}),e.jsx(u,{type:"text",value:y,onChange:a=>q(a.target.value)}),i.location&&e.jsx("p",{className:"text-red-500 text-sm",children:i.location})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Type of Listing"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(o,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Exclusive",checked:w==="Exclusive",onChange:a=>S(a.target.value)}),e.jsx("span",{children:"Exclusive"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Non-Exclusive",checked:w==="Non-Exclusive",onChange:a=>S(a.target.value)}),e.jsx("span",{children:"Non-Exclusive"})]})]}),i.type&&e.jsx("p",{className:"text-red-500 text-sm",children:i.type})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Status of Property"}),e.jsxs(_,{value:$,onValueChange:C,children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select status"})}),e.jsxs(E,{children:[e.jsx(t,{value:"Sold",children:"Sold"}),e.jsx(t,{value:"Not Sold",children:"Not Sold"}),e.jsx(t,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(t,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),i.status&&e.jsx("p",{className:"text-red-500 text-sm",children:i.status})]}),e.jsxs("div",{children:[e.jsxs(o,{className:"font-semibold flex items-center gap-1",children:["Upload Property Images ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"text-xs font-normal text-red-600 ml-2",children:"(JPG, JPEG, PNG only)"})]}),e.jsx(u,{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:ue,ref:T,className:Y||i.images?"border-red-500":"",required:!0}),(Y||i.images)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:Y||i.images}),e.jsx("div",{className:"flex space-x-2 mt-2",children:D.map((a,l)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",children:[e.jsx("img",{src:a,alt:`Preview ${l+1}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",onClick:()=>le(a)}),e.jsx("button",{className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center",onClick:c=>ge(l,c),children:e.jsx(te,{icon:be})})]},l))}),K&&e.jsx(J,{open:!!K,onOpenChange:()=>le(null),children:e.jsx(U,{className:"max-w-[425px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(W,{children:e.jsx("img",{src:K,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]})]}),e.jsx(Ce,{className:"flex justify-end space-x-2",children:e.jsx(se,{type:"submit",disabled:A,children:A?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Submit"})})})})]})})]})})]})}function Oe(n){if(n==null)return"";const g=n.toString().replace(/[^0-9.]/g,""),[d,h]=g.split("."),m=d.replace(/\B(?=(\d{3})+(?!\d))/g,",");return h!==void 0?`${m}.${h}`:m}function ke({property:n,dateFormatter:g}){const[d,h]=r.useState(null),m=n.category==="Commercial Properties"||n.category==="Rental Properties";return e.jsxs(e.Fragment,{children:[e.jsxs(J,{children:[e.jsx(oe,{children:e.jsx(se,{className:"h-8 w-8 font-medium bg-blue-500 hover:bg-blue-400 text-sm rounded-md",children:e.jsx(te,{icon:ve})})}),e.jsx(U,{className:"md:max-w-[400px] md:w-[90%] p-6 overflow-auto max-h-[95%] bg-white rounded-lg shadow-lg",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{className:"text-xl font-bold mb-4",children:"View Property Listing"}),e.jsx(W,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"General Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",n.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date Listed:"})," ",g.format(new Date(n.date_listed))]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",n.location]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type of Listing:"})," ",n.type_of_listing]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",n.status]}),m&&e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ",Oe(n.price_and_rate)]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Description of Property"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lot Area:"})," ",n.lot_area," sqm"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Floor Area:"})," ",n.floor_area," sqm"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Other Details:"})," ",n.details||"N/A"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Property Images"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 flex-wrap mt-4",children:n.property_images&&n.property_images.length>0?n.property_images.map((v,j)=>e.jsx("div",{className:"w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",onClick:()=>h(`https://athomes.site/${v.images}`),children:e.jsx("img",{src:`https://athomes.site/${v.images}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",alt:`Property Image ${j+1}`})},j)):e.jsx("p",{children:"No images available"})})]})]})})]})})]}),d&&e.jsx(J,{open:!!d,onOpenChange:()=>h(null),children:e.jsx(U,{className:"max-w-[425px] md:w-[90%] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(W,{children:e.jsx("img",{src:d,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]})}function Qe(){const[n,g]=r.useState(!1),[d,h]=r.useState([]),[m,v]=r.useState(""),[j,B]=r.useState(10),[N,O]=r.useState("all"),[p,k]=r.useState(""),[y,q]=r.useState("all"),w=Ne(),S=async()=>{try{const s=await de.get("user/broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});h(s.data.property)}catch{ae.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),w("/")}};r.useEffect(()=>{S()},[]);const C=d.filter(s=>{const D=N==="all"||s.category===N,L=!p||new Date(s.date_listed).toISOString().split("T")[0]===p,A=y==="all"||s.status===y,V=s.category.toLowerCase().includes(m.toLowerCase())||s.location.toLowerCase().includes(m.toLowerCase())||s.type_of_listing.toLowerCase().includes(m.toLowerCase())||s.status.toLowerCase().includes(m.toLowerCase());return D&&L&&A&&V}).slice(0,j),P=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"});return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0  gap-2 items-start justify-center mr-5 md:px-2 ",children:[e.jsx(Fe,{}),e.jsxs(ye,{className:"bg-[#eef2ff] border-b-4 border-primary min-w-[100px] fade-in-left md:w-[380px]",children:[e.jsx(we,{children:e.jsxs("div",{className:"flex flex-row md:flex-col gap-4 justify-between",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-1 gap-4 md:mt-0",children:[e.jsxs("div",{className:"grid w-full gap-1.5",children:[e.jsx(o,{children:"Category"}),e.jsxs(_,{onValueChange:O,children:[e.jsx(R,{className:"md:w-full",children:e.jsx(F,{placeholder:"Select category"})}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(t,{value:"Block and lot",children:"Block and lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(o,{children:"Date Listed"}),e.jsx(u,{type:"date",className:"md:w-full",value:p,onChange:s=>k(s.target.value)})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(o,{children:"Filter Status"}),e.jsxs(_,{onValueChange:q,children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select status"})}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"Sold",children:"Sold"}),e.jsx(t,{value:"Not Sold",children:"Not Sold"})]})]})]})]}),e.jsx("div",{className:"md:flex md:justify-end md:items-center md:w-full",children:e.jsx(Be,{isOpen:n,fetchPropertiesData:S,onClose:()=>g(!1)})})]})}),e.jsxs(Se,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(_,{onValueChange:s=>B(s==="all"?d.length:parseInt(s,10)),children:[e.jsxs(R,{className:"w-[120px] md:w-full border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(F,{placeholder:"All"})]}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"5",children:"5"}),e.jsx(t,{value:"10",children:"10"}),e.jsx(t,{value:"20",children:"20"}),e.jsx(t,{value:"30",children:"30"}),e.jsx(t,{value:"40",children:"40"}),e.jsx(t,{value:"50",children:"50"})]})]}),e.jsx(u,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:m,onChange:s=>v(s.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Pe,{children:[e.jsx(Le,{className:"bg-primary text-base",children:e.jsxs(ee,{children:[e.jsx(b,{children:"#"}),e.jsx(b,{children:"Category"}),e.jsx(b,{children:"Date Listed"}),e.jsx(b,{children:"Location"}),e.jsx(b,{children:"Type"}),e.jsx(b,{children:"Status"}),e.jsx(b,{className:"text-right",children:"Action"})]})}),e.jsxs(De,{children:[C.length===0&&e.jsx(ee,{children:e.jsx(f,{colSpan:7,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),C.map((s,D)=>e.jsxs(ee,{children:[e.jsx(f,{className:"font-medium border border-[#bfdbfe]",children:D+1}),e.jsx(f,{className:"font-medium border border-[#bfdbfe]",children:s.category}),e.jsx(f,{className:"border border-[#bfdbfe]",children:P.format(new Date(s.date_listed))}),e.jsx(f,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(f,{className:"border border-[#bfdbfe]",children:s.type_of_listing}),e.jsx(f,{className:"border border-[#bfdbfe]",children:s.status==="Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:s.status}):s.status==="Not Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:s.status}):s.status==="Pre-Selling"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-red-700/10 ring-inset",children:s.status}):s.status==="RFO"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Ready for Occupancy"}):null}),e.jsx(f,{className:"text-right border border-[#bfdbfe]",children:e.jsx("div",{className:"flex flex-row gap-1 justify-end",children:e.jsx(ke,{property:s,dateFormatter:P})})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",C.length," of ",d.length," entries"]})})})]})]})]})})}export{Qe as default};
