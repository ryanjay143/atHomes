import{r as t,u as A,g as U,j as e,F,a as I,f as L,B as R,S as d,c as _}from"./index-CDIdtsdl.js";import{c as z,C as G,a as J,d as K,b as O}from"./card-BSubEM3f.js";import{I as c}from"./input-CYcbNoiH.js";import{L as q}from"./label-Be5VHt6w.js";function Y(){const[n,h]=t.useState(""),[i,p]=t.useState(""),[u,m]=t.useState(""),[x,f]=t.useState(""),[w,g]=t.useState(!1),[b,l]=t.useState(null),[j,y]=t.useState(null),[r,B]=t.useState(!1),M=A(),S=U(),[v,T]=t.useState(!1),[P,D]=t.useState(!1);t.useEffect(()=>{const s=new URLSearchParams(S.search),a=s.get("token"),o=s.get("email");a&&m(a),o&&f(o)},[S.search]);const H=async s=>{var a,o,C,N;if(s.preventDefault(),l(null),y(null),!n||!i||!u||!x){l("Please fill in all fields."),d.fire({icon:"error",title:"Missing Fields",text:"Please fill in all fields."});return}if(n.trim()!==i.trim()){l("Passwords do not match."),d.fire({icon:"error",title:"Password Mismatch",text:"Passwords do not match."});return}g(!0);try{await _.post("reset-password",{password:n.trim(),password_confirmation:i.trim(),token:u,email:x}),y("Password reset successful!"),h(""),p(""),m(""),f(""),B(!0),d.fire({icon:"success",title:"Success",text:"Password reset successful!"})}catch(k){const E=((o=(a=k.response)==null?void 0:a.data)==null?void 0:o.message)||((N=(C=k.response)==null?void 0:C.data)==null?void 0:N.detail)||"Failed to reset password. Please try again.";l(E),d.fire({icon:"error",title:"Error",text:E})}finally{g(!1)}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs(z,{className:"w-80 max-w-md shadow-lg rounded-xl border border-b-4 border-primary",children:[e.jsxs(G,{children:[e.jsx(J,{className:"text-2xl font-semibold text-center text-gray-800",children:"Reset Password"}),e.jsx(K,{className:"text-center text-sm text-gray-500 mt-1",children:"Enter your details to reset your password."})]}),e.jsx(O,{children:e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:H,children:[e.jsx(c,{id:"email",type:"hidden",value:x,onChange:s=>f(s.target.value),required:!0,disabled:r}),e.jsx(c,{id:"token",type:"hidden",value:u,onChange:s=>m(s.target.value),required:!0,disabled:r}),e.jsxs("div",{className:"flex flex-col gap-1.5 relative",children:[e.jsx(q,{htmlFor:"password",children:"Password"}),e.jsx(c,{id:"password",type:v?"text":"password",value:n,onChange:s=>h(s.target.value),required:!0,disabled:r}),e.jsx("button",{type:"button",tabIndex:-1,className:"absolute right-3 top-10 transform -translate-y-1/2 cursor-pointer text-[#93c5fd]",onClick:()=>T(s=>!s),style:{background:"none",border:"none",padding:0,margin:0},children:e.jsx(F,{icon:v?I:L})})]}),e.jsxs("div",{className:"flex flex-col gap-1.5 relative",children:[e.jsx(q,{htmlFor:"confirm-password",children:"Confirm Password"}),e.jsx(c,{id:"confirm-password",type:P?"text":"password",value:i,onChange:s=>p(s.target.value),required:!0,disabled:r}),e.jsx("button",{type:"button",tabIndex:-1,className:"absolute right-3 top-10 transform -translate-y-1/2 cursor-pointer text-[#93c5fd]",onClick:()=>D(s=>!s),style:{background:"none",border:"none",padding:0,margin:0},children:e.jsx(F,{icon:P?I:L})})]}),b&&e.jsx("div",{className:"text-red-600 text-sm text-center",children:b}),j&&e.jsx("div",{className:"text-green-600 text-sm text-center",children:j}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(R,{type:"submit",disabled:w||r,className:"w-full flex items-center justify-center gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Sending..."}),e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})]}):e.jsx("span",{children:"Submit"})}),e.jsx(R,{type:"button",disabled:!r,onClick:()=>M("/atHomes/user-login"),className:"w-full flex items-center justify-center gap-2 bg-red-600 hover:bg-red-500 text-white hover:text-white",children:e.jsx("span",{children:"Back to login"})})]})]})})]})})}export{Y as default};
