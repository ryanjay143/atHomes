import{j as e,L as ge,B as C,F as N,$ as X,a0 as le,a1 as re,g as ne,r as c,a2 as fe,a3 as je,d as V,S as R,u as be,Q as pe,T as ve,U as Ne,a as we,a4 as _e,a5 as ye}from"./index-BqgKW3tX.js";import{c as Ce,C as Se,b as Pe}from"./card-DMwL5mhC.js";import{I as p}from"./input-BPORAoyB.js";import{S as Y,a as Z,b as ee,c as se,d as u}from"./select-yW0ppv6d.js";import{D as H,a as J,b as M,c as K,d as Q,e as ie,f as de,g as ae,T as Ee,h as De,i as W,j as k,k as Fe,l as I}from"./dialog-bG-Ik3It.js";import{B as Le,a as Te,b as Ae,c as Be}from"./breadcrumb-CMARPdCn.js";import{L as v}from"./label-L0oGHOiY.js";function Oe(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Le,{children:e.jsxs(Te,{children:[e.jsx(Ae,{className:"text-accent",children:e.jsx(ge,{to:"/admin/developer",className:"transition-colors duration-200 hover:text-blue-300 font-medium flex items-center gap-1",children:"List of Accredited Developers"})}),e.jsx(Be,{})]})})})})}const Ie=({developerData:a,setDeveloperData:f,isDialogOpen:S,setIsDialogOpen:j,isSubmitting:o,handleSubmit:y,handleImageChange:A,handleImageError:B,handleRemoveImage:P,errors:i,fileInputRef:E})=>e.jsxs(H,{open:S,onOpenChange:j,children:[e.jsx(J,{asChild:!0,children:e.jsxs(C,{className:"border border-primary bg-gradient-to-r from-blue-500 to-blue-700 text-white shadow-md hover:from-blue-600 hover:to-blue-800 transition-all duration-200",disabled:o,children:[e.jsx(N,{icon:X,className:"mr-2"})," Add Developer"]})}),e.jsxs(M,{className:"md:pt-10 h-full md:w-[90%] md:max-w-xl overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(K,{className:"text-start mb-2",children:[e.jsx(Q,{className:"text-2xl font-bold text-blue-900",children:"Add Developer"}),e.jsx("p",{className:"text-blue-800 md:text-sm mt-1",children:"Please fill out the form below to add a new housing developer."})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5",children:[e.jsxs("div",{children:[e.jsxs(v,{className:"text-blue-900 font-semibold",children:["Developer Name ",e.jsx("span",{className:"text-red-700",children:"*"})]}),e.jsx(p,{type:"text",className:"uppercase rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",placeholder:"Enter developer name",value:a.dev_name,onChange:b=>f({...a,dev_name:b.target.value}),autoFocus:!0}),i.dev_name&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:i.dev_name})]}),e.jsxs("div",{children:[e.jsxs(v,{className:"text-blue-900 font-semibold",children:["Email Address ",e.jsx("span",{className:"text-red-700",children:"*"})]}),e.jsx(p,{type:"email",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",placeholder:"Enter email",value:a.dev_email,onChange:b=>f({...a,dev_email:b.target.value})}),i.dev_email&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:i.dev_email})]}),e.jsxs("div",{children:[e.jsxs(v,{className:"text-blue-900 font-semibold",children:["Phone Number ",e.jsx("span",{className:"text-red-700",children:"*"})]}),e.jsx(p,{type:"tel",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",placeholder:"Enter phone number",value:a.dev_phone,onChange:b=>f({...a,dev_phone:b.target.value})}),i.dev_phone&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:i.dev_phone})]}),e.jsxs("div",{children:[e.jsxs(v,{className:"text-blue-900 font-semibold",children:["Location ",e.jsx("span",{className:"text-red-700",children:"*"})]}),e.jsx(p,{type:"text",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",placeholder:"Enter location",value:a.dev_location,onChange:b=>f({...a,dev_location:b.target.value})}),i.dev_location&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:i.dev_location})]}),e.jsxs("div",{children:[e.jsxs(v,{className:"text-blue-900 font-semibold",children:["Image or Logo ",e.jsx("span",{className:"text-red-700",children:"*"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{htmlFor:"dev-image-upload",className:"flex flex-col items-center justify-center border-2 border-dashed border-blue-300 rounded-lg p-4 bg-white hover:bg-blue-50 cursor-pointer transition-all duration-200",children:[e.jsx(N,{icon:le,className:"text-blue-400 text-3xl mb-2"}),e.jsx("span",{className:"text-blue-700 font-medium",children:"Click to upload image here"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"(JPEG, PNG, JPG only, max 5MB)"}),e.jsx(p,{id:"dev-image-upload",type:"file",accept:"image/jpeg, image/png, image/jpg",onChange:A,ref:E,className:"hidden"})]}),i.image&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:i.image})]}),a.image&&e.jsxs("div",{className:"mt-3 relative w-36 h-36 group mx-auto",children:[e.jsx("img",{src:a.image instanceof File?URL.createObjectURL(a.image):a.image,alt:"Preview",className:"w-full h-full object-cover rounded-lg border-2 border-blue-200 shadow-md",onError:B}),e.jsx("button",{type:"button",onClick:P,className:"absolute top-1 right-1 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-500 transition","aria-label":"Remove image",children:e.jsx(N,{icon:re})})]})]})]}),e.jsx(ie,{className:"mt-6",children:e.jsxs("div",{className:"flex flex-row gap-2 w-full justify-end",children:[e.jsx(de,{asChild:!0,children:e.jsx(C,{type:"button",className:"bg-red-600 hover:bg-red-500 text-white w-24 h-10 rounded-lg shadow",disabled:o,children:"Cancel"})}),e.jsx(C,{type:"submit",className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white w-32 h-10 rounded-lg shadow hover:from-blue-700 hover:to-blue-900 flex items-center justify-center gap-2",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{icon:ne}),e.jsx("span",{children:"Submit"})]})})]})})]})]})]}),ke=({developer:a,projects:f,dialogOpenState:S,loading:j,toggleDialogOpen:o,handleProjectChange:y,addProject:A,removeProject:B,handleSubmitProjects:P})=>{const[i,E]=c.useState({}),b=(n,r)=>{const h=f[r],x={};return h.name||(x.name="Project name is required."),h.location||(x.location="Location is required."),h.category||(x.category="Category is required."),h.units<=0&&(x.units="Total units must be greater than 0."),h.status||(x.status="Status is required."),E(D=>({...D,[n]:{...D[n],[r]:x}})),Object.keys(x).length===0},m=n=>{let r=!0;return f.forEach((h,x)=>{b(n,x)||(r=!1)}),r},G=n=>{m(n)&&P(n)};return e.jsxs(H,{open:S,onOpenChange:n=>o(a.id,n),children:[e.jsx(J,{children:e.jsx(C,{className:"w-8 h-8 rounded-md bg-green-500 hover:bg-green-400",children:e.jsx(N,{icon:X,className:"text-[#eff6ff]"})})}),e.jsxs(M,{className:"w-full max-w-7xl overflow-auto h-full",children:[e.jsxs(K,{children:[e.jsxs(Q,{className:"text-start",children:["Add Projects for ",e.jsx("span",{className:"uppercase",children:a.dev_name})]}),e.jsxs(ae,{children:[e.jsxs("div",{className:"mb-4 text-start mt-4 grid grid-cols-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-3 bg-blue-500 mr-2"}),e.jsx("p",{className:"text-xs",children:"Planning – Still in blueprint or permit phase."})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-3 bg-yellow-500 mr-2"}),e.jsx("p",{className:"text-xs",children:"Pre-Development – Site clearing and initial groundwork."})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-3 bg-orange-500 mr-2"}),e.jsx("p",{className:"text-xs",children:"Ongoing – Construction is actively in progress."})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-3 bg-green-500 mr-2"}),e.jsx("p",{className:"text-xs",children:"Ready for Occupancy (RFO) – Units are ready to be moved into."})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-3 bg-gray-500 mr-2"}),e.jsx("p",{className:"text-xs",children:"Completed – Fully finished and turned over."})]})]}),e.jsxs("div",{className:"mt-5 ",children:[f.map((n,r)=>{var h,x,D,F,O,q,g,d,w,T,U,L;return e.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-4 md:grid-cols-2 md:p-4",children:[e.jsx("div",{className:"hidden",children:e.jsx(p,{type:"text",value:a.id})}),e.jsxs("div",{className:"grid w-full items-center text-start gap-1.5",children:[e.jsx(v,{children:"Project Name"}),e.jsx(p,{type:"text",placeholder:"Enter project",value:n.name,onChange:_=>y(a.id,r,"name",_.target.value)}),((x=(h=i[a.id])==null?void 0:h[r])==null?void 0:x.name)&&e.jsx("p",{className:"text-red-500 text-xs",children:(F=(D=i[a.id])==null?void 0:D[r])==null?void 0:F.name})]}),e.jsxs("div",{className:"grid w-full items-center text-start gap-1.5",children:[e.jsx(v,{children:"Location"}),e.jsx(p,{type:"text",placeholder:"Enter location",value:n.location,onChange:_=>y(a.id,r,"location",_.target.value)}),((q=(O=i[a.id])==null?void 0:O[r])==null?void 0:q.location)&&e.jsx("p",{className:"text-red-500 text-xs",children:i[a.id][r].location})]}),e.jsxs("div",{className:"grid w-full items-center text-start gap-1.5",children:[e.jsx(v,{children:"Category"}),e.jsxs(Y,{onValueChange:_=>y(a.id,r,"category",_),children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"Select category"})}),e.jsxs(se,{children:[e.jsx(u,{value:"Lot only",children:"Lot only"}),e.jsx(u,{value:"House and lot",children:"House and lot"}),e.jsx(u,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(u,{value:"Commercial Building",children:"Commercial Building"}),e.jsx(u,{value:"Rental Building",children:"Rental Building"}),e.jsx(u,{value:"Farm Lot",children:"Farm Lot"})]})]}),((d=(g=i[a.id])==null?void 0:g[r])==null?void 0:d.category)&&e.jsx("p",{className:"text-red-500 text-xs",children:i[a.id][r].category})]}),e.jsxs("div",{className:"grid w-full items-center text-start gap-1.5",children:[e.jsx(v,{children:"Total Units"}),e.jsx(p,{type:"number",min:"0",placeholder:"0",onFocus:_=>_.target.placeholder="",onChange:_=>y(a.id,r,"units",Number(_.target.value))}),((T=(w=i[a.id])==null?void 0:w[r])==null?void 0:T.units)&&e.jsx("p",{className:"text-red-500 text-xs",children:i[a.id][r].units})]}),e.jsxs("div",{className:"grid w-full items-center text-start gap-1.5",children:[e.jsx(v,{children:"Status"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs(Y,{onValueChange:_=>y(a.id,r,"status",_),children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"Select Status"})}),e.jsxs(se,{children:[e.jsx(u,{value:"Planning",children:"Planning"}),e.jsx(u,{value:"Pre-Development",children:"Pre-Development"}),e.jsx(u,{value:"Ongoing",children:"Ongoing"}),e.jsx(u,{value:"Ready for Occupancy",children:"Ready for Occupancy"}),e.jsx(u,{value:"Completed",children:"Completed"})]})]}),((L=(U=i[a.id])==null?void 0:U[r])==null?void 0:L.status)&&e.jsx("p",{className:"text-red-500 text-xs",children:i[a.id][r].status}),r!==0&&e.jsx(C,{className:"bg-red-500 hover:bg-red-400",onClick:()=>B(a.id,r),children:e.jsx(N,{icon:fe,className:"text-[#eff6ff]"})})]})]})]},n.id)}),e.jsx("div",{className:"flex justify-start mt-4",children:e.jsxs(C,{onClick:()=>A(a.id),className:"mt-4",disabled:j,children:[e.jsx(N,{icon:X,className:"text-[#eff6ff]"}),"Add Project"]})})]})]})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex justify-end mt-4 flex-row  gap-2",children:[e.jsx(de,{asChild:!0,children:e.jsx(C,{className:"mt-4 bg-red-500 hover:bg-red-400",disabled:j,children:"Cancel"})}),e.jsx(C,{onClick:()=>G(a.id),className:"mt-4 bg-green-500 hover:bg-green-400",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{icon:ne,className:"text-[#eff6ff]"}),e.jsx("span",{children:"Submit"})]})})]})})]})]})};function Re({developer:a,fetchDevelopers:f}){const[S,j]=c.useState(null),[o,y]=c.useState(!1),[A,B]=c.useState(!1),[P,i]=c.useState(`https://athomes.site/${a.image}`),[E,b]=c.useState(!1),[m,G]=c.useState({dev_name:a.dev_name,dev_email:a.dev_email,dev_phone:a.dev_phone,dev_location:a.dev_location}),[n,r]=c.useState({dev_name:"",dev_email:"",dev_phone:"",dev_location:"",image:""}),h=c.useRef(null),x=g=>{var w;const d=(w=g.target.files)==null?void 0:w[0];if(d){if(!["image/jpeg","image/png","image/jpg"].includes(d.type)){r(L=>({...L,image:"Invalid image type. Only JPEG, PNG, JPG are allowed."}));return}if(d.size>5242880){r(L=>({...L,image:"Image size must not exceed 5MB."}));return}j(d),i(URL.createObjectURL(d)),b(!0),r(L=>({...L,image:""}))}},D=()=>{j(null),i(`https://athomes.site/${a.image}`),b(!1),h.current&&(h.current.value="")},F=g=>{const{name:d,value:w}=g.target;G(T=>({...T,[d]:w})),r(T=>({...T,[d]:""}))},O=()=>{const g={dev_name:m.dev_name?"":"Developer name is required.",dev_email:m.dev_email?"":"Email address is required.",dev_phone:m.dev_phone?"":"Phone number is required.",dev_location:m.dev_location?"":"Location is required.",image:""};return r(g),Object.values(g).every(d=>d==="")},q=async g=>{if(g.preventDefault(),!O()||o)return;y(!0);const d=new FormData;d.append("dev_name",m.dev_name),d.append("dev_email",m.dev_email),d.append("dev_phone",m.dev_phone),d.append("dev_location",m.dev_location),S&&d.append("image",S);try{const w=await V.post(`updateDeveloper/${a.id}`,d,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});f(),b(!1),B(!1),R.fire({icon:"success",title:"Success",text:w.data.message,showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(w){console.error("Error updating developer:",w)}finally{y(!1)}};return e.jsxs(H,{open:A,onOpenChange:B,children:[e.jsx(J,{children:e.jsx(C,{className:"w-8 h-8 rounded-md bg-gradient-to-r from-green-400 to-green-600 shadow hover:from-green-500 hover:to-green-700 transition-all duration-200",children:e.jsx(N,{icon:je,className:"text-white"})})}),e.jsx(M,{className:"md:pt-10 h-full md:w-[90%] md:max-w-xl overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(K,{children:[e.jsx(Q,{className:"text-start text-2xl font-bold text-blue-900",children:"Edit Developer"}),e.jsx(ae,{children:e.jsxs("form",{onSubmit:q,className:"mt-5 text-start space-y-5",children:[e.jsxs("div",{className:"grid w-full items-center gap-2",children:[e.jsx(v,{htmlFor:"developer",className:"font-semibold text-blue-900",children:"Developer Name"}),e.jsx(p,{type:"text",className:"uppercase rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",name:"dev_name",value:m.dev_name,onChange:F,autoFocus:!0}),n.dev_name&&e.jsx("span",{className:"text-red-500 text-xs",children:n.dev_name})]}),e.jsxs("div",{className:"grid w-full items-center gap-2",children:[e.jsx(v,{htmlFor:"email",className:"font-semibold text-blue-900",children:"Email Address"}),e.jsx(p,{type:"email",name:"dev_email",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:m.dev_email,onChange:F}),n.dev_email&&e.jsx("span",{className:"text-red-500 text-xs",children:n.dev_email})]}),e.jsxs("div",{className:"grid w-full items-center gap-2",children:[e.jsx(v,{htmlFor:"location",className:"font-semibold text-blue-900",children:"Location"}),e.jsx(p,{type:"text",name:"dev_location",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:m.dev_location,onChange:F}),n.dev_location&&e.jsx("span",{className:"text-red-500 text-xs",children:n.dev_location})]}),e.jsxs("div",{className:"grid w-full items-center gap-2",children:[e.jsx(v,{htmlFor:"phone",className:"font-semibold text-blue-900",children:"Phone Number"}),e.jsx(p,{type:"text",name:"dev_phone",className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:m.dev_phone,onChange:F}),n.dev_phone&&e.jsx("span",{className:"text-red-500 text-xs",children:n.dev_phone})]}),e.jsxs("div",{className:"grid w-full items-center gap-2",children:[e.jsx(v,{htmlFor:"image",className:"font-semibold text-blue-900",children:"Developer Image"}),e.jsxs("label",{htmlFor:"dev-image-upload",className:"flex flex-col items-center justify-center border-2 border-dashed border-blue-300 rounded-lg p-4 bg-white hover:bg-blue-50 cursor-pointer transition-all duration-200",children:[e.jsx(N,{icon:le,className:"text-blue-400 text-3xl mb-2"}),e.jsx("span",{className:"text-blue-700 font-medium",children:"Click to upload image here"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"(JPEG, PNG, JPG only, max 5MB)"}),e.jsx(p,{id:"dev-image-upload",type:"file",accept:"image/jpeg, image/png, image/jpg",onChange:x,ref:h,className:"hidden"})]}),n.image&&e.jsx("span",{className:"text-red-500 text-xs",children:n.image})]}),e.jsxs("div",{className:"relative flex justify-center",children:[e.jsx("img",{src:P,alt:a.dev_name,className:"object-cover w-36 h-36 rounded-lg border-2 border-blue-200 shadow-md"}),E&&e.jsx(C,{type:"button",className:"absolute top-2 right-2 bg-red-600 hover:bg-red-500 text-white rounded-full h-8 w-8 flex items-center justify-center shadow",onClick:D,children:e.jsx(N,{icon:re})})]}),e.jsx("div",{children:e.jsx(C,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-green-700 text-white rounded-lg shadow hover:from-green-600 hover:to-green-800 flex items-center justify-center gap-2",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save Changes"})})})})]})})]})})]})}const Je=()=>{const[a,f]=c.useState({id:0,dev_name:"",dev_email:"",dev_phone:"",dev_location:"",image:null,status:0,created_at:"",updated_at:""}),[S,j]=c.useState({}),[o,y]=c.useState([]),[A,B]=c.useState(10),[P,i]=c.useState(""),E=c.useRef(null),[b,m]=c.useState(!1),[G,n]=c.useState({}),[r,h]=c.useState(!1),[x,D]=c.useState(!1),[F,O]=c.useState({dev_name:"",dev_email:"",dev_phone:"",dev_location:"",image:""}),q=be(),g=async()=>{try{const s=await V.get("developers",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});y(s.data.developers);const l={};s.data.developers.forEach(t=>{l[t.id]=[{id:Date.now(),name:"",location:"",category:"",units:0,status:"",developer_id:t.id}]}),j(l)}catch(s){console.error("Error fetching developers:",s),R.fire({icon:"error",title:"Error",text:"Failed to fetch developers. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),q("/")}};c.useEffect(()=>{g()},[]);const d=s=>{var t;const l=(t=s.target.files)==null?void 0:t[0];l&&(["image/jpeg","image/png","image/jpg","image/gif"].includes(l.type)?(f({...a,image:l}),O({...F,image:""})):(O({...F,image:"Please upload a valid image file (jpeg, png, jpg, gif)."}),E.current&&(E.current.value="")))},w=s=>{const l=s.currentTarget;l.src="/path/to/default-image.jpg",l.alt="Default Image"},T=()=>{f({...a,image:null}),E.current&&(E.current.value="")},U=()=>{const s={dev_name:a.dev_name?"":"Developer name is required.",dev_email:a.dev_email?"":"Email address is required.",dev_phone:a.dev_phone?"":"Phone number is required.",dev_location:a.dev_location?"":"Location is required.",image:a.image?"":"Image or logo is required."};return O(s),Object.values(s).every(l=>l==="")},L=async s=>{if(s.preventDefault(),!U())return;h(!0);const l=new FormData;l.append("dev_name",a.dev_name),l.append("dev_email",a.dev_email),l.append("dev_phone",a.dev_phone),l.append("dev_location",a.dev_location),a.image&&l.append("image",a.image);try{const t=await V.post("developers",l,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});g(),m(!1),f({id:t.data.id,dev_name:"",dev_email:"",dev_phone:"",dev_location:"",image:null,status:0,created_at:"",updated_at:""}),R.fire({icon:"success",title:"Success",text:"Developer created successfully!",showConfirmButton:!1,timer:2e3})}catch{R.fire({icon:"error",title:"Submission Failed",text:"There was an error submitting the form. Please check your input and try again.",confirmButtonText:"OK"})}finally{h(!1)}},_=s=>{j(l=>({...l,[s]:[...l[s]||[],{id:Date.now(),name:"",location:"",category:"",units:0,status:"",developer_id:s}]}))},ce=(s,l,t,$)=>{j(z=>({...z,[s]:z[s].map((te,he)=>he===l?{...te,[t]:$}:te)}))},oe=(s,l)=>{j(t=>({...t,[s]:t[s].filter(($,z)=>z!==l)}))},me=(s,l)=>{const t=S[s][l];return!(!t.name||!t.location||!t.category||t.units<=0||!t.status)},xe=async s=>{if(x)return;let l=!0;if(l=!S[s].some((t,$)=>!me(s,$)),!l){R.fire({icon:"error",title:"Validation Error",text:"Please correct the errors in the project fields before submitting.",confirmButtonText:"OK"});return}D(!0);try{await V.post("admin/addProject",{projects:S[s].map(t=>({developer_id:s,project_name:t.name,project_location:t.location,project_category:t.category,status:t.status,total_units:t.units}))},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),R.fire({icon:"success",title:"Success",text:"Projects added successfully!",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),n(t=>({...t,[s]:!1})),j(t=>({...t,[s]:[{id:Date.now(),name:"",location:"",category:"",units:0,status:"",developer_id:s}]}))}catch(t){console.error("Error adding projects:",t),R.fire({icon:"error",title:"Error",text:"There was an error adding the projects. Please try again.",confirmButtonText:"OK"})}finally{D(!1)}},ue=(s,l)=>{n(t=>({...t,[s]:l}))};return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0 gap-2 items-start justify-center mr-5 md:px-2",children:[e.jsx(Oe,{}),e.jsxs(Ce,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left md:w-[380px]",children:[e.jsx(Se,{children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 justify-between",children:[e.jsxs("div",{className:"flex flex-col items-start bg-gradient-to-r from-blue-100 to-blue-200 px-4 py-2 rounded-lg shadow-sm",children:[e.jsx("span",{className:"text-xs text-blue-700 font-semibold",children:"Total Developers"}),e.jsx("span",{className:"text-2xl font-bold text-blue-900",children:o.length})]}),e.jsx("div",{className:"flex items-center",children:e.jsx(Ie,{developerData:a,setDeveloperData:f,isDialogOpen:b,setIsDialogOpen:m,isSubmitting:r,handleSubmit:L,handleImageChange:d,handleImageError:w,handleRemoveImage:T,errors:F,fileInputRef:E})})]})}),e.jsxs(Pe,{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:justify-between justify-between gap-4",children:e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(Y,{onValueChange:s=>B(s==="all"?o.length:Number(s)),children:[e.jsxs(Z,{className:"w-[120px] border border-primary md:w-28",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(ee,{placeholder:"All"})]}),e.jsxs(se,{children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{value:"10",children:"10"}),e.jsx(u,{value:"20",children:"20"}),e.jsx(u,{value:"30",children:"30"}),e.jsx(u,{value:"40",children:"40"}),e.jsx(u,{value:"50",children:"50"})]})]}),e.jsx(p,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:P,onChange:s=>i(s.target.value)})]})}),e.jsxs("div",{className:"w-full overflow-x-auto md:overflow-x-visible",children:[e.jsxs(Ee,{children:[e.jsx(De,{className:"sticky top-0 bg-primary",children:e.jsxs(W,{children:[e.jsx(k,{children:"#"}),e.jsx(k,{children:"Photo"}),e.jsx(k,{children:"Developer name"}),e.jsx(k,{children:"Email address"}),e.jsx(k,{children:"Location"}),e.jsx(k,{children:"Phone number"}),e.jsx(k,{className:"text-right",children:"Action"})]})}),e.jsxs(Fe,{children:[o.length===0&&e.jsx(W,{children:e.jsx(I,{colSpan:7,className:"text-center",children:"No developers found."})}),o.filter(s=>s.dev_name.toLowerCase().includes(P.toLowerCase())||s.dev_email.toLowerCase().includes(P.toLowerCase())||s.dev_location.toLowerCase().includes(P.toLowerCase())||s.dev_phone.toLowerCase().includes(P.toLowerCase())).slice(0,A).map((s,l)=>e.jsxs(W,{children:[e.jsx(I,{className:"font-medium border border-[#bfdbfe]",children:l+1}),e.jsx(I,{className:"font-medium border border-[#bfdbfe] uppercase",children:s.dev_name?e.jsx("img",{src:`https://athomes.site/${s.image}`,alt:s.dev_name,className:"rounded-full h-10 w-10"}):e.jsxs(pe,{children:[e.jsx(ve,{src:"https://github.com/shadcn.png"}),e.jsx(Ne,{children:"CN"})]})}),e.jsx(I,{className:"font-medium border border-[#bfdbfe] uppercase",children:s.dev_name}),e.jsx(I,{className:"border border-[#bfdbfe]",children:s.dev_email}),e.jsx(I,{className:"border border-[#bfdbfe]",children:s.dev_location}),e.jsx(I,{className:"border border-[#bfdbfe]",children:s.dev_phone}),e.jsx(I,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(ke,{developer:s,projects:S[s.id]||[],dialogOpenState:G[s.id]||!1,toggleDialogOpen:ue,handleProjectChange:ce,addProject:_,removeProject:oe,handleSubmitProjects:xe,loading:x,setLoading:D}),e.jsxs(H,{children:[e.jsx(J,{children:e.jsx(C,{className:"w-8 h-8 rounded-md",onClick:()=>g(),children:e.jsx(N,{icon:we,className:"text-[#eff6ff]"})})}),e.jsx(M,{className:"w-full max-w-3xl md:w-[90%]",children:e.jsxs(K,{children:[e.jsxs(Q,{className:"text-start mb-8",children:[e.jsx("span",{className:"uppercase",children:s.dev_name})," Projects"]}),e.jsx(ae,{children:s.projects&&s.projects.length>0?e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-1 gap-4",children:s.projects.map((t,$)=>e.jsxs("div",{className:"bg-white rounded-lg shadow border border-blue-200 p-4 flex flex-col gap-2 hover:shadow-lg transition",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full font-semibold",children:["#",$+1]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-semibold ${t.status==="Active"?"bg-green-100 text-green-700":t.status==="Inactive"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:t.status})]}),e.jsx("div",{className:"font-bold text-base text-blue-900 truncate",children:t.project_name}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(N,{icon:_e,className:"text-blue-400"}),e.jsx("span",{children:t.project_location})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(N,{icon:ye,className:"text-blue-400"}),e.jsx("span",{children:t.project_category})]}),e.jsxs("div",{className:"flex flex-row justify-between mt-1",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:"Total Units"}),e.jsx("span",{className:"font-bold text-green-600 text-sm",children:t.total_units})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:"Available"}),e.jsx("span",{className:"font-bold text-red-500 text-sm",children:t.available_units})]})]})]},t.id))}):e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No projects available."})})]})})]}),e.jsx(Re,{developer:s,fetchDevelopers:g})]})})]},s.id))]})]}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",Math.min(A,o.length)," of ",o.length," entries"]})})})]})]})]})]})})};export{Je as default};
