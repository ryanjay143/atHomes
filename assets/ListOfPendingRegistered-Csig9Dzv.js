import{r as x,j as e,B as w,F as i,a as I,X as k,aa as R,ab as E,d as S,S as y,a2 as P}from"./index-DzP73YiP.js";import{a as Y,b as $}from"./dateUtils-D6w6W0GJ.js";import{S as F,a as L,b as z,c as U,d as c}from"./select-CDDnd22d.js";import{I as H}from"./input-Dz3A7Y41.js";import{D as M,a as O,b as V,c as G,d as X,g as q,e as J,f as K,T as Q,h as W,i as C,j as t,k as Z,l as o}from"./dialog-BXUA4-iJ.js";function ee({item:r,getPendingRegistered:D}){var v,d,g,s,l;const[h,N]=x.useState(!1),[n,m]=x.useState(!1),f=async()=>{if(!n){m(!0);try{const a=await S.put(`agent-broker/${r.user.id}`,{status:0},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});N(!1),y.fire({title:"Success",text:a.data.message,icon:"success",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),D()}catch(a){console.error("Error updating user status:",a)}finally{m(!1)}}},_=a=>a===0?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-green-100 text-green-700 text-xs font-semibold",children:"Approved"}):a===1?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 text-xs font-semibold",children:"Pending"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:"Declined"});return e.jsxs(M,{open:h,onOpenChange:N,children:[e.jsx(O,{children:e.jsx(w,{className:"w-8 h-8 rounded-md bg-gradient-to-br from-blue-500 to-blue-700 shadow hover:from-blue-600 hover:to-blue-800 transition-all duration-200",children:e.jsx(i,{icon:I,className:"text-white"})})}),e.jsxs(V,{className:"md:max-w-[420px] rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(G,{children:[e.jsxs(X,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(i,{icon:k,className:"text-blue-500"}),"Agent & Broker Details"]}),e.jsx(q,{children:e.jsxs("div",{className:"flex flex-col gap-6 mt-6 mb-4",children:[e.jsxs("div",{className:"border-b pb-4 mb-2 text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{icon:R,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Personal Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Name:"})," ",(v=r==null?void 0:r.personal_info)==null?void 0:v.first_name," ",(d=r==null?void 0:r.personal_info)==null?void 0:d.last_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",(g=r==null?void 0:r.user)==null?void 0:g.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Username:"})," ",(s=r==null?void 0:r.user)==null?void 0:s.username]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Phone:"})," ",(l=r==null?void 0:r.personal_info)==null?void 0:l.phone]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Gender:"})," ",r.personal_info.gender.charAt(0).toUpperCase()+r.personal_info.gender.slice(1)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Complete Address:"})," ",r.personal_info.complete_address]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Status:"}),_(r.user.status)]})]})]}),e.jsxs("div",{className:"text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{icon:k,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Identity Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"PRC License Number:"})," ",(r==null?void 0:r.prc_liscence_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"DHSUD Reg. #:"})," ",(r==null?void 0:r.dhsud_registration_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Type:"})," ",(r==null?void 0:r.user.role)===1?"Agent":(r==null?void 0:r.user.role)===2?"Broker":"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Validity Date:"})," ",Y((r==null?void 0:r.validation_date)||"N/A")]})]})]})]})})]}),e.jsx(J,{children:e.jsxs("div",{className:"flex flex-row gap-2 justify-end",children:[e.jsx(K,{asChild:!0,children:e.jsx(w,{className:"bg-red-500 hover:bg-red-400 rounded-lg shadow",children:"Cancel"})}),e.jsx(w,{className:"bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center gap-2",type:"button",onClick:f,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Approving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{icon:E}),e.jsx("span",{children:"Approve"})]})})]})})]})]})}function oe(){const[r,D]=x.useState([]),[h,N]=x.useState(""),[n,m]=x.useState("all");function f(){S.get("agent-broker",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(s=>{D(s.data.pendingAgents)}).catch(s=>{console.log(s)})}const _=async s=>{y.fire({title:"Are you sure?",text:"Do you really want to delete this user?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async l=>{if(l.isConfirmed)try{const a=await S.delete(`agent-broker/${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});y.fire({title:"Deleted!",text:a.data.message,icon:"success",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),f()}catch(a){console.error("Error deleting user:",a),y.fire({title:"Error!",text:"An error occurred while deleting the user.",icon:"error",showConfirmButton:!0})}})};x.useEffect(()=>{f()},[]);const v=s=>{m(s==="all"?"all":parseInt(s))},d=r.filter(s=>{var u,b,p,j;const l=`${(u=s==null?void 0:s.personal_info)==null?void 0:u.first_name} ${(b=s==null?void 0:s.personal_info)==null?void 0:b.last_name}`.toLowerCase(),a=((p=s==null?void 0:s.user)==null?void 0:p.role)===1?"agent":((j=s==null?void 0:s.user)==null?void 0:j.role)===2?"broker":"";return l.includes(h.toLowerCase())||a.includes(h.toLowerCase())}),g=n==="all"?d:d.slice(0,n);return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(F,{onValueChange:v,children:[e.jsxs(L,{className:"w-[120px] border border-primary md:w-28",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(z,{placeholder:"All"})," "]}),e.jsxs(U,{children:[e.jsx(c,{value:"all",children:"All"}),e.jsx(c,{value:"10",children:"10"}),e.jsx(c,{value:"20",children:"20"}),e.jsx(c,{value:"30",children:"30"}),e.jsx(c,{value:"40",children:"40"}),e.jsx(c,{value:"50",children:"50"})]})]}),e.jsx(H,{type:"text",value:h,placeholder:"Search",className:"w-52 md:w-full",onChange:s=>N(s.target.value)})]}),e.jsx("div",{className:"fade-in-left",children:e.jsxs(Q,{children:[e.jsx(W,{className:"bg-primary",children:e.jsxs(C,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Fullname"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Email address"}),e.jsx(t,{children:"Contact number"}),e.jsx(t,{children:"Date Registered"}),e.jsx(t,{className:"text-right",children:"Action"})]})}),e.jsx(Z,{children:g.length>0?g.map((s,l)=>{var a,u,b,p,j,A,T,B;return e.jsxs(C,{children:[e.jsx(o,{className:"font-medium capitalize border border-[#bfdbfe]",children:l+1}),e.jsxs(o,{className:"font-medium capitalize border border-[#bfdbfe]",children:[(a=s==null?void 0:s.personal_info)==null?void 0:a.first_name," ",(u=s==null?void 0:s.personal_info)==null?void 0:u.last_name]}),e.jsx(o,{className:"border border-[#bfdbfe]",children:((b=s==null?void 0:s.user)==null?void 0:b.role)===1?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Agent"}):((p=s==null?void 0:s.user)==null?void 0:p.role)===2?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Broker"}):(j=s==null?void 0:s.user)==null?void 0:j.role}),e.jsx(o,{className:"border border-[#bfdbfe]",children:(A=s==null?void 0:s.user)==null?void 0:A.email}),e.jsx(o,{className:"border border-[#bfdbfe]",children:(T=s==null?void 0:s.personal_info)==null?void 0:T.phone}),e.jsx(o,{className:"border border-[#bfdbfe]",children:$((B=s==null?void 0:s.personal_info)==null?void 0:B.created_at)}),e.jsx(o,{className:"border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-center",children:[e.jsx(ee,{item:s,getPendingRegistered:f}),e.jsx(w,{className:"w-8 h-8 rounded-md bg-red-500 hover:bg-hover-400",onClick:()=>_(s.id),children:e.jsx(i,{icon:P})})]})})]},l)}):e.jsx(C,{children:e.jsx(o,{colSpan:7,className:"text-center border border-[#bfdbfe]",children:"No data available"})})})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",n==="all"?d.length:n," of ",d.length," entries"]})})})]})}export{oe as default};
