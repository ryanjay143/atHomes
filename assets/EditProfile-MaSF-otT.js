import{r as o,j as e,M as P,N as S,O as I,B as k,S as _,c as N}from"./index-CtVFiXrm.js";import{c as A}from"./card-BLC_Y6zo.js";import{I as r}from"./input-D0Gns3XR.js";const v=5,B=v*1024*1024,M=["image/jpeg","image/png","image/jpg","image/webp"],L=()=>{const[x,f]=o.useState(!1),c=o.useRef(null),[g,h]=o.useState(null),[p,b]=o.useState(null),[l,j]=o.useState({username:"",email:"",password:"",password_confirmation:""}),[d,w]=o.useState("account"),[a,m]=o.useState({first_name:"",middle_name:"",last_name:"",extension_name:"",complete_address:"",phone:"",profile_pic:""}),n=i=>{const{name:s,value:t}=i.target;d==="account"?j({...l,[s]:t}):m({...a,[s]:t})},C=i=>{var t;const s=(t=i.target.files)==null?void 0:t[0];if(b(null),s){if(!M.includes(s.type)){b("Only image files (jpeg, jpg, png, webp) are allowed."),h(null),m({...a,profile_pic:""}),c.current&&(c.current.value="");return}if(s.size>B){b(`Image size must be less than ${v}MB.`),h(null),m({...a,profile_pic:""}),c.current&&(c.current.value="");return}const u=URL.createObjectURL(s);h(u),m({...a,profile_pic:s})}},E=async i=>{if(i.preventDefault(),x)return;if(f(!0),p){f(!1),_.fire({title:"Error",text:p,icon:"error",showConfirmButton:!0});return}const s=new FormData;s.append("username",l.username),s.append("email",l.email),s.append("first_name",a.first_name),s.append("middle_name",a.middle_name),s.append("last_name",a.last_name),s.append("extension_name",a.extension_name||""),s.append("phone",a.phone),s.append("complete_address",a.complete_address),l.password&&(s.append("password",l.password),s.append("password_confirmation",l.password_confirmation));const t=document.querySelector('input[type="file"]');t&&t.files&&t.files[0]&&s.append("profile_pic",t.files[0]);try{const u=await N.post("agent/edit-profile",s,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});_.fire({title:"Success",text:u.data.message,icon:"success",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}).then(()=>{c.current&&(c.current.value="")}),y()}catch{}finally{f(!1)}},y=async()=>{try{const i=await N.get("user/agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});j(i.data.user),m(i.data.personalInfo)}catch{}};return o.useEffect(()=>{y()},[]),e.jsx("div",{className:"flex justify-center items-start mt-10 md:min-h-screen md:items-center md:mt-0",children:e.jsxs(A,{className:"max-w-xl w-full bg-white shadow-md rounded-lg p-6 md:w-[90%]",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Edit Profile"}),e.jsxs("div",{className:"flex mb-4",children:[e.jsx("button",{className:`flex-1 py-2 ${d==="account"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>w("account"),children:"User Account"}),e.jsx("button",{className:`flex-1 py-2 ${d==="personal"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>w("personal"),children:"Personal Info"})]}),e.jsxs("form",{onSubmit:E,children:[d==="account"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Username"}),e.jsx(r,{type:"text",name:"username",value:l.username,onChange:n,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Email"}),e.jsx(r,{type:"email",name:"email",value:l.email,onChange:n,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Change password"}),e.jsx(r,{type:"password",name:"password",value:l.password,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Password confirmation"}),e.jsx(r,{type:"password",name:"password_confirmation",value:l.password_confirmation,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]})]}),d==="personal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 md:gap-2 gap-4 mt-10",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Firstname"}),e.jsx(r,{type:"text",name:"first_name",value:a.first_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Middlename"}),e.jsx(r,{type:"text",name:"middle_name",value:a.middle_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Lastname"}),e.jsx(r,{type:"text",name:"last_name",value:a.last_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Extension"}),e.jsx(r,{type:"text",name:"extension_name",value:a.extension_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Address"}),e.jsx(r,{type:"text",name:"complete_address",value:a.complete_address,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Phone"}),e.jsx(r,{type:"text",name:"phone",value:a.phone,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsxs(P,{className:"h-32 w-32 md:h-12 md:w-12 border-primary border-4",children:[g||a.profile_pic?e.jsx(S,{src:g||(typeof a.profile_pic=="string"?`https://athomes.site/${a.profile_pic}`:void 0),alt:"Profile",className:"rounded-full border border-border object-cover"}):null,e.jsx(I,{className:"font-bold text-2xl bg-[#172554] text-[#eff6ff] ",children:a.first_name?a.first_name.charAt(0).toUpperCase():"U"})]})}),e.jsx("p",{className:"text-sm text-red-600",children:"Profile Picture (JPEG, PNG, WEBP, Max 5MB)"}),e.jsx(r,{type:"file",name:"profile_pic",accept:"image/jpeg,image/png,image/jpg,image/webp",className:"w-full px-3 py-2 border rounded-lg",onChange:C,ref:c}),p&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:p})]})})]}),e.jsx(k,{type:"submit",className:"w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin cursor-not-allowed border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save changes"})})})]})]})})};export{L as default};
