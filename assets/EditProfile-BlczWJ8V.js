import{r as i,j as e,M as v,N as _,O as C,B as k,c as j,S as P}from"./index-CGyG3QPo.js";import{c as S}from"./card-CyjfR3bZ.js";import{I as l}from"./input-BQayHSN6.js";const U=()=>{const[m,f]=i.useState(!1),p=i.useRef(null),[x,y]=i.useState(null),[r,h]=i.useState({username:"",email:"",password:"",password_confirmation:""}),[d,b]=i.useState("account"),[a,u]=i.useState({first_name:"",middle_name:"",last_name:"",extension_name:"",complete_address:"",phone:"",profile_pic:""}),n=o=>{const{name:s,value:t}=o.target;d==="account"?h({...r,[s]:t}):u({...a,[s]:t})},w=o=>{var t;const s=(t=o.target.files)==null?void 0:t[0];if(s){const c=URL.createObjectURL(s);y(c),u({...a,profile_pic:s})}},N=async o=>{if(o.preventDefault(),m)return;f(!0);const s=new FormData;s.append("username",r.username),s.append("email",r.email),s.append("first_name",a.first_name),s.append("middle_name",a.middle_name),s.append("last_name",a.last_name),s.append("extension_name",a.extension_name||""),s.append("phone",a.phone),s.append("complete_address",a.complete_address),r.password&&(s.append("password",r.password),s.append("password_confirmation",r.password_confirmation));const t=document.querySelector('input[type="file"]');t&&t.files&&t.files[0]&&s.append("profile_pic",t.files[0]);try{const c=await j.post("admin/edit-profile",s,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});P.fire({title:"Success",text:c.data.message,icon:"success",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}).then(()=>{p.current&&(p.current.value="")}),g()}catch{}finally{f(!1)}},g=async()=>{try{const o=await j.get("agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});h(o.data.user),u(o.data.personalInfo)}catch{}};return i.useEffect(()=>{g()},[]),e.jsx("div",{className:"flex justify-center items-start mt-10 md:min-h-screen md:items-center md:mt-0",children:e.jsxs(S,{className:"max-w-xl w-full bg-white shadow-md rounded-lg p-6 md:w-[90%]",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Edit Profile"}),e.jsxs("div",{className:"flex mb-4",children:[e.jsx("button",{className:`flex-1 py-2 ${d==="account"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>b("account"),children:"User Account"}),e.jsx("button",{className:`flex-1 py-2 ${d==="personal"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>b("personal"),children:"Personal Info"})]}),e.jsxs("form",{onSubmit:N,children:[d==="account"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Username"}),e.jsx(l,{type:"text",name:"username",value:r.username,onChange:n,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Email"}),e.jsx(l,{type:"email",name:"email",value:r.email,onChange:n,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Change password"}),e.jsx(l,{type:"password",name:"password",value:r.password,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Password confirmation"}),e.jsx(l,{type:"password",name:"password_confirmation",value:r.password_confirmation,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]})]}),d==="personal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 md:gap-2 gap-4 mt-10",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Firstname"}),e.jsx(l,{type:"text",name:"first_name",value:a.first_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Middlename"}),e.jsx(l,{type:"text",name:"middle_name",value:a.middle_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Lastname"}),e.jsx(l,{type:"text",name:"last_name",value:a.last_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Extension"}),e.jsx(l,{type:"text",name:"extension_name",value:a.extension_name,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Address"}),e.jsx(l,{type:"text",name:"complete_address",value:a.complete_address,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Phone"}),e.jsx(l,{type:"text",name:"phone",value:a.phone,onChange:n,className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsxs(v,{className:"h-32 w-32 md:h-12 md:w-12 border-primary border-4",children:[x||a.profile_pic?e.jsx(_,{src:x||(typeof a.profile_pic=="string"?`http://192.168.1.9:8000/${a.profile_pic}`:void 0),alt:"Profile",className:"rounded-full border border-border object-cover"}):null,e.jsx(C,{className:"font-bold text-2xl bg-[#172554] text-[#eff6ff] ",children:a.first_name?a.first_name.charAt(0).toUpperCase():"U"})]})}),e.jsx("label",{className:"block text-gray-700",children:"Profile Picture"}),e.jsx(l,{type:"file",name:"profile_pic",className:"w-full px-3 py-2 border rounded-lg",onChange:w,ref:p})]})})]}),e.jsx(k,{type:"submit",className:"w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin cursor-not-allowed border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save changes"})})})]})]})})};export{U as default};
