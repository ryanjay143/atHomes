import{j as e,L as ie,r,u as oe,F as n,a3 as me,a4 as xe,a5 as he,a6 as je,B as h,a7 as fe,a8 as $,a9 as ge,c as ue,S as be}from"./index-BHajTC1L.js";import{c as m,C as x,b as pe,a as j,d as f}from"./card-BS7ZhcBC.js";import{B as Ne,a as we,b as ve,c as Se}from"./breadcrumb-C-Fyjrya.js";import{L as g}from"./label-CXri_Gz7.js";import{S as u,a as b,b as p,c as N,d as a}from"./select-BnW6v0qK.js";import{I as L}from"./input-0N76LP_-.js";import{f as ye,a as Ce,b as k,c as l,d as Re,e as t}from"./table-C2oywTYx.js";import{V as _e}from"./ViewReceipt-CTpHPuSO.js";import"./dialog-CKCL09_l.js";function Le(){return e.jsx("div",{className:"bg-[#172554] flex flex-row items-center gap-4 p-2 rounded-md mb-5 ",children:e.jsx("div",{className:" flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right",children:e.jsx(Ne,{children:e.jsxs(we,{children:[e.jsx(ve,{className:"text-accent",children:e.jsx(ie,{to:"/atHomes/admin/sales-repor",children:"Sales Report"})}),e.jsx(Se,{})]})})})})}function Ie(){const[w,O]=r.useState([]),[c,D]=r.useState(""),[A,P]=r.useState(10),[K,Q]=r.useState([]),[v,T]=r.useState(""),[S,F]=r.useState(""),[y,B]=r.useState(""),[C,E]=r.useState(""),[R,H]=r.useState(""),[z,I]=r.useState(!1),U=oe(),W=async()=>{try{const s=await ue.get("sales-encoding",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});O(s.data.salesEncodingReports),Q(s.data.agents)}catch(s){console.error("Error fetching data:",s),be.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),U("/atHomes")}};r.useEffect(()=>{W()},[]);const X=s=>s>=1e6?`${(s/1e6).toFixed(2)} M`:s>=1e3?`${(s/1e3).toFixed(2)} K`:_.format(s),M=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),_=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),q=s=>{D(s.target.value)},G=s=>{P(s==="all"?w.length:parseInt(s,10))},J=s=>{T(s.target.value)},Y=s=>{F(s.target.value)},Z=s=>{B(s)},ee=s=>{E(s)},se=s=>{H(s)},V=w.filter(s=>{const i=`${s.agent.personal_info.first_name} ${s.agent.personal_info.middle_name} ${s.agent.personal_info.last_name}`.toLowerCase(),o=new Date(s.date_on_sale),le=(!v||o>=new Date(v))&&(!S||o<=new Date(S)),ne=!y||s.agent.id===y,de=!C||s.category===C,ce=!R||s.remarks.toLowerCase()===R.toLowerCase();return le&&ne&&de&&ce&&(s.agent.user.acct_number.toLowerCase().includes(c.toLowerCase())||s.client_name.toLowerCase().includes(c.toLowerCase())||i.includes(c.toLowerCase())||s.category.toLowerCase().includes(c.toLowerCase()))}),d=V.slice(0,A),ae=d.reduce((s,i)=>{const o=parseFloat(i.amount);return s+(isNaN(o)?0:o)},0),re=d.filter(s=>s.remarks.toLowerCase()==="sold").length,te=d.filter(s=>s.remarks.toLowerCase()==="not sold").length;return e.jsx("div",{className:"py-5 md:pt-20",children:e.jsxs("div",{className:"ml-72 md:ml-0 md:w-full gap-2 items-start justify-center mr-5 md:px-5",children:[e.jsx(Le,{}),e.jsxs(m,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left",children:[e.jsx(x,{children:e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 md:gap-8",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-4 md:gap-4 w-full",children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(g,{children:"Date Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(L,{type:"date",className:"w-full md:w-[160px]",placeholder:"Start Date",value:v,onChange:J}),e.jsx("span",{className:"flex items-center",children:"-"}),e.jsx(L,{type:"date",className:"w-full md:w-[160px]",placeholder:"End Date",value:S,onChange:Y})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(g,{children:"Agent/Broker"}),e.jsxs(u,{onValueChange:Z,value:y,children:[e.jsx(b,{className:"w-full md:w-[340px]",children:e.jsx(p,{placeholder:"Select agent or broker"})}),e.jsx(N,{children:K.map(s=>e.jsxs(a,{value:s.id,children:[s.personal_info.first_name," ",s.personal_info.middle_name," ",s.personal_info.last_name," ",s.personal_info.extension_name]},s.id))})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(g,{children:"Category"}),e.jsxs(u,{onValueChange:ee,value:C,children:[e.jsx(b,{children:e.jsx(p,{placeholder:"Select category"})}),e.jsxs(N,{children:[e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(g,{children:"Remarks"}),e.jsxs(u,{onValueChange:se,value:R,children:[e.jsx(b,{children:e.jsx(p,{placeholder:"Select remarks"})}),e.jsxs(N,{children:[e.jsx(a,{value:"Sold",children:"Sold"}),e.jsx(a,{value:"Not Sold",children:"Not Sold"}),e.jsx(a,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(a,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]})]})})}),e.jsxs(pe,{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 gap-2 md:gap-4",children:[e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{className:"text-xl font-bold text-primary",children:X(ae)}),e.jsx("div",{className:"bg-primary bg-opacity-10 p-2 rounded-md flex items-center gap-2",children:e.jsx(n,{icon:me,className:"ml-2 h-10 text-white"})})]}),e.jsx(f,{className:"font-bold text-primary md:text-xs",children:"Total Sales"})]})})}),e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{className:"text-xl font-bold text-primary",children:d.length}),e.jsx("div",{className:"bg-primary bg-opacity-10 p-2 rounded-md flex items-center gap-2",children:e.jsx(n,{icon:xe,className:"ml-2 h-10 text-white"})})]}),e.jsx(f,{className:"font-bold text-primary md:text-xs",children:"Total Reservation"})]})})}),e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{className:"text-xl font-bold text-green-500",children:re}),e.jsx("div",{className:"bg-green-500 p-2 rounded-md flex items-center gap-2",children:e.jsx(n,{icon:he,className:"ml-2 h-10 text-white"})})]}),e.jsx(f,{className:"font-bold text-green-500 md:text-xs",children:"Sold Properties"})]})})}),e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{className:"text-xl font-bold text-red-500",children:te}),e.jsx("div",{className:"bg-red-500 p-2 rounded-md flex items-center gap-2",children:e.jsx(n,{icon:je,className:"ml-2 h-10 text-white"})})]}),e.jsx(f,{className:"font-bold text-red-500 md:text-xs",children:"Not Sold Properties"})]})})})]}),e.jsxs("div",{className:"flex flex-row md:grid md:grid-cols-2 justify-end items-start md:items-center gap-2 md:gap-4 pt-5",children:[e.jsxs(h,{onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),onClick:()=>{P(w.length),D(""),T(""),F(""),B(""),E(""),H("")},children:[e.jsx(n,{icon:fe,className:`${z?"animate-spin":""}`}),"Refresh list"]}),e.jsxs(h,{className:"bg-red-500 text-white hover:bg-red-400 hover:text-white",children:[e.jsx(n,{icon:$}),"Export to PDF"]}),e.jsxs(h,{className:"bg-green-500 text-white hover:bg-green-400 hover:text-white",children:[e.jsx(n,{icon:$}),"Export to Excel"]}),e.jsxs(h,{children:[e.jsx(n,{icon:ge}),"Print Report"]})]}),e.jsxs("div",{className:"py-2 mt-5 flex flex-row justify-between",children:[e.jsxs(u,{onValueChange:G,children:[e.jsxs(b,{className:"w-[120px] border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(p,{placeholder:"All"})]}),e.jsxs(N,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"10",children:"10"}),e.jsx(a,{value:"20",children:"20"}),e.jsx(a,{value:"30",children:"30"}),e.jsx(a,{value:"40",children:"40"}),e.jsx(a,{value:"50",children:"50"})]})]}),e.jsx(L,{type:"text",placeholder:"Search",className:"w-52",value:c,onChange:q})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(ye,{children:[e.jsx(Ce,{className:"bg-primary text-base",children:e.jsxs(k,{children:[e.jsx(l,{children:"#"}),e.jsx(l,{children:"Account No."}),e.jsx(l,{children:"Affiliated"}),e.jsx(l,{children:"Client name"}),e.jsx(l,{children:"Category"}),e.jsx(l,{children:"Reservation date"}),e.jsx(l,{children:"Location"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{children:"Remarks"}),e.jsx(l,{className:"text-right",children:"Action"})]})}),e.jsxs(Re,{children:[d.length===0&&e.jsx(k,{children:e.jsx(t,{colSpan:10,className:"text-center",children:"No data found."})}),d.map((s,i)=>e.jsxs(k,{children:[e.jsx(t,{className:"font-medium border border-[#bfdbfe]",children:i+1}),e.jsx(t,{className:"font-medium border border-[#bfdbfe]",children:s.agent.user.acct_number}),e.jsxs(t,{className:"border border-[#bfdbfe]",children:[s.agent.personal_info.first_name," ",s.agent.personal_info.middle_name," ",s.agent.personal_info.last_name]}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.category}),e.jsx(t,{className:"border border-[#bfdbfe]",children:M.format(new Date(s.date_on_sale))}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(t,{className:"border border-[#bfdbfe]",children:_.format(s.amount)}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(t,{className:"text-right border border-[#bfdbfe]",children:e.jsx("div",{className:"flex flex-row gap-1 justify-end",children:e.jsx(_e,{sales:s,dateFormatter:M,currencyFormatter:_})})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",Math.min(A,d.length)," of ",V.length," entries"]})})})]})]})]})})}export{Ie as default};
