import{j as e,L as ie,r,u as oe,F as d,a3 as me,a4 as xe,a5 as he,a6 as je,B as _,a7 as fe,a8 as $,c as ge,S as ue}from"./index-B_KwSePJ.js";import{c as m,C as x,b as be,a as h,d as j}from"./card-CZDrutuD.js";import{B as pe,a as Ne,b as we,c as ve}from"./breadcrumb-Byj5Pm4P.js";import{L as f}from"./label-Ev2PhvIV.js";import{S as g,a as u,b,c as p,d as a}from"./select-B-F1zYJA.js";import{I as L}from"./input-DhskOc54.js";import{f as Se,a as ye,b as D,c as l,d as Ce,e as t}from"./table-BKLy6l2S.js";import{V as Re}from"./ViewReceipt-DiPZTVuG.js";import"./dialog-DDwq7tbK.js";function _e(){return e.jsx("div",{className:"bg-[#172554] flex flex-row items-center gap-4 p-2 rounded-md mb-5 ",children:e.jsx("div",{className:" flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right",children:e.jsx(pe,{children:e.jsxs(Ne,{children:[e.jsx(we,{className:"text-accent",children:e.jsx(ie,{to:"/admin/sales-repor",children:"Sales Report"})}),e.jsx(ve,{})]})})})})}function He(){const[N,O]=r.useState([]),[c,k]=r.useState(""),[A,P]=r.useState(10),[K,Q]=r.useState([]),[w,T]=r.useState(""),[v,F]=r.useState(""),[S,B]=r.useState(""),[y,E]=r.useState(""),[C,H]=r.useState(""),[z,I]=r.useState(!1),U=oe(),W=async()=>{try{const s=await ge.get("sales-encoding",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});O(s.data.salesEncodingReports),Q(s.data.agents)}catch(s){console.error("Error fetching data:",s),ue.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),U("/")}};r.useEffect(()=>{W()},[]);const X=s=>s>=1e6?`${(s/1e6).toFixed(2)} M`:s>=1e3?`${(s/1e3).toFixed(2)} K`:R.format(s),M=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),R=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),q=s=>{k(s.target.value)},G=s=>{P(s==="all"?N.length:parseInt(s,10))},J=s=>{T(s.target.value)},Y=s=>{F(s.target.value)},Z=s=>{B(s)},ee=s=>{E(s)},se=s=>{H(s)},V=N.filter(s=>{const i=`${s.agent.personal_info.first_name} ${s.agent.personal_info.middle_name} ${s.agent.personal_info.last_name}`.toLowerCase(),o=new Date(s.date_on_sale),le=(!w||o>=new Date(w))&&(!v||o<=new Date(v)),ne=!S||s.agent.id===S,de=!y||s.category===y,ce=!C||s.remarks.toLowerCase()===C.toLowerCase();return le&&ne&&de&&ce&&(s.agent.user.acct_number.toLowerCase().includes(c.toLowerCase())||s.client_name.toLowerCase().includes(c.toLowerCase())||i.includes(c.toLowerCase())||s.category.toLowerCase().includes(c.toLowerCase()))}),n=V.slice(0,A),ae=n.reduce((s,i)=>{const o=parseFloat(i.amount);return s+(isNaN(o)?0:o)},0),re=n.filter(s=>s.remarks.toLowerCase()==="sold").length,te=n.filter(s=>s.remarks.toLowerCase()==="not sold").length;return e.jsx("div",{className:"py-5 md:pt-20",children:e.jsxs("div",{className:"ml-72 md:ml-0 md:w-full gap-2 items-start justify-center mr-5 md:px-5",children:[e.jsx(_e,{}),e.jsxs(m,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left",children:[e.jsx(x,{children:e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 md:gap-8",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-4 md:gap-4 w-full",children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(f,{children:"Date Range"}),e.jsxs("div",{className:"flex flex-row gap-2 md:flex-col",children:[e.jsx(L,{type:"date",className:"w-full",placeholder:"Start Date",value:w,onChange:J}),e.jsx("span",{className:"flex items-center md:hidden",children:"-"}),e.jsx(L,{type:"date",className:"w-full",placeholder:"End Date",value:v,onChange:Y})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(f,{children:"Agent/Broker"}),e.jsxs(g,{onValueChange:Z,value:S,children:[e.jsx(u,{className:"w-full",children:e.jsx(b,{placeholder:"Select agent or broker"})}),e.jsx(p,{children:K.map(s=>e.jsxs(a,{value:s.id,children:[s.personal_info.first_name," ",s.personal_info.middle_name," ",s.personal_info.last_name," ",s.personal_info.extension_name]},s.id))})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(f,{children:"Category"}),e.jsxs(g,{onValueChange:ee,value:y,children:[e.jsx(u,{children:e.jsx(b,{placeholder:"Select category"})}),e.jsxs(p,{children:[e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(f,{children:"Remarks"}),e.jsxs(g,{onValueChange:se,value:C,children:[e.jsx(u,{children:e.jsx(b,{placeholder:"Select remarks"})}),e.jsxs(p,{children:[e.jsx(a,{value:"Sold",children:"Sold"}),e.jsx(a,{value:"Not Sold",children:"Not Sold"}),e.jsx(a,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(a,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]})]})})}),e.jsxs(be,{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 gap-2 md:gap-4",children:[e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"text-xl font-bold text-primary",children:X(ae)}),e.jsx("div",{className:"bg-primary bg-opacity-10 p-2 rounded-md flex items-center gap-2",children:e.jsx(d,{icon:me,className:"ml-2 h-10 text-white"})})]}),e.jsx(j,{className:"font-bold text-primary md:text-xs",children:"Total Sales"})]})})}),e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"text-xl font-bold text-primary",children:n.length}),e.jsx("div",{className:"bg-primary bg-opacity-10 p-2 rounded-md flex items-center gap-2",children:e.jsx(d,{icon:xe,className:"ml-2 h-10 text-white"})})]}),e.jsx(j,{className:"font-bold text-primary md:text-xs",children:"Total Reservation"})]})})}),e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"text-xl font-bold text-green-500",children:re}),e.jsx("div",{className:"bg-green-500 p-2 rounded-md flex items-center gap-2",children:e.jsx(d,{icon:he,className:"ml-2 h-10 text-white"})})]}),e.jsx(j,{className:"font-bold text-green-500 md:text-xs",children:"Sold Properties"})]})})}),e.jsx("div",{children:e.jsx(m,{className:"max-h-32 border border-b-4 border-primary shadow-md",children:e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"text-xl font-bold text-red-500",children:te}),e.jsx("div",{className:"bg-red-500 p-2 rounded-md flex items-center gap-2",children:e.jsx(d,{icon:je,className:"ml-2 h-10 text-white"})})]}),e.jsx(j,{className:"font-bold text-red-500 md:text-xs",children:"Not Sold Properties"})]})})})]}),e.jsxs("div",{className:"flex flex-row md:grid md:grid-cols-2 justify-end items-start md:items-center gap-2 md:gap-4 pt-5",children:[e.jsxs(_,{onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),onClick:()=>{P(N.length),k(""),T(""),F(""),B(""),E(""),H("")},children:[e.jsx(d,{icon:fe,className:`${z?"animate-spin":""}`}),"Refresh list"]}),e.jsxs(_,{className:"bg-red-500 text-white hover:bg-red-400 hover:text-white",children:[e.jsx(d,{icon:$}),"Download as PDF"]}),e.jsxs(_,{className:"bg-green-500 text-white hover:bg-green-400 hover:text-white",children:[e.jsx(d,{icon:$}),"Download as Excel"]})]}),e.jsxs("div",{className:"py-2 mt-5 flex flex-row justify-between gap-4",children:[e.jsxs(g,{onValueChange:G,children:[e.jsxs(u,{className:"w-[120px] border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(b,{placeholder:"All"})]}),e.jsxs(p,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"10",children:"10"}),e.jsx(a,{value:"20",children:"20"}),e.jsx(a,{value:"30",children:"30"}),e.jsx(a,{value:"40",children:"40"}),e.jsx(a,{value:"50",children:"50"})]})]}),e.jsx(L,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:c,onChange:q})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Se,{children:[e.jsx(ye,{className:"bg-primary text-base",children:e.jsxs(D,{children:[e.jsx(l,{children:"#"}),e.jsx(l,{children:"Account No."}),e.jsx(l,{children:"Affiliated"}),e.jsx(l,{children:"Client name"}),e.jsx(l,{children:"Category"}),e.jsx(l,{children:"Reservation date"}),e.jsx(l,{children:"Location"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{className:"text-right",children:"Action"})]})}),e.jsxs(Ce,{children:[n.length===0&&e.jsx(D,{children:e.jsx(t,{colSpan:10,className:"text-center",children:"No data found."})}),n.map((s,i)=>e.jsxs(D,{children:[e.jsx(t,{className:"font-medium border border-[#bfdbfe]",children:i+1}),e.jsx(t,{className:"font-medium border border-[#bfdbfe]",children:s.agent.user.acct_number}),e.jsxs(t,{className:"border border-[#bfdbfe]",children:[s.agent.personal_info.first_name," ",s.agent.personal_info.middle_name," ",s.agent.personal_info.last_name]}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.category}),e.jsx(t,{className:"border border-[#bfdbfe]",children:M.format(new Date(s.date_on_sale))}),e.jsx(t,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(t,{className:"border border-[#bfdbfe]",children:R.format(s.amount)}),e.jsx(t,{className:"text-right border border-[#bfdbfe]",children:e.jsx("div",{className:"flex flex-row gap-1 justify-end",children:e.jsx(Re,{sales:s,dateFormatter:M,currencyFormatter:R})})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",Math.min(A,n.length)," of ",V.length," entries"]})})})]})]})]})})}export{He as default};
