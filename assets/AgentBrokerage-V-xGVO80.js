import{r,j as e,B as Y,F as Z,k as me,l as he,c as le,S as ee,L as ue,f as ge,u as je}from"./index-BWeMivr7.js";import{a as fe,C as pe,b as be}from"./card-CzLo0aO8.js";import{L as d}from"./label-B2kymImT.js";import{S as _,a as R,b as F,c as O,d as a}from"./select-TVlSta-E.js";import{I as h}from"./input-Hb8YChNP.js";import{T as ve,a as ye,b as X,c as f,d as Ne,e as u}from"./table-44yGdPQK.js";import{D as $,a as ne,b as U,c as z,d as Q,e as G,f as Se}from"./dialog-BEqO58Hi.js";import{T as we}from"./textarea-Dy3RGf5N.js";import{B as Ce,a as Pe,b as Le,c as De}from"./breadcrumb-3dBFIqrI.js";function Ae({onClose:o,fetchPropertiesData:L}){const[c,g]=r.useState(""),[m,p]=r.useState(()=>new Date().toISOString().split("T")[0]),[D,E]=r.useState(""),[b,k]=r.useState(""),[j,B]=r.useState(""),[v,q]=r.useState(""),[y,N]=r.useState(""),[H,S]=r.useState(""),[w,s]=r.useState([]),[A,T]=r.useState([]),[I,V]=r.useState(!1),[l,ie]=r.useState({}),[ce,se]=r.useState(!1),[K,te]=r.useState(null),[J,ae]=r.useState(""),[M,re]=r.useState(""),W=r.useRef(null),oe=t=>{const n=t.target.files;if(n){const i=Array.from(n);s(i);const x=[];i.forEach(C=>{const P=new FileReader;P.onload=()=>{P.result&&(x.push(P.result),T([...x]))},P.readAsDataURL(C)})}},de=(t,n)=>{n.preventDefault();const i=w.filter((x,C)=>C!==t);if(s(i),T(x=>x.filter((C,P)=>P!==t)),W.current){const x=new DataTransfer;i.forEach(C=>x.items.add(C)),W.current.files=x.files}},xe=async t=>{if(t.preventDefault(),I)return;const n={};if(c||(n.category="Category is required."),m||(n.dateListed="Date listed is required."),D||(n.lotArea="Lot area is required."),b||(n.floorArea="Floor area is required."),j||(n.otherDetails="Other details are required."),v||(n.location="Location is required."),y||(n.type="Type of listing is required."),H||(n.status="Status is required."),w.length===0&&(n.images="At least one image is required."),c==="Rental Properties"&&!J&&(n.rentalRate="Rental rate is required."),c==="Commercial Properties"&&!M&&(n.sellingPrice="Selling price is required."),ie(n),Object.keys(n).length>0)return;V(!0);const i=new FormData;i.append("category",c),i.append("date_listed",m),i.append("lot_area",D),i.append("floor_area",b),i.append("details",j),i.append("location",v),i.append("type_of_listing",y),i.append("status",H),c==="Rental Properties"?i.append("price_and_rate",J):c==="Commercial Properties"?i.append("price_and_rate",M):i.append("price_and_rate",""),w.forEach(x=>{i.append("images[]",x)});try{const x=await le.post("user/agent-broker",i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});se(!1),L(),ee.fire({icon:"success",title:"Success",text:"Property listing created successfully.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),console.log("Property listing created successfully:",x.data),g(""),E(""),k(""),B(""),q(""),N(""),S(""),s([]),T([]),ae(""),re(""),o()}catch(x){console.error("Error creating property listing:",x),ee.fire({icon:"error",title:"Error",text:"There was an error creating the property listing. Please try again."})}finally{V(!1)}};return e.jsxs($,{open:ce,onOpenChange:se,children:[e.jsx(ne,{children:e.jsxs(Y,{className:"",children:[e.jsx(Z,{icon:me}),"Add Brokerage"]})}),e.jsx(U,{className:"md:w-[90%] overflow-auto max-h-[95%]",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{children:"Add New Property Listing"}),e.jsx(G,{children:e.jsxs("form",{onSubmit:xe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Category"}),e.jsxs(_,{value:c,onValueChange:g,children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select category"})}),e.jsxs(O,{children:[e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"})]})]}),l.category&&e.jsx("p",{className:"text-red-500 text-sm",children:l.category})]}),c==="Rental Properties"&&e.jsxs("div",{children:[e.jsx(d,{children:"Rental Rate"}),e.jsx(h,{type:"number",value:J,onChange:t=>ae(t.target.value),placeholder:"0.00"}),l.rentalRate&&e.jsx("p",{className:"text-red-500 text-sm",children:l.rentalRate})]}),c==="Commercial Properties"&&e.jsxs("div",{children:[e.jsx(d,{children:"Selling Price"}),e.jsx(h,{type:"number",value:M,onChange:t=>re(t.target.value),placeholder:"0.00"}),l.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm",children:l.sellingPrice})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Date Listed"}),e.jsx(h,{type:"date",value:m,onChange:t=>p(t.target.value)}),l.dateListed&&e.jsx("p",{className:"text-red-500 text-sm",children:l.dateListed})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Lot Area (sqm)"}),e.jsx(h,{type:"number",value:D,onChange:t=>E(t.target.value)}),l.lotArea&&e.jsx("p",{className:"text-red-500 text-sm",children:l.lotArea})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Floor Area (sqm)"}),e.jsx(h,{type:"number",value:b,onChange:t=>k(t.target.value)}),l.floorArea&&e.jsx("p",{className:"text-red-500 text-sm",children:l.floorArea})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Other Details"}),e.jsx(we,{value:j,onChange:t=>B(t.target.value),className:"w-full border rounded-md p-2",rows:3}),l.otherDetails&&e.jsx("p",{className:"text-red-500 text-sm",children:l.otherDetails})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Location"}),e.jsx(h,{type:"text",value:v,onChange:t=>q(t.target.value)}),l.location&&e.jsx("p",{className:"text-red-500 text-sm",children:l.location})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Type of Listing"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Exclusive",checked:y==="Exclusive",onChange:t=>N(t.target.value)}),e.jsx("span",{children:"Exclusive"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"type",value:"Non-Exclusive",checked:y==="Non-Exclusive",onChange:t=>N(t.target.value)}),e.jsx("span",{children:"Non-Exclusive"})]})]}),l.type&&e.jsx("p",{className:"text-red-500 text-sm",children:l.type})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Status of Property"}),e.jsxs(_,{value:H,onValueChange:S,children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select status"})}),e.jsxs(O,{children:[e.jsx(a,{value:"Sold",children:"Sold"}),e.jsx(a,{value:"Not Sold",children:"Not Sold"}),e.jsx(a,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(a,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),l.status&&e.jsx("p",{className:"text-red-500 text-sm",children:l.status})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Upload Property Images"}),e.jsx(h,{type:"file",multiple:!0,onChange:oe,ref:W}),l.images&&e.jsx("p",{className:"text-red-500 text-sm",children:l.images}),e.jsx("div",{className:"flex space-x-2 mt-2",children:A.map((t,n)=>e.jsxs("div",{className:"relative w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",children:[e.jsx("img",{src:t,alt:`Preview ${n+1}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",onClick:()=>te(t)}),e.jsx("button",{className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center",onClick:i=>de(n,i),children:e.jsx(Z,{icon:he})})]},n))}),K&&e.jsx($,{open:!!K,onOpenChange:()=>te(null),children:e.jsx(U,{className:"max-w-[425px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(G,{children:e.jsx("img",{src:K,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]})]}),e.jsx(Se,{className:"flex justify-end space-x-2",children:e.jsx(Y,{type:"submit",disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Submit"})})})})]})})]})})]})}function Te(){return e.jsx("div",{className:"bg-[#172554] flex flex-row items-center gap-4 p-2 rounded-md mb-5 ",children:e.jsx("div",{className:" flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right",children:e.jsx(Ce,{children:e.jsxs(Pe,{children:[e.jsx(Le,{className:"text-accent",children:e.jsx(ue,{to:"/athomes/agent-broker/agent-brokerage",children:"Property Listing"})}),e.jsx(De,{})]})})})})}function Ie({property:o,dateFormatter:L}){const[c,g]=r.useState(null);return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(ne,{children:e.jsx(Y,{className:"h-8 w-8 font-medium bg-blue-500 hover:bg-blue-400 text-sm rounded-md",children:e.jsx(Z,{icon:ge})})}),e.jsx(U,{className:"md:max-w-[400px] md:w-[90%] p-6 overflow-auto max-h-[95%] bg-white rounded-lg shadow-lg",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{className:"text-xl font-bold mb-4",children:"View Property Listing"}),e.jsx(G,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"General Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",o.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date Listed:"})," ",L.format(new Date(o.date_listed))]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",o.location]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type of Listing:"})," ",o.type_of_listing]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",o.status]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Description of Property"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lot Area:"})," ",o.lot_area," sqm"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Floor Area:"})," ",o.floor_area," sqm"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Other Details:"})," ",o.details||"N/A"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Property Images"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 flex-wrap mt-4",children:o.property_images&&o.property_images.length>0?o.property_images.map((m,p)=>e.jsx("div",{className:"w-20 h-20 bg-gray-200 flex items-center justify-center rounded-md shadow-md overflow-hidden cursor-pointer",onClick:()=>g(`https://athomes.site/${m.images}`),children:e.jsx("img",{src:`https://athomes.site/${m.images}`,className:"object-cover w-full h-full transform transition-transform duration-300 hover:scale-110",alt:`Property Image ${p+1}`})},p)):e.jsx("p",{children:"No images available"})})]})]})})]})})]}),c&&e.jsx($,{open:!!c,onOpenChange:()=>g(null),children:e.jsx(U,{className:"max-w-[425px] md:w-[90%] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs(z,{className:"text-start",children:[e.jsx(Q,{className:"text-xl font-bold mb-4",children:"Image Preview"}),e.jsx(G,{children:e.jsx("img",{src:c,alt:"Selected Property",className:"w-full h-auto rounded-md"})})]})})})]})}function Ve(){const[o,L]=r.useState(!1),[c,g]=r.useState([]),[m,p]=r.useState(""),[D,E]=r.useState(10),[b,k]=r.useState("all"),[j,B]=r.useState(""),[v,q]=r.useState("all"),y=je(),N=async()=>{try{const s=await le.get("user/agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});g(s.data.property),console.log("Property:",s.data.property)}catch(s){console.error("Error fetching data:",s),ee.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),y("/athomes")}};r.useEffect(()=>{N()},[]);const S=c.filter(s=>{const A=b==="all"||s.category===b,T=!j||new Date(s.date_listed).toISOString().split("T")[0]===j,I=v==="all"||s.status===v,V=s.category.toLowerCase().includes(m.toLowerCase())||s.location.toLowerCase().includes(m.toLowerCase())||s.type_of_listing.toLowerCase().includes(m.toLowerCase())||s.status.toLowerCase().includes(m.toLowerCase());return A&&T&&I&&V}).slice(0,D),w=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"});return e.jsx("div",{className:"py-5 md:pt-20",children:e.jsxs("div",{className:"ml-72 md:ml-0 md:w-full gap-2 items-start justify-center mr-5 md:px-5",children:[e.jsx(Te,{}),e.jsxs(fe,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left",children:[e.jsx(pe,{children:e.jsxs("div",{className:"flex flex-row md:flex-col gap-4 justify-between",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-1 gap-4 md:mt-0",children:[e.jsxs("div",{className:"grid w-full gap-1.5",children:[e.jsx(d,{children:"Category"}),e.jsxs(_,{onValueChange:k,children:[e.jsx(R,{className:"md:w-full",children:e.jsx(F,{placeholder:"Select category"})}),e.jsxs(O,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(d,{children:"Date Listed"}),e.jsx(h,{type:"date",className:"md:w-full",value:j,onChange:s=>B(s.target.value)})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(d,{children:"Filter Status"}),e.jsxs(_,{onValueChange:q,children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select status"})}),e.jsxs(O,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"Sold",children:"Sold"}),e.jsx(a,{value:"Not Sold",children:"Not Sold"})]})]})]})]}),e.jsx("div",{className:"md:flex md:justify-end md:items-center md:w-full",children:e.jsx(Ae,{isOpen:o,fetchPropertiesData:N,onClose:()=>L(!1)})})]})}),e.jsxs(be,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(_,{onValueChange:s=>E(s==="all"?c.length:parseInt(s,10)),children:[e.jsxs(R,{className:"w-[120px] md:w-full border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(F,{placeholder:"All"})]}),e.jsxs(O,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"5",children:"5"}),e.jsx(a,{value:"10",children:"10"}),e.jsx(a,{value:"20",children:"20"}),e.jsx(a,{value:"30",children:"30"}),e.jsx(a,{value:"40",children:"40"}),e.jsx(a,{value:"50",children:"50"})]})]}),e.jsx(h,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:m,onChange:s=>p(s.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(ve,{children:[e.jsx(ye,{className:"bg-primary text-base",children:e.jsxs(X,{children:[e.jsx(f,{children:"#"}),e.jsx(f,{children:"Category"}),e.jsx(f,{children:"Date Listed"}),e.jsx(f,{children:"Location"}),e.jsx(f,{children:"Type"}),e.jsx(f,{children:"Status"}),e.jsx(f,{className:"text-right",children:"Action"})]})}),e.jsxs(Ne,{children:[S.length===0&&e.jsx(X,{children:e.jsx(u,{colSpan:7,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),S.map((s,A)=>e.jsxs(X,{children:[e.jsx(u,{className:"font-medium border border-[#bfdbfe]",children:A+1}),e.jsx(u,{className:"font-medium border border-[#bfdbfe]",children:s.category}),e.jsx(u,{className:"border border-[#bfdbfe]",children:w.format(new Date(s.date_listed))}),e.jsx(u,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(u,{className:"border border-[#bfdbfe]",children:s.type_of_listing}),e.jsx(u,{className:"border border-[#bfdbfe]",children:s.status==="Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:s.status}):s.status==="Not Sold"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:s.status}):s.status==="Pre-Selling"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-red-700/10 ring-inset",children:s.status}):s.status==="RFO"?e.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Ready for Occupancy"}):null}),e.jsx(u,{className:"text-right border border-[#bfdbfe]",children:e.jsx("div",{className:"flex flex-row gap-1 justify-end",children:e.jsx(Ie,{property:s,dateFormatter:w})})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",S.length," of ",c.length," entries"]})})})]})]})]})})}export{Ve as default};
