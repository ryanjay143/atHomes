import{r as n,j as e,u as R,c as P,S as k}from"./index-B2F-cfNY.js";import{f as A}from"./dateUtils-D6w6W0GJ.js";import{c as b,C as E,a as g,b as p}from"./card-C-i4lHXn.js";import{C as F}from"./react-apexcharts.min-CzIUmsqI.js";import{I as N}from"./input-Cc_DrF-H.js";import{f as w,a as v,b as x,c as i,d as C,e as a}from"./table-CovYnLKb.js";function H({chartData:t,totalSales:c,currencyFormatter:d}){const[o,l]=n.useState(!1),r={series:[{name:"Sales",data:t}],options:{chart:{type:"line",height:350},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},stroke:{curve:"smooth"},title:{text:"Sales from January to December",align:"left"},tooltip:{y:{formatter:s=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s)}}}};return n.useEffect(()=>{l(!0)},[]),e.jsx("div",{children:e.jsxs(b,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full",children:[e.jsx(E,{children:e.jsx(g,{children:"Total Sales"})}),e.jsxs(p,{children:[e.jsx("p",{className:"text-lg font-semibold",children:d.format(c)}),e.jsx("div",{className:"w-full md:w-full mt-6",children:o&&e.jsx(F,{options:r.options,series:r.series,type:"line",height:350})})]})]})})}function I({topPerformers:t,currencyFormatter:c}){const[d,o]=n.useState(""),l=n.useMemo(()=>{if(!d.trim())return t;const r=d.toLowerCase();return t.filter(s=>[s.first_name,s.middle_name,s.last_name,s.extension_name,s.role,String(s.totalReserved),String(s.totalSales)].filter(Boolean).join(" ").toLowerCase().includes(r))},[d,t]);return e.jsx("div",{children:e.jsx(b,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full h-full max-h-full",children:e.jsx(p,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"py-5 flex flex-row justify-between items-center",children:[e.jsx(g,{children:"Top Affiliated Rankings"}),e.jsx(N,{type:"text",placeholder:"Search",className:"w-52",value:d,onChange:r=>o(r.target.value)})]}),e.jsxs(w,{children:[e.jsx(v,{children:e.jsxs(x,{children:[e.jsx(i,{children:"Rank"}),e.jsx(i,{children:"Affiliated"}),e.jsx(i,{children:"Role"}),e.jsx(i,{children:"Total Reserved"}),e.jsx(i,{children:"Total Sales"})]})}),e.jsxs(C,{children:[l.length===0&&e.jsx(x,{children:e.jsx(a,{colSpan:5,className:"text-center",children:"No data available"})}),l.map((r,s)=>e.jsxs(x,{children:[e.jsx(a,{className:"font-medium border border-[#bfdbfe]",children:s+1}),e.jsxs(a,{className:"font-medium border border-[#bfdbfe]",children:[r.first_name," ",r.middle_name," ",r.last_name," ",r.extension_name]}),e.jsx(a,{className:"font-medium border border-[#bfdbfe]",children:r.role}),e.jsx(a,{className:"font-medium border border-[#bfdbfe]",children:r.totalReserved}),e.jsx(a,{className:"font-medium border border-[#bfdbfe]",children:c.format(r.totalSales)})]},r.id))]})]}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing ",l.length===0?0:1," to ",l.length," of ",l.length," entries"]})})})]})})})})}function B({sales:t,formatDateToMMDDYYYYDateApproved:c,currencyFormatter:d}){const[o,l]=n.useState(""),r=n.useMemo(()=>{if(!o.trim())return t;const s=o.toLowerCase();return t.filter(f=>[f.category,f.remarks,c(f.date_on_sale),String(f.amount)].filter(Boolean).join(" ").toLowerCase().includes(s))},[o,t,c]);return e.jsx(e.Fragment,{children:e.jsx(b,{className:"bg-[#eff6ff] border-b-4 border-primary w-full md:w-full",children:e.jsxs(p,{children:[e.jsxs("div",{className:"py-5 flex flex-row justify-between items-center",children:[e.jsx(g,{children:"Top 5 Recent Sales"}),e.jsx(N,{type:"text",placeholder:"Search",className:"w-52",value:o,onChange:s=>l(s.target.value)})]}),e.jsxs(w,{children:[e.jsx(v,{children:e.jsxs(x,{children:[e.jsx(i,{children:"Top"}),e.jsx(i,{children:"Reservation date"}),e.jsx(i,{children:"Category"}),e.jsx(i,{children:"Remarks"}),e.jsx(i,{children:"Amount"})]})}),e.jsxs(C,{children:[r.length===0&&e.jsx(x,{children:e.jsx(a,{colSpan:5,className:"text-center",children:"No data available"})}),r.map((s,f)=>e.jsxs(x,{children:[e.jsx(a,{className:"border border-[#bfdbfe]",children:f+1}),e.jsx(a,{className:"border border-[#bfdbfe]",children:c(s.date_on_sale)}),e.jsx(a,{className:"border border-[#bfdbfe]",children:s.category}),e.jsx(a,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(a,{className:"border border-[#bfdbfe]",children:d.format(s.amount)})]},s.id))]})]}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing ",r.length===0?0:1," to ",r.length," of ",r.length," entries"]})})})]})})})}function K(){const[t,c]=n.useState([]),[d,o]=n.useState([]),[l,r]=n.useState(Array(12).fill(0)),[s,f]=n.useState(0),T=R(),_=async()=>{try{const h=await P.get("user/broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),y=h.data.salesEncoding.map(m=>({...m,amount:typeof m.amount=="number"?m.amount:parseFloat(m.amount)})),S=Array(12).fill(0);y.forEach(m=>{const j=new Date(m.date_on_sale).getMonth();S[j]+=m.amount}),r(S),c(h.data.topPerformers),o(h.data.salesEncodingTop5),f(y.reduce((m,j)=>m+j.amount,0))}catch{k.fire({icon:"error",title:"Error",text:"Failed to fetching data. Please login again.",confirmButtonText:"OK"}),localStorage.clear(),console.clear(),T("/")}};n.useEffect(()=>{_()},[]);const u=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"});return e.jsxs("div",{className:"py-5 md:pt-20",children:[e.jsx("div",{className:"flex justify-between md:flex-row",children:e.jsx("h1",{className:"text-4xl font-bold ml-72 md:ml-0 md:grid-cols-1 md:text-2xl md:gap-2 md:p-5 md:mt-0",children:"Dashboard"})}),e.jsxs("div",{className:"ml-72 md:ml-0 grid grid-cols-2 md:grid-cols-1 md:gap-4 md:p-6 md:mt-0 gap-4 items-start justify-center mt-6 md:px-6 mr-4",children:[e.jsx(H,{chartData:l,totalSales:s,currencyFormatter:u}),e.jsx(I,{topPerformers:t,currencyFormatter:u})]}),e.jsx("div",{className:"ml-72 md:ml-0 grid grid-cols-1 md:grid-cols-1 md:gap-4 md:p-6 md:mt-0 gap-4 items-start justify-center mt-6 md:px-6 mr-4",children:e.jsx(B,{sales:d,formatDateToMMDDYYYYDateApproved:A,currencyFormatter:u})})]})}export{K as default};
