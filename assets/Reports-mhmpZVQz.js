import{j as e,L as W,r as n,B as x,F as u,f as q,a9 as $,a7 as U,a8 as B,c as X}from"./index-DWF6gtdW.js";import{B as Y,a as G,b as J,c as K}from"./breadcrumb-CkJDTbRr.js";import{c as Z,C as ee,b as se}from"./card-7j1VIkA2.js";import{I as _}from"./input-i_HV8usE.js";import{L as i}from"./label-mU9QXrmq.js";import{S as L,a as H,b as P,c as T,d as t}from"./select-YhSXYTCD.js";import{f as te,a as ae,b as I,c as m,d as re,e as o}from"./table-Cwbn30Ga.js";import{D as le,a as ne,b as ie,c as ce,d as oe,g as de,e as me,f as xe}from"./dialog-DVL_bd-1.js";function he(){return e.jsx("div",{className:"bg-[#172554] flex flex-row items-center gap-4 p-2 rounded-md mb-5 ",children:e.jsx("div",{className:" flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right",children:e.jsx(Y,{children:e.jsxs(G,{children:[e.jsx(J,{className:"text-accent",children:e.jsx(W,{to:"/atHomes/broker/broker-salesReport",children:"List of Sales Report"})}),e.jsx(K,{})]})})})})}function ge({sales:a,dateFormatter:k,currencyFormatter:h}){var b;const g=n.useRef(null),[f,S]=n.useState(!1),p=()=>{if(!g.current)return;const N=g.current.innerHTML,C=`
      <style>
        body {
          font-size: 20px !important;
          font-family: Arial, sans-serif;
        }
        label, span, div {
          font-size: 40px !important;
        }
        img {
          max-width: 800px !important;
          max-height: 800px !important;
          display: block;
          margin: 16px auto;
          margin-top: 150px;
        }
      </style>
    `,r=800,y=600,w=window.screenX+(window.outerWidth-r)/2,R=window.screenY+(window.outerHeight-y)/2,l=window.open("","",`width=${r},height=${y},left=${w},top=${R}`);l&&(l.document.write("<html><head><title>Print Receipt</title>"),l.document.write(C),l.document.write("</head><body >"),l.document.write(N),l.document.write("</body></html>"),l.document.close(),l.focus(),setTimeout(()=>{l.print(),l.close()},500))};return e.jsx("div",{children:e.jsxs(le,{children:[e.jsx(ne,{children:e.jsx(x,{className:"h-8 w-8 font-medium text-sm rounded-md border border-primary",children:e.jsx(u,{icon:q})})}),e.jsxs(ie,{className:"md:max-w-[425px] h-full max-h-[700px] overflow-auto",children:[e.jsxs(ce,{children:[e.jsx(oe,{className:"text-start",children:"View Receipt"}),e.jsx(de,{children:e.jsxs("div",{ref:g,className:"grid gap-4 py-6 text-start bg-white",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols- items-center gap-4",children:[e.jsx(i,{htmlFor:"category",className:"text-gray-600 font-semibold",children:"Broker/Agent:"}),e.jsxs("span",{className:"col-span-3 text-center text-gray-800",children:[a.agent.personal_info.first_name," ",a.agent.personal_info.middle_name," ",a.agent.personal_info.last_name," ",(b=a.agent.personal_info)==null?void 0:b.extension_name]})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols- items-center gap-4",children:[e.jsx(i,{htmlFor:"category",className:"text-gray-600 font-semibold",children:"Client name:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.client_name})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"category",className:"text-gray-600 font-semibold",children:"Category:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.category})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"date",className:"text-gray-600 font-semibold",children:"Date of Sale:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:k.format(new Date(a.date_on_sale))})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"amount",className:"text-gray-600 font-semibold",children:"Amount:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:h.format(a.amount)})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"location",className:"text-gray-600 font-semibold",children:"Location:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.location})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"remarks",className:"text-gray-600 font-semibold",children:"Remarks:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.remarks})]}),e.jsx(i,{htmlFor:"remarks",className:"text-gray-600 text-start font-semibold",children:"Proof of Transaction:"}),e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:`https://athomes.site/${a.image}`,alt:a.image,className:"h-full object-cover rounded-sm",onLoad:()=>S(!0)})})]})})]}),e.jsx(me,{children:e.jsxs("div",{className:"flex flex-row justify-end gap-2",children:[e.jsx(xe,{asChild:!0,children:e.jsx(x,{className:"bg-red-500 hover:bg-red-400 h-8",children:"Cancel"})}),e.jsxs(x,{className:"h-8",onClick:p,disabled:!f,children:[e.jsx(u,{icon:$}),e.jsx("span",{children:"Print"})]})]})})]})]})})}function fe(){const[a,k]=n.useState([]),[h,g]=n.useState(""),[f,S]=n.useState(""),[p,b]=n.useState(""),[N,C]=n.useState(""),[r,y]=n.useState("all"),[w,R]=n.useState(""),[l,E]=n.useState(!1),V=async()=>{try{const s=await X.get("user/broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});k(s.data.salesEncodingReport)}catch{}};n.useEffect(()=>{V()},[]);const A=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),F=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),M=s=>{S(s.target.value)},z=s=>{g(s.target.value)},c=a.filter(s=>{var j;if(h||f){const d=new Date(s.date_on_sale);d.setHours(0,0,0,0);let D=null,v=null;if(h&&(D=new Date(h),D.setHours(0,0,0,0),d<D)||f&&(v=new Date(f),v.setHours(23,59,59,999),d>v))return!1}if(p&&s.category!==p||N&&s.remarks!==N)return!1;if(w){const d=w.toLowerCase();if(![s.client_name,s.category,s.remarks,s.location,(j=s.amount)==null?void 0:j.toString(),s.date_on_sale].filter(Boolean).some(v=>v.toLowerCase().includes(d)))return!1}return!0}),O=(r==="all"?c:c.slice(0,parseInt(r)||0)).reduce((s,j)=>{const d=parseFloat(j.amount);return s+(isNaN(d)?0:d)},0),Q=s=>{R(s.target.value)};return e.jsx("div",{children:e.jsxs(Z,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left",children:[e.jsx(ee,{children:e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 md:gap-8",children:e.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-1 gap-4 md:gap-4 w-full",children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{children:"Date Range"}),e.jsxs("div",{className:"flex gap-2 md:gap-4 md:flex-col",children:[e.jsx(_,{type:"date",className:"w-full",placeholder:"Start Date",value:h,onChange:z}),e.jsx("span",{className:"flex items-center md:hidden sm:hidden",children:"-"}),e.jsx(_,{type:"date",className:"w-full",placeholder:"End Date",value:f,onChange:M})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5 2xl:w-[310px] 2xl:ml-10 md:ml-0 xs:ml-0 xs:w-full",children:[e.jsx(i,{children:"Category"}),e.jsxs(L,{value:p,onValueChange:b,children:[e.jsx(H,{className:"xl:w-full md:w-full border border-primary",children:e.jsx(P,{placeholder:"Select category"})}),e.jsxs(T,{children:[e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{children:"Remarks"}),e.jsxs(L,{value:N,onValueChange:C,children:[e.jsx(H,{children:e.jsx(P,{placeholder:"Select remarks"})}),e.jsxs(T,{children:[e.jsx(t,{value:"Sold",children:"Sold"}),e.jsx(t,{value:"Not Sold",children:"Not Sold"}),e.jsx(t,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(t,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]})]})})}),e.jsxs(se,{children:[e.jsxs("div",{className:"flex flex-row md:grid md:grid-cols-2 justify-end items-start md:items-center gap-2 md:gap-4 pt-5",children:[e.jsxs(x,{onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),onClick:()=>{y(a.length.toString()),R(""),g(""),S(""),b(""),C("")},children:[e.jsx(u,{icon:U,className:`${l?"animate-spin":""}`}),"Refresh list"]}),e.jsxs(x,{className:"bg-red-500 text-white hover:bg-red-400 hover:text-white",children:[e.jsx(u,{icon:B}),"Export to PDF"]}),e.jsxs(x,{className:"bg-green-500 text-white hover:bg-green-400 hover:text-white",children:[e.jsx(u,{icon:B}),"Export to Excel"]}),e.jsxs(x,{children:[e.jsx(u,{icon:$}),"Print Report"]})]}),e.jsxs("div",{className:"py-2 mt-5 flex flex-row justify-between gap-4",children:[e.jsxs(L,{value:r,onValueChange:y,children:[e.jsxs(H,{className:"w-[120px] md:w-full border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(P,{placeholder:"All"})]}),e.jsxs(T,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"5",children:"5"}),e.jsx(t,{value:"10",children:"10"}),e.jsx(t,{value:"20",children:"20"}),e.jsx(t,{value:"30",children:"30"}),e.jsx(t,{value:"40",children:"40"}),e.jsx(t,{value:"50",children:"50"})]})]}),e.jsx(_,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:w,onChange:Q})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(te,{children:[e.jsx(ae,{className:"bg-primary text-base",children:e.jsxs(I,{children:[e.jsx(m,{children:"#"}),e.jsx(m,{children:"Client name"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Reservation date"}),e.jsx(m,{children:"Location"}),e.jsx(m,{children:"Amount"}),e.jsx(m,{children:"Remarks"}),e.jsx(m,{className:"text-right",children:"Action"})]})}),e.jsxs(re,{children:[(r==="all"?c:c.slice(0,parseInt(r))).length===0&&e.jsx(I,{children:e.jsx(o,{colSpan:8,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),(r==="all"?c:c.slice(0,parseInt(r))).map((s,j)=>e.jsxs(I,{children:[e.jsx(o,{className:"font-medium border border-[#bfdbfe]",children:j+1}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.category}),e.jsx(o,{className:"border border-[#bfdbfe]",children:A.format(new Date(s.date_on_sale))}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(o,{className:"border border-[#bfdbfe]",children:F.format(s.amount)}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(o,{className:"text-right border border-[#bfdbfe]",children:e.jsx(ge,{sales:s,dateFormatter:A,currencyFormatter:F})})]},s.id))]})]})}),e.jsxs("div",{className:"flex flex-row  justify-between mt-3",children:[e.jsxs("h2",{className:"text-[#172554] text-sm w-full mt-1",children:["Total Displayed Sales: ",F.format(O)]}),e.jsx("div",{children:e.jsx("p",{className:"text-[#172554] text-sm w-full",children:c.length===0?"Showing 0 entries":`Showing 1 to ${r==="all"?c.length:Math.min(parseInt(r)||0,c.length)} of ${c.length} entries`})})]})]})]})})}function Se(){return e.jsx("div",{className:"py-5 md:pt-20",children:e.jsxs("div",{className:"ml-72 md:ml-0 md:w-full gap-2 items-start justify-center mr-5 md:px-5",children:[e.jsx(he,{}),e.jsx(fe,{})]})})}export{Se as default};
