import{j as e,L as Q,r as n,B as j,F as v,f as W,a9 as q,a7 as U,a8 as B,c as X}from"./index-BwIRozVU.js";import{B as Y,a as G,b as J,c as K}from"./breadcrumb-DronD98j.js";import{c as Z,C as ee,b as se}from"./card-BulVOlky.js";import{I as _}from"./input-DYed0n_N.js";import{L as i}from"./label-C6PKk-QJ.js";import{S as L,a as H,b as P,c as T,d as t}from"./select-2ToUBg4y.js";import{f as te,a as ae,b as I,c as m,d as re,e as o}from"./table-Cnx-iMhC.js";import{D as le,a as ne,b as ie,c as ce,d as oe,g as de,e as me,f as xe}from"./dialog-Be-YFJmg.js";function he(){return e.jsx("div",{className:"bg-[#172554] flex flex-row items-center gap-4 p-2 rounded-md mb-5 ",children:e.jsx("div",{className:" flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right",children:e.jsx(Y,{children:e.jsxs(G,{children:[e.jsx(J,{className:"text-accent",children:e.jsx(Q,{to:"/agent-broker/agent-salesReport",children:"List of Sales Report"})}),e.jsx(K,{})]})})})})}function ge({sales:a,dateFormatter:F,currencyFormatter:x}){var p;const h=n.useRef(null),[g,S]=n.useState(!1),u=()=>{if(!h.current)return;const b=h.current.innerHTML,C=`
      <style>
        body {
          font-size: 20px !important;
          font-family: Arial, sans-serif;
        }
        label, span, div {
          font-size: 40px !important;
        }
        img {
          max-width: 800px !important;
          max-height: 800px !important;
          display: block;
          margin: 16px auto;
          margin-top: 150px;
        }
      </style>
    `,r=800,N=600,y=window.screenX+(window.outerWidth-r)/2,R=window.screenY+(window.outerHeight-N)/2,l=window.open("","",`width=${r},height=${N},left=${y},top=${R}`);l&&(l.document.write("<html><head><title>Print Receipt</title>"),l.document.write(C),l.document.write("</head><body >"),l.document.write(b),l.document.write("</body></html>"),l.document.close(),l.focus(),setTimeout(()=>{l.print(),l.close()},500))};return e.jsx("div",{children:e.jsxs(le,{children:[e.jsx(ne,{children:e.jsx(j,{className:"h-8 w-8 font-medium text-sm rounded-md border border-primary",children:e.jsx(v,{icon:W})})}),e.jsxs(ie,{className:"md:max-w-[425px] h-full max-h-[700px] overflow-auto",children:[e.jsxs(ce,{children:[e.jsx(oe,{className:"text-start",children:"View Receipt"}),e.jsx(de,{children:e.jsxs("div",{ref:h,className:"grid gap-4 py-6 text-start bg-white",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols- items-center gap-4",children:[e.jsx(i,{htmlFor:"category",className:"text-gray-600 font-semibold",children:"Broker/Agent:"}),e.jsxs("span",{className:"col-span-3 text-center text-gray-800",children:[a.agent.personal_info.first_name," ",a.agent.personal_info.middle_name," ",a.agent.personal_info.last_name," ",(p=a.agent.personal_info)==null?void 0:p.extension_name]})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols- items-center gap-4",children:[e.jsx(i,{htmlFor:"category",className:"text-gray-600 font-semibold",children:"Client name:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.client_name})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"category",className:"text-gray-600 font-semibold",children:"Category:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.category})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"date",className:"text-gray-600 font-semibold",children:"Date of Sale:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:F.format(new Date(a.date_on_sale))})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"amount",className:"text-gray-600 font-semibold",children:"Amount:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:x.format(a.amount)})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"location",className:"text-gray-600 font-semibold",children:"Location:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.location})]}),e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 items-center gap-4",children:[e.jsx(i,{htmlFor:"remarks",className:"text-gray-600 font-semibold",children:"Remarks:"}),e.jsx("span",{className:"col-span-3 text-center text-gray-800",children:a.remarks})]}),e.jsx(i,{htmlFor:"remarks",className:"text-gray-600 text-start font-semibold",children:"Proof of Transaction:"}),e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:`https://athomes.site/${a.image}`,alt:a.image,className:"h-full object-cover rounded-sm",onLoad:()=>S(!0)})})]})})]}),e.jsx(me,{children:e.jsxs("div",{className:"flex flex-row justify-end gap-2",children:[e.jsx(xe,{asChild:!0,children:e.jsx(j,{className:"bg-red-500 hover:bg-red-400 h-8",children:"Cancel"})}),e.jsxs(j,{className:"h-8",onClick:u,disabled:!g,children:[e.jsx(v,{icon:q}),e.jsx("span",{children:"Print"})]})]})})]})]})})}function fe(){const[a,F]=n.useState([]),[x,h]=n.useState(""),[g,S]=n.useState(""),[u,p]=n.useState(""),[b,C]=n.useState(""),[r,N]=n.useState("all"),[y,R]=n.useState(""),[l,E]=n.useState(!1),$=async()=>{try{const s=await X.get("user/agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});F(s.data.salesEncodingReport)}catch{}};n.useEffect(()=>{$()},[]);const A=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),k=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),V=s=>{S(s.target.value)},M=s=>{h(s.target.value)},c=a.filter(s=>{var f;if(x||g){const d=new Date(s.date_on_sale);d.setHours(0,0,0,0);let D=null,w=null;if(x&&(D=new Date(x),D.setHours(0,0,0,0),d<D)||g&&(w=new Date(g),w.setHours(23,59,59,999),d>w))return!1}if(u&&s.category!==u||b&&s.remarks!==b)return!1;if(y){const d=y.toLowerCase();if(![s.client_name,s.category,s.remarks,s.location,(f=s.amount)==null?void 0:f.toString(),s.date_on_sale].filter(Boolean).some(w=>w.toLowerCase().includes(d)))return!1}return!0}),z=(r==="all"?c:c.slice(0,parseInt(r)||0)).reduce((s,f)=>{const d=parseFloat(f.amount);return s+(isNaN(d)?0:d)},0),O=s=>{R(s.target.value)};return e.jsx("div",{children:e.jsxs(Z,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left",children:[e.jsx(ee,{children:e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 md:gap-8",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-4 md:gap-4 w-full",children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{children:"Date Range"}),e.jsxs("div",{className:"flex gap-2 md:gap-4 md:flex-col",children:[e.jsx(_,{type:"date",className:"w-full",placeholder:"Start Date",value:x,onChange:M}),e.jsx("span",{className:"flex items-center md:hidden sm:hidden",children:"-"}),e.jsx(_,{type:"date",className:"w-full",placeholder:"End Date",value:g,onChange:V})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{children:"Category"}),e.jsxs(L,{value:u,onValueChange:p,children:[e.jsx(H,{className:"xl:w-full md:w-full border border-primary",children:e.jsx(P,{placeholder:"Select category"})}),e.jsxs(T,{children:[e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{children:"Remarks"}),e.jsxs(L,{value:b,onValueChange:C,children:[e.jsx(H,{children:e.jsx(P,{placeholder:"Select remarks"})}),e.jsxs(T,{children:[e.jsx(t,{value:"Sold",children:"Sold"}),e.jsx(t,{value:"Not Sold",children:"Not Sold"}),e.jsx(t,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(t,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]})]})})}),e.jsxs(se,{children:[e.jsxs("div",{className:"flex flex-row md:grid md:grid-cols-2 justify-end items-start md:items-center gap-2 md:gap-4 pt-5",children:[e.jsxs(j,{onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),onClick:()=>{N(a.length.toString()),R(""),h(""),S(""),p(""),C("")},children:[e.jsx(v,{icon:U,className:`${l?"animate-spin":""}`}),"Refresh list"]}),e.jsxs(j,{className:"bg-red-500 text-white hover:bg-red-400 hover:text-white",children:[e.jsx(v,{icon:B}),"Export to PDF"]}),e.jsxs(j,{className:"bg-green-500 text-white hover:bg-green-400 hover:text-white",children:[e.jsx(v,{icon:B}),"Export to Excel"]})]}),e.jsxs("div",{className:"py-2 mt-5 flex flex-row justify-between gap-4",children:[e.jsxs(L,{value:r,onValueChange:N,children:[e.jsxs(H,{className:"w-[120px] border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(P,{placeholder:"All"})]}),e.jsxs(T,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"5",children:"5"}),e.jsx(t,{value:"10",children:"10"}),e.jsx(t,{value:"20",children:"20"}),e.jsx(t,{value:"30",children:"30"}),e.jsx(t,{value:"40",children:"40"}),e.jsx(t,{value:"50",children:"50"})]})]}),e.jsx(_,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:y,onChange:O})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(te,{children:[e.jsx(ae,{className:"bg-primary text-base",children:e.jsxs(I,{children:[e.jsx(m,{children:"#"}),e.jsx(m,{children:"Client name"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Reservation date"}),e.jsx(m,{children:"Location"}),e.jsx(m,{children:"Amount"}),e.jsx(m,{children:"Remarks"}),e.jsx(m,{className:"text-right",children:"Action"})]})}),e.jsxs(re,{children:[(r==="all"?c:c.slice(0,parseInt(r))).length===0&&e.jsx(I,{children:e.jsx(o,{colSpan:8,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),(r==="all"?c:c.slice(0,parseInt(r))).map((s,f)=>e.jsxs(I,{children:[e.jsx(o,{className:"font-medium border border-[#bfdbfe]",children:f+1}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.category}),e.jsx(o,{className:"border border-[#bfdbfe]",children:A.format(new Date(s.date_on_sale))}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(o,{className:"border border-[#bfdbfe]",children:k.format(s.amount)}),e.jsx(o,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(o,{className:"text-right border border-[#bfdbfe]",children:e.jsx(ge,{sales:s,dateFormatter:A,currencyFormatter:k})})]},s.id))]})]})}),e.jsxs("div",{className:"flex flex-row  justify-between mt-3",children:[e.jsxs("h2",{className:"text-[#172554] text-sm w-full mt-1",children:["Total Displayed Sales: ",k.format(z)]}),e.jsx("div",{children:e.jsx("p",{className:"text-[#172554] text-sm w-full",children:c.length===0?"Showing 0 entries":`Showing 1 to ${r==="all"?c.length:Math.min(parseInt(r)||0,c.length)} of ${c.length} entries`})})]})]})]})})}function Se(){return e.jsx("div",{className:"py-5 md:pt-20",children:e.jsxs("div",{className:"ml-72 md:ml-0 md:w-full gap-2 items-start justify-center mr-5 md:px-5",children:[e.jsx(he,{}),e.jsx(fe,{})]})})}export{Se as default};
