import{j as e,B as C,F as c,a as M,X as A,aa as q,r as _,a3 as O,ac as z,ad as Q,g as G,d as F,S as E}from"./index-Dk1_FMbU.js";import{S as L,a as U,b as Y,c as k,d as b}from"./select-mnZuAGIz.js";import{I as D}from"./input-lhyLM1nK.js";import{D as P,a as R,b as $,c as I,d as V,g as H,f as X,e as J,T as K,h as W,i as S,j as N,k as Z,l as h}from"./dialog-CJKaJoWJ.js";import{a as ee,f as re}from"./dateUtils-D6w6W0GJ.js";import{L as w}from"./label-BBsw-Xlw.js";function se({unlicensed:r}){var f,a,g,l,p,x;const i=o=>o===0?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-green-100 text-green-700 text-xs font-semibold",children:"Approved"}):o===1?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 text-xs font-semibold",children:"Pending"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:"Declined"}),n=o=>o===1?e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-semibold text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Agent"}):o===2?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-semibold text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Broker"}):e.jsx("span",{className:"inline-flex items-center rounded-md bg-gray-100 px-2 py-1 text-xs font-semibold text-gray-600 ring-1 ring-gray-400/20 ring-inset",children:"N/A"});return e.jsxs(P,{children:[e.jsx(R,{children:e.jsx(C,{className:"w-8 h-8 rounded-md bg-gradient-to-br from-blue-500 to-blue-700 shadow hover:from-blue-600 hover:to-blue-800 transition-all duration-200",children:e.jsx(c,{icon:M,className:"text-white"})})}),e.jsx($,{className:"md:max-w-[420px] rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(I,{children:[e.jsxs(V,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(c,{icon:A,className:"text-blue-500"}),"Agent & Broker Details"]}),e.jsx(H,{children:e.jsxs("div",{className:"flex flex-col gap-6 mt-6 mb-4",children:[e.jsxs("div",{className:"border-b pb-4 mb-2 text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(c,{icon:q,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Personal Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Name:"})," ",(f=r==null?void 0:r.personal_info)==null?void 0:f.first_name," ",(a=r==null?void 0:r.personal_info)==null?void 0:a.middle_name," ",(g=r==null?void 0:r.personal_info)==null?void 0:g.last_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",(l=r==null?void 0:r.user)==null?void 0:l.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Username:"})," ",(p=r==null?void 0:r.user)==null?void 0:p.username]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Phone:"})," ",(x=r==null?void 0:r.personal_info)==null?void 0:x.phone]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Gender:"})," ",r.personal_info.gender.charAt(0).toUpperCase()+r.personal_info.gender.slice(1)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Complete Address:"})," ",r.personal_info.complete_address]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Status:"}),i(r.user.status)]})]})]}),e.jsxs("div",{className:"text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(c,{icon:A,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Identity Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"PRC License Number:"})," ",(r==null?void 0:r.prc_liscence_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"DHSUD Reg. #:"})," ",(r==null?void 0:r.dhsud_registration_number)||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Type:"})," ",n(r==null?void 0:r.user.role)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Validity Date:"})," ",ee((r==null?void 0:r.validation_date)||"N/A")]})]})]})]})}),e.jsx(X,{asChild:!0,children:e.jsx(C,{className:"bg-red-500 hover:bg-red-400 rounded-lg shadow",children:"Close"})})]})})]})}function ae(r){if(!r)return"";if(r.includes("-")){const i=r.split("-");return i[0].length===4?r:`${i[2]}-${i[1]}-${i[0]}`}return r}function te({unlicensed:r,agentUnliscenced:i}){var s,v,j,m;const[n,f]=_.useState(!1),[a,g]=_.useState({prc_liscence_number:"",dhsud_registration_number:"",validation_date:r.validation_date?ae(r.validation_date):"",role:((v=(s=r.user)==null?void 0:s.role)==null?void 0:v.toString())||"1"}),[l,p]=_.useState({prc_liscence_number:"",dhsud_registration_number:"",validation_date:""}),x=t=>{const{name:d,value:u}=t.target;g({...a,[d]:u}),p({...l,[d]:""})},o=()=>{const t={prc_liscence_number:a.prc_liscence_number?"":"PRC License Number is required.",dhsud_registration_number:a.dhsud_registration_number?"":"DHSUD Registration Number is required.",validation_date:a.validation_date?"":"Validity Date is required."};return p(t),Object.values(t).every(d=>d==="")},y=async()=>{if(o()&&!n){f(!0);try{const t=await F.put(`editLicense/${r.id}`,a,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});i(),E.fire({icon:"success",title:"Success",text:t.data.message,showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(t){console.error("Error updating license:",t),E.fire({icon:"error",title:"Error",text:"Failed to update license. Please try again.",showConfirmButton:!0})}finally{f(!1)}}};return e.jsxs(P,{children:[e.jsx(R,{children:e.jsx(C,{className:"w-8 h-8 rounded-md bg-gradient-to-r from-green-400 to-green-600 shadow hover:from-green-500 hover:to-green-700 transition-all duration-200",children:e.jsx(c,{icon:O,className:"text-white"})})}),e.jsxs($,{className:"md:max-w-[420px] rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(I,{children:[e.jsxs(V,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(c,{icon:A,className:"text-blue-500"}),"Update License"]}),e.jsx(H,{children:e.jsxs("div",{className:"flex flex-col gap-6 mt-6 mb-4",children:[e.jsxs("div",{className:"border-b pb-4 mb-2 text-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(c,{icon:z,className:"text-blue-400"}),e.jsx("h2",{className:"text-lg font-bold text-blue-800",children:"Personal Details"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-1 text-sm text-gray-700",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Full Name:"})," ",`${(j=r==null?void 0:r.personal_info)==null?void 0:j.first_name} ${r.personal_info.middle_name} ${(m=r==null?void 0:r.personal_info)==null?void 0:m.last_name}`]})})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"prc_liscence_number",className:"font-semibold text-blue-900 text-start",children:"PRC License Number"}),e.jsx(D,{name:"prc_liscence_number",placeholder:"Enter PRC License No:",value:a.prc_liscence_number,onChange:x,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),l.prc_liscence_number&&e.jsx("span",{className:"text-red-500 text-xs",children:l.prc_liscence_number})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"dhsud_registration_number",className:"font-semibold text-blue-900 text-start",children:"DHSUD Registration Number"}),e.jsx(D,{name:"dhsud_registration_number",placeholder:"Enter DHSUD Registration No:",value:a.dhsud_registration_number,onChange:x,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),l.dhsud_registration_number&&e.jsx("span",{className:"text-red-500 text-xs",children:l.dhsud_registration_number})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"validation_date",className:"font-semibold text-blue-900 text-start",children:"Validity Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{type:"date",name:"validation_date",value:a.validation_date,onChange:x,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 pr-10"}),e.jsx(c,{icon:Q,className:"absolute right-3 top-1/2 -translate-y-1/2 text-blue-400 pointer-events-none"})]}),l.validation_date&&e.jsx("span",{className:"text-red-500 text-xs",children:l.validation_date})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(w,{htmlFor:"type",className:"font-semibold text-blue-900 text-start",children:"Type"}),e.jsxs(L,{name:"role",defaultValue:a.role,onValueChange:t=>g({...a,role:t}),children:[e.jsx(U,{className:"h-9 bg-white rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:e.jsx(Y,{placeholder:"Select Agent or Broker"})}),e.jsxs(k,{children:[e.jsx(b,{value:"1",children:"Agent"}),e.jsx(b,{value:"2",children:"Broker"})]})]})]})]})})]}),e.jsx(J,{children:e.jsx(C,{className:"bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center gap-2",type:"button",onClick:y,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 cursor-not-allowed border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{icon:G}),e.jsx("span",{children:"Save changes"})]})})})]})]})}function xe(){const[r,i]=_.useState([]),[n,f]=_.useState("all"),[a,g]=_.useState(""),l=async()=>{try{const s=await F.get("agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});i(s.data.unlicensed)}catch(s){console.error("Error fetching members:",s)}};_.useEffect(()=>{l()},[]);const p=s=>{f(s==="all"?"all":parseInt(s))},x=s=>{g(s.target.value)},o=r.filter(s=>{var m,t,d,u;const v=`${(m=s==null?void 0:s.personal_info)==null?void 0:m.first_name} ${(t=s==null?void 0:s.personal_info)==null?void 0:t.last_name}`.toLowerCase(),j=((d=s==null?void 0:s.user)==null?void 0:d.role)===1?"agent":((u=s==null?void 0:s.user)==null?void 0:u.role)===2?"broker":"";return v.includes(a.toLowerCase())||j.includes(a.toLowerCase())}),y=n==="all"?o:o.slice(0,n);return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(L,{onValueChange:p,children:[e.jsxs(U,{className:"w-[120px] border border-primary md:w-28",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(Y,{placeholder:"All"})," "]}),e.jsxs(k,{children:[e.jsx(b,{value:"all",children:"All"}),e.jsx(b,{value:"10",children:"10"}),e.jsx(b,{value:"20",children:"20"}),e.jsx(b,{value:"30",children:"30"}),e.jsx(b,{value:"40",children:"40"}),e.jsx(b,{value:"50",children:"50"})]})]}),e.jsx(D,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:a,onChange:x})]}),e.jsx("div",{className:"fade-in-left",children:e.jsxs(K,{children:[e.jsx(W,{className:"bg-primary",children:e.jsxs(S,{children:[e.jsx(N,{children:"#"}),e.jsx(N,{children:"Fullname"}),e.jsx(N,{children:"Type"}),e.jsx(N,{children:"Email address"}),e.jsx(N,{children:"Contact number"}),e.jsx(N,{children:"Date Approved"}),e.jsx(N,{className:"text-right",children:"Action"})]})}),e.jsx(Z,{children:y.length>0?y.map((s,v)=>{var j,m,t,d,u,T,B;return e.jsxs(S,{children:[e.jsx(h,{className:"font-medium border border-[#bfdbfe]",children:v+1}),e.jsxs(h,{className:"font-medium border border-[#bfdbfe] uppercase",children:[(j=s==null?void 0:s.personal_info)==null?void 0:j.first_name," ",s.personal_info.middle_name," ",(m=s==null?void 0:s.personal_info)==null?void 0:m.last_name]}),e.jsx(h,{className:"border border-[#bfdbfe]",children:((t=s==null?void 0:s.user)==null?void 0:t.role)===1?e.jsx("span",{className:"inline-flex unlicenseds-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Agent"}):((d=s==null?void 0:s.user)==null?void 0:d.role)===2?e.jsx("span",{className:"inline-flex unlicenseds-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Broker"}):(u=s==null?void 0:s.user)==null?void 0:u.role}),e.jsx(h,{className:"border border-[#bfdbfe]",children:(T=s==null?void 0:s.user)==null?void 0:T.email}),e.jsx(h,{className:"border border-[#bfdbfe]",children:(B=s==null?void 0:s.personal_info)==null?void 0:B.phone}),e.jsx(h,{className:"border border-[#bfdbfe]",children:re(s==null?void 0:s.user.updated_at)}),e.jsx(h,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(se,{unlicensed:s}),e.jsx(te,{unlicensed:s,agentUnliscenced:l})]})})]},s.id)}):e.jsx(S,{children:e.jsx(h,{colSpan:7,className:"text-center border border-[#bfdbfe]",children:"No data available"})})})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",n==="all"?o.length:n," of ",o.length," entries"]})})})]})}export{xe as default};
