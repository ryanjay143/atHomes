import{r as o,j as e,M as P,N as S,O as I,B as k,S as y,c as N}from"./index-BxklM6mb.js";import{c as A}from"./card-CS4E6y1P.js";import{I as r}from"./input-irYHj0Q9.js";const v=5,B=v*1024*1024,M=["image/jpeg","image/png","image/jpg","image/webp"],L=()=>{const[x,f]=o.useState(!1),c=o.useRef(null),[g,h]=o.useState(null),[p,b]=o.useState(null),[n,j]=o.useState({username:"",email:"",password:"",password_confirmation:""}),[d,_]=o.useState("account"),[s,m]=o.useState({first_name:"",middle_name:"",last_name:"",extension_name:"",complete_address:"",phone:"",profile_pic:""}),l=i=>{const{name:a,value:t}=i.target;d==="account"?j({...n,[a]:t}):m({...s,[a]:t})},C=i=>{var t;const a=(t=i.target.files)==null?void 0:t[0];if(b(null),a){if(!M.includes(a.type)){b("Only image files (jpeg, jpg, png, webp) are allowed."),h(null),m({...s,profile_pic:""}),c.current&&(c.current.value="");return}if(a.size>B){b(`Image size must be less than ${v}MB.`),h(null),m({...s,profile_pic:""}),c.current&&(c.current.value="");return}const u=URL.createObjectURL(a);h(u),m({...s,profile_pic:a})}},E=async i=>{if(i.preventDefault(),x)return;if(f(!0),p){f(!1),y.fire({title:"Error",text:p,icon:"error",showConfirmButton:!0});return}const a=new FormData;a.append("username",n.username),a.append("email",n.email),a.append("first_name",s.first_name),a.append("middle_name",s.middle_name),a.append("last_name",s.last_name),a.append("extension_name",s.extension_name||""),a.append("phone",s.phone),a.append("complete_address",s.complete_address),n.password&&(a.append("password",n.password),a.append("password_confirmation",n.password_confirmation));const t=document.querySelector('input[type="file"]');t&&t.files&&t.files[0]&&a.append("profile_pic",t.files[0]);try{const u=await N.post("admin/edit-profile",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});y.fire({title:"Success",text:u.data.message,icon:"success",showConfirmButton:!1,showCloseButton:!0,timer:3e3,timerProgressBar:!0}).then(()=>{c.current&&(c.current.value="")}),w()}catch{}finally{f(!1)}},w=async()=>{try{const i=await N.get("agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),a=i.data.personalInfo;m({first_name:a.first_name??"",middle_name:a.middle_name??"",last_name:a.last_name??"",extension_name:a.extension_name??"",complete_address:a.complete_address??"",phone:a.phone??"",profile_pic:a.profile_pic??""}),j(i.data.user)}catch{}};return o.useEffect(()=>{w()},[]),e.jsx("div",{className:"flex justify-center items-start mt-10 md:min-h-screen md:items-center md:mt-0",children:e.jsxs(A,{className:"max-w-xl w-full bg-white shadow-md rounded-lg p-6 md:w-[90%]",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Edit Profile"}),e.jsxs("div",{className:"flex mb-4",children:[e.jsx("button",{className:`flex-1 py-2 ${d==="account"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>_("account"),children:"User Account"}),e.jsx("button",{className:`flex-1 py-2 ${d==="personal"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>_("personal"),children:"Personal Info"})]}),e.jsxs("form",{onSubmit:E,children:[d==="account"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Username"}),e.jsx(r,{type:"text",name:"username",value:n.username,onChange:l,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Email"}),e.jsx(r,{type:"email",name:"email",value:n.email,onChange:l,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Change password"}),e.jsx(r,{type:"password",name:"password",value:n.password,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Password confirmation"}),e.jsx(r,{type:"password",name:"password_confirmation",value:n.password_confirmation,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]})]}),d==="personal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-2 md:gap-2 gap-4 mt-10",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Firstname"}),e.jsx(r,{type:"text",name:"first_name",value:s.first_name,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Middlename"}),e.jsx(r,{type:"text",name:"middle_name",value:s.middle_name,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Lastname"}),e.jsx(r,{type:"text",name:"last_name",value:s.last_name,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Extension"}),e.jsx(r,{type:"text",name:"extension_name",value:s.extension_name,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Address"}),e.jsx(r,{type:"text",name:"complete_address",value:s.complete_address,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700",children:"Phone"}),e.jsx(r,{type:"text",name:"phone",value:s.phone,onChange:l,className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsxs(P,{className:"h-32 w-32 md:h-12 md:w-12 border-primary border-4",children:[g||s.profile_pic?e.jsx(S,{src:g||(typeof s.profile_pic=="string"?`https://athomes.site/${s.profile_pic}`:void 0),alt:"Profile",className:"rounded-full border border-border object-cover"}):null,e.jsx(I,{className:"font-bold text-2xl bg-[#172554] text-[#eff6ff] ",children:s.first_name?s.first_name.charAt(0).toUpperCase():"U"})]})}),e.jsx("p",{className:"text-sm text-red-600",children:"Profile Picture (JPEG, PNG, WEBP, Max 5MB)"}),e.jsx(r,{type:"file",name:"profile_pic",accept:"image/jpeg,image/png,image/jpg,image/webp",className:"w-full px-3 py-2 border rounded-lg",onChange:C,ref:c}),p&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:p})]})})]}),e.jsx(k,{type:"submit",className:"w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin cursor-not-allowed border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save changes"})})})]})]})})};export{L as default};
