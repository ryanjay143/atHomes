import{j as e,L as be,r,B as R,F as n,a as je,af as O,ab as J,ae as Z,ah as ne,a4 as ee,ai as pe,aj as Ne,a1 as oe,$ as ve,ag as ie,g as ce,d as se,S as Y,a3 as ye}from"./index-BqgKW3tX.js";import{c as we,C as Se,b as Ce}from"./card-DMwL5mhC.js";import{I as w}from"./input-BPORAoyB.js";import{S as G,a as H,b as z,c as V,d as t}from"./select-yW0ppv6d.js";import{D as U,a as de,b as Q,c as ae,d as te,g as le,e as W,f as _e,T as Pe,h as ke,i as X,j as A,k as De,l as _}from"./dialog-bG-Ik3It.js";import{L as c}from"./label-L0oGHOiY.js";import{B as Fe,a as Le,b as Ee,c as Ae}from"./breadcrumb-CMARPdCn.js";import{N as me}from"./react-number-format.es-Bh2RKreN.js";function Re(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Fe,{children:e.jsxs(Le,{children:[e.jsx(Ee,{className:"text-accent",children:e.jsx(be,{to:"/agent-broker/agent-salesEncoding",children:"List of Sales Encoding"})}),e.jsx(Ae,{})]})})})})}function Te({sales:l,dateFormatter:h,currencyFormatter:o}){var S;const x=r.useRef(null),[m,u]=r.useState(!1);return e.jsx("div",{children:e.jsxs(U,{children:[e.jsx(de,{children:e.jsx(R,{className:"h-8 w-8 font-medium text-sm rounded-md border border-primary bg-gradient-to-br from-blue-500 to-blue-700 text-white shadow hover:from-blue-600 hover:to-blue-800 transition-all duration-200",children:e.jsx(n,{icon:je})})}),e.jsxs(Q,{className:"md:w-[95%] max-w-2xl h-full overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(ae,{children:[e.jsxs(te,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-500"}),"View Receipt"]}),e.jsx(le,{children:e.jsxs("div",{ref:x,className:"grid gap-6 py-6 text-start bg-white rounded-xl shadow-inner px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:J,className:"text-blue-400 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Broker/Agent:"}),e.jsxs("span",{className:"ml-2 text-base text-gray-800 font-medium",children:[l.agent.personal_info.first_name," ",l.agent.personal_info.middle_name," ",l.agent.personal_info.last_name," ",(S=l.agent.personal_info)==null?void 0:S.extension_name]})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:J,className:"text-blue-400 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Client Name:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.client_name})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:O,className:"text-blue-400 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Category:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.category})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:Z,className:"text-blue-400 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Date of Sale:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:h.format(new Date(l.date_on_sale))})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:ne,className:"text-green-500 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Amount:"}),e.jsx("span",{className:"ml-2 text-base text-green-700 font-bold",children:o.format(l.amount)})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:ee,className:"text-red-400 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Location:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.location})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:pe,className:"text-indigo-400 text-lg"}),e.jsx(c,{className:"text-gray-600 font-semibold",children:"Remarks:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.remarks})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs(c,{className:"text-gray-600 font-semibold flex items-center gap-2",children:[e.jsx(n,{icon:Ne,className:"text-pink-400 text-lg"}),"Proof of Transaction:"]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:`https://athomes.site/${l.image}`,alt:l.image,className:"object-cover rounded-lg border-2 border-blue-200 shadow-md max-w-xs max-h-60 cursor-pointer transition-transform duration-200 hover:scale-105 hover:ring-2 hover:ring-primary",onClick:()=>u(!0),title:"Click to preview"})}),e.jsx(U,{open:m,onOpenChange:u,children:e.jsxs(Q,{className:"md:max-w-[80vw] flex flex-col items-center bg-white rounded-xl shadow-2xl",children:[e.jsx("img",{src:`https://athomes.site/${l.image}`,alt:l.image,className:"max-w-[80vw] max-h-[80vh] rounded shadow-lg"}),e.jsx(W,{children:e.jsxs(R,{className:"mt-4 bg-red-500 hover:bg-red-400 text-white",onClick:()=>u(!1),children:[e.jsx(n,{icon:oe,className:"mr-1"}),"Close"]})})]})})]})]})})]}),e.jsx(W,{children:e.jsx("div",{className:"flex flex-row justify-end gap-2",children:e.jsx(_e,{asChild:!0,children:e.jsx(R,{className:"bg-red-500 hover:bg-red-400 h-8 rounded shadow",children:"Close"})})})})]})]})})}function Be({fetchAgent:l,identityDetails:h}){const[o,x]=r.useState({agent_id:h.id,category:"",date_on_sale:new Date().toISOString().split("T")[0],amount:"",location:"",remarks:"",image:null,client_name:""}),[m,u]=r.useState({}),[S,P]=r.useState(!1),[j,T]=r.useState(!1),[b,k]=r.useState(""),[D,B]=r.useState(null),[C,v]=r.useState(null);r.useEffect(()=>{x(a=>({...a,agent_id:h.id}))},[h]);const F=()=>{const a={};return o.agent_id||(a.agent_id="Agent/Broker is required."),o.category||(a.category="Category is required."),o.date_on_sale||(a.date_on_sale="Date of Sale is required."),o.amount||(a.amount="Amount of Sale is required."),o.location||(a.location="Location of Property is required."),o.remarks||(a.remarks="Remarks are required."),o.image||(a.image="Proof of Transaction is required."),o.client_name||(a.client_name="Client name is required."),u(a),Object.keys(a).length===0},I=async a=>{if(a.preventDefault(),!F()||j)return;T(!0);const i=new FormData;Object.entries(o).forEach(([p,N])=>{i.append(p,N)});try{await se.post("user/broker-sales",i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),l(),x({agent_id:h.id,category:"",date_on_sale:new Date().toISOString().split("T")[0],amount:"",location:"",remarks:"",image:null,client_name:""}),k(""),P(!1),B(null),Y.fire({icon:"success",title:"Success",text:"Sales created successfully.",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch{Y.fire({icon:"error",title:"Failed to create sales encoding",text:"There was an error while saving your sales encoding. Please try again.",confirmButtonText:"Retry"})}finally{T(!1)}},L=(a,i)=>{x({...o,[a]:i})},y=a=>{const{name:i,value:p}=a.target;x({...o,[i]:p})},E=a=>{const i=a.target.value;x({...o,date_on_sale:i})},s=a=>{const{value:i}=a;k(i),x({...o,amount:i}),u(i===""?{amount:"Amount is required"}:{})},f=a=>{var p;const i=((p=a.target.files)==null?void 0:p[0])||null;if(i&&(["image/jpeg","image/png","image/jpg"].includes(i.type)?i.size>5242880?(v("File size exceeds the maximum limit of 5MB."),x({...o,image:null})):(v(null),x({...o,image:i})):(v("Invalid file type. Only JPEG, PNG, and JPG are allowed."),x({...o,image:null}))),i){const N=new FileReader;N.onloadend=()=>{B(N.result)},N.onerror=()=>{v("Failed to read file")},N.readAsDataURL(i)}};return e.jsx("div",{children:e.jsxs(U,{open:S,onOpenChange:P,children:[e.jsx(de,{asChild:!0,children:e.jsxs(R,{className:"h-10 bg-gradient-to-r from-blue-500 to-blue-700 text-white shadow-md hover:from-blue-600 hover:to-blue-800 transition-all duration-200 rounded-lg",children:[e.jsx(n,{icon:ve,className:"mr-2"}),"Add Sales"]})}),e.jsx(Q,{className:"md:w-[95%] h-full max-w-lg overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(ae,{children:[e.jsxs(te,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-500"}),"Add Sales Encoding"]}),e.jsx(le,{children:e.jsx("form",{onSubmit:I,children:e.jsxs("div",{className:"text-start grid grid-cols-1 md:grid-cols-1 gap-5 mt-5",children:[e.jsxs("div",{children:[e.jsx(c,{className:"font-semibold text-blue-900",children:"Category"}),e.jsxs(G,{onValueChange:a=>L("category",a),children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(V,{children:[e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(t,{value:"Block and lot",children:"Block and lot"})]})]}),m.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.category})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:J,className:"text-blue-400"}),"Client Name"]}),e.jsx(w,{type:"text",name:"client_name",placeholder:"Enter client name",value:o.client_name,onChange:y,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),m.client_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.client_name})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:Z,className:"text-blue-400"}),"Reservation Date"]}),e.jsx(w,{type:"date",name:"date_on_sale",value:o.date_on_sale,onChange:E,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),m.date_on_sale&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.date_on_sale})]}),e.jsxs("div",{children:[e.jsx(c,{className:"font-semibold text-blue-900",children:"Amount of Sale"}),e.jsx(me,{value:b,thousandSeparator:!0,decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,placeholder:"0.00",onValueChange:s,className:"flex h-9 w-full rounded-lg border border-blue-300 bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"}),m.amount&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.amount})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ee,className:"text-blue-400"}),"Location of Property"]}),e.jsx(w,{type:"text",name:"location",placeholder:"Enter location of property",onChange:y,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),m.location&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.location})]}),e.jsxs("div",{children:[e.jsx(c,{className:"font-semibold text-blue-900",children:"Remarks"}),e.jsxs(G,{onValueChange:a=>L("remarks",a),children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select remarks"})}),e.jsxs(V,{children:[e.jsx(t,{value:"Sold",children:"Sold"}),e.jsx(t,{value:"Not Sold",children:"Not Sold"}),e.jsx(t,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(t,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),m.remarks&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.remarks})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ie,className:"text-blue-400"}),"Upload Proof of Transaction",e.jsx("span",{className:"text-xs text-red-500 ml-2",children:"(JPEG, PNG, JPG only, max 5MB)"})]}),e.jsx(w,{type:"file",name:"image",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:f,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),C&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:C}),m.image&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.image}),D&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("img",{src:D,alt:"Preview",className:"max-w-xs rounded-lg border border-blue-200 shadow"})})]}),e.jsx(W,{className:"mt-4",children:e.jsx(R,{type:"submit",disabled:j,className:"w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white rounded-lg shadow hover:from-blue-700 hover:to-blue-900 flex items-center justify-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:ce}),e.jsx("span",{children:"Submit"})]})})})]})})})]})})]})})}const Ie=({sales:l,open:h,onOpenChange:o,fetchAgent:x,identityDetails:m})=>{var re;const u=`https://athomes.site/${l.image}`,[S,P]=r.useState(l.category||""),[j,T]=r.useState(((re=l.date_on_sale)==null?void 0:re.split("T")[0])||""),[b,k]=r.useState(l.amount.toString()||""),[D,B]=r.useState(l.location||""),[C,v]=r.useState(u),[F,I]=r.useState(l.remarks||""),[L,y]=r.useState(l.client_name||""),[E,s]=r.useState(!1),[f,a]=r.useState(null),[i,p]=r.useState(null),N=r.useRef(null),[K,$]=r.useState(null);r.useEffect(()=>{var g;h&&(P(l.category||""),T(((g=l.date_on_sale)==null?void 0:g.split("T")[0])||""),k(l.amount.toString()||""),B(l.location||""),I(l.remarks||""),y(l.client_name||""),v(u),a(null),p(null),$(null))},[h,l]);const xe=g=>{var M;const d=(M=g.target.files)==null?void 0:M[0];if(d){const fe=["image/jpeg","image/png","image/jpg"];if(!d.type.startsWith("image/")||!fe.includes(d.type)){$("Please select a valid image file (JPEG, PNG, or JPG).");return}if(d.size>5242880){$("The selected file exceeds the maximum size of 5MB.");return}$(null);const q=new FileReader;q.onloadend=()=>{typeof q.result=="string"&&(v(q.result),p(d))},q.readAsDataURL(d)}else $("Please select a valid image file.")},ue=()=>{v(u),N.current&&(N.current.value=""),p(null)},ge=async g=>{if(g.preventDefault(),!E){s(!0),a(null);try{const d=new FormData;d.append("agent_id",m.id),d.append("category",S),d.append("date_on_sale",j),d.append("amount",b),d.append("location",D),d.append("remarks",F),d.append("client_name",L),i&&d.append("image",i),(await se.post(`updateSalesEncodingBroker/${l.id}`,d,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"multipart/form-data"}})).status===200&&(o(!1),k(""),x(),Y.fire({icon:"success",title:"Success",text:"Sales encoding updated successfully!",timer:2e3,timerProgressBar:!0,showConfirmButton:!1}))}catch(d){if(d.response&&d.response.data&&d.response.data.errors){const M=Object.values(d.response.data.errors).flat().join(", ");a(M)}else a("An error occurred while updating.")}finally{s(!1)}}},he=g=>{const{value:d}=g;k(d)};return e.jsx(U,{open:h,onOpenChange:o,children:e.jsxs(Q,{className:"md:w-[90%] h-full md:h-[800px] overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(ae,{className:"text-start",children:[e.jsxs(te,{className:"text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-500"}),"Edit Sales Encoding"]}),e.jsx(le,{children:e.jsx("span",{className:"text-blue-800 md:text-sm mt-1",children:"Make changes to your sales here. Click save when you're done."})})]}),e.jsxs("form",{onSubmit:ge,className:"space-y-6 mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-5",children:[e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-400"}),"Category"]}),e.jsxs(G,{value:S,onValueChange:P,children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(V,{children:[e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(t,{value:"Block and lot",children:"Block and lot"})]})]})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:J,className:"text-blue-400"}),"Client Name"]}),e.jsx(w,{value:L,onChange:g=>y(g.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:Z,className:"text-blue-400"}),"Date"]}),e.jsx(w,{type:"date",value:j,onChange:g=>T(g.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ne,className:"text-green-500"}),"Amount"]}),e.jsx(me,{value:b,thousandSeparator:!0,decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,placeholder:"0.00",onValueChange:he,className:"flex h-9 w-full rounded-lg border border-blue-300 bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ee,className:"text-blue-400"}),"Location"]}),e.jsx(w,{value:D,onChange:g=>B(g.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-400"}),"Remarks"]}),e.jsxs(G,{value:F,onValueChange:I,children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select remarks"})}),e.jsxs(V,{children:[e.jsx(t,{value:"Sold",children:"Sold"}),e.jsx(t,{value:"Not Sold",children:"Not Sold"}),e.jsx(t,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(t,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]}),e.jsxs("div",{children:[e.jsxs(c,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ie,className:"text-blue-400"}),"Proof of Transaction",e.jsx("span",{className:"text-xs text-red-500 ml-2",children:"(JPEG, PNG, JPG only, max 5MB)"})]}),e.jsx(w,{type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:xe,ref:N,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),K&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:K})]}),C&&e.jsxs("div",{className:"relative mt-4 flex justify-center",children:[e.jsx("img",{src:C,alt:"Selected Preview",className:"max-h-48 object-cover rounded-lg border border-blue-200 shadow"}),C!==u&&e.jsx(R,{type:"button",onClick:ue,className:"absolute top-2 right-2 h-8 w-8 bg-red-500 hover:bg-red-400 rounded-full p-1 shadow-md",children:e.jsx(n,{icon:oe,className:"text-white"})})]})]}),f&&e.jsx("div",{className:"text-red-500 text-center",children:f}),e.jsx(W,{children:e.jsx(R,{type:"submit",disabled:E,className:"w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center justify-center gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:ce}),e.jsx("span",{children:"Save changes"})]})})})]})]})})};function Ue(){const[l,h]=r.useState([]),[o,x]=r.useState({}),[m,u]=r.useState({}),[S,P]=r.useState(null),[j,T]=r.useState("all"),[b,k]=r.useState(""),[D,B]=r.useState(""),[C,v]=r.useState(10),F=async()=>{try{const s=await se.get("user/broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});h(s.data.salesEncoding.map(f=>({...f,amount:typeof f.amount=="number"?f.amount:parseFloat(f.amount)}))),x(s.data.personalInfo),u(s.data.identityDetails),h(s.data.salesEncoding)}catch{}};r.useEffect(()=>{F()},[]);const I=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),L=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),y=l.filter(s=>{const f=s.category.toLowerCase().includes(b.toLowerCase())||new Date(s.date_on_sale).toLocaleDateString().toLowerCase().includes(b.toLowerCase())||s.amount.toString().toLowerCase().includes(b.toLowerCase())||s.location.toLowerCase().includes(b.toLowerCase())||s.remarks.toLowerCase().includes(b.toLowerCase())||s.client_name.toLowerCase().includes(b.toLowerCase()),a=j&&j!=="all"?s.category===j:!0,i=D?s.date_on_sale.split("T")[0]===D:!0;return f&&a&&i}),E=y.slice(0,C);return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0  gap-2 items-start justify-center mr-5 md:px-2 ",children:[e.jsx(Re,{}),e.jsxs(we,{className:"bg-[#eef2ff] border-b-4 border-primary min-w-[100px] fade-in-left md:w-[380px]",children:[e.jsx(Se,{children:e.jsxs("div",{className:"flex flex-row md:flex-col gap-4 justify-between",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-1 gap-4 md:mt-0",children:[e.jsxs("div",{className:"grid w-full gap-1.5",children:[e.jsx(c,{children:"Category"}),e.jsxs(G,{onValueChange:T,value:j,children:[e.jsx(H,{className:"md:w-full ",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(V,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"Lot only",children:"Lot only"}),e.jsx(t,{value:"House and lot",children:"House and lot"}),e.jsx(t,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(t,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(t,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(t,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(t,{value:"Block and lot",children:"Block and lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(c,{children:"Reservation date"}),e.jsx(w,{type:"date",className:"md:w-full]",onChange:s=>B(s.target.value)})]})]}),e.jsx("div",{className:"md:flex md:justify-end md:items-center md:w-full",children:e.jsx(Be,{fetchAgent:F,personalInfo:o,identityDetails:m})})]})}),e.jsxs(Ce,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(G,{onValueChange:s=>v(s==="all"?y.length:parseInt(s,10)),children:[e.jsxs(H,{className:"w-[120px] md:w-full border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(z,{placeholder:"All"})]}),e.jsxs(V,{children:[e.jsx(t,{value:"all",children:"All"}),e.jsx(t,{value:"5",children:"5"}),e.jsx(t,{value:"10",children:"10"}),e.jsx(t,{value:"20",children:"20"}),e.jsx(t,{value:"30",children:"30"}),e.jsx(t,{value:"40",children:"40"}),e.jsx(t,{value:"50",children:"50"})]})]}),e.jsx(w,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:b,onChange:s=>k(s.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Pe,{className:"w-full",children:[e.jsx(ke,{className:"bg-primary text-base",children:e.jsxs(X,{children:[e.jsx(A,{children:"#"}),e.jsx(A,{children:"Client name"}),e.jsx(A,{children:"Category"}),e.jsx(A,{children:"Reservation Date"}),e.jsx(A,{children:"Amount"}),e.jsx(A,{children:"Location"}),e.jsx(A,{children:"Remarks"}),e.jsx(A,{className:"text-right",children:"Action"})]})}),e.jsxs(De,{children:[E.length===0&&e.jsx(X,{children:e.jsx(_,{colSpan:8,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),E.map((s,f)=>e.jsxs(X,{children:[e.jsx(_,{className:"font-medium border border-[#bfdbfe]",children:f+1}),e.jsx(_,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(_,{className:"font-medium border border-[#bfdbfe]",children:s.category}),e.jsx(_,{className:"border border-[#bfdbfe]",children:I.format(new Date(s.date_on_sale))}),e.jsx(_,{className:"border border-[#bfdbfe]",children:e.jsx("span",{children:L.format(s.amount)})}),e.jsx(_,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(_,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(_,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(Te,{sales:s,dateFormatter:I,currencyFormatter:L}),e.jsx(R,{className:"h-8 w-8 font-medium bg-green-500 hover:bg-green-400 text-sm rounded-md",onClick:()=>P(s.id),children:e.jsx(n,{icon:ye})}),e.jsx(Ie,{sales:s,open:S===s.id,onOpenChange:a=>P(a?s.id:null),fetchAgent:F,identityDetails:m})]})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",Math.min(C,y.length)," of ",y.length," entries"]})})})]})]})]})})}export{Ue as default};
