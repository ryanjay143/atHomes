import{j as e,L as pe,r,B as E,F as n,$ as Ne,af as O,ab as U,ae as ee,a4 as se,ag as ie,g as ce,d as ae,S as Z,a as ve,ah as de,ai as ye,aj as we,a1 as me,a3 as Se}from"./index-BqgKW3tX.js";import{c as Ce,C as _e,b as Pe}from"./card-DMwL5mhC.js";import{I as y}from"./input-BPORAoyB.js";import{S as G,a as H,b as z,c as V,d as a}from"./select-yW0ppv6d.js";import{D as Q,a as xe,b as W,c as te,d as le,g as re,e as K,f as ke,T as Fe,h as De,i as Y,j as A,k as Le,l as C}from"./dialog-bG-Ik3It.js";import{L as d}from"./label-L0oGHOiY.js";import{B as Ae,a as Ee,b as Re,c as Ie}from"./breadcrumb-CMARPdCn.js";import{N as ue}from"./react-number-format.es-Bh2RKreN.js";function Te(){return e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-700 shadow-lg flex flex-row items-center gap-4 p-4 rounded-xl mb-8 border border-blue-800/40",children:e.jsx("div",{className:"flex flex-col items-start md:items-center md:justify-center md:ml-10 text-accent fade-in-right w-full",children:e.jsx(Ae,{children:e.jsxs(Ee,{children:[e.jsx(Re,{className:"text-accent",children:e.jsx(pe,{to:"/agent-broker/agent-salesEncoding",children:"List of Sales Encoding"})}),e.jsx(Ie,{})]})})})})}function Be({fetchAgent:l,identityDetails:f}){const[o,x]=r.useState({agent_id:f.id,category:"",date_on_sale:new Date().toISOString().split("T")[0],amount:"",location:"",remarks:"",image:null,client_name:""}),[i,u]=r.useState({}),[_,R]=r.useState(!1),[p,I]=r.useState(!1),[b,T]=r.useState(""),[P,k]=r.useState(null),[F,w]=r.useState(null);r.useEffect(()=>{x(t=>({...t,agent_id:f.id}))},[f]);const S=()=>{const t={};return o.agent_id||(t.agent_id="Agent/Broker is required."),o.category||(t.category="Category is required."),o.date_on_sale||(t.date_on_sale="Date of Sale is required."),o.amount||(t.amount="Amount of Sale is required."),o.location||(t.location="Location of Property is required."),o.remarks||(t.remarks="Remarks are required."),o.image||(t.image="Proof of Transaction is required."),o.client_name||(t.client_name="Client name is required."),u(t),Object.keys(t).length===0},D=async t=>{if(t.preventDefault(),!S()||p)return;I(!0);const c=new FormData;Object.entries(o).forEach(([j,v])=>{c.append(j,v)});try{await ae.post("user/agent-sales",c,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),l(),x({agent_id:f.id,category:"",date_on_sale:new Date().toISOString().split("T")[0],amount:"",location:"",remarks:"",image:null,client_name:""}),T(""),R(!1),k(null),Z.fire({icon:"success",title:"Success",text:"Sales created successfully.",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch{Z.fire({icon:"error",title:"Failed to create sales encoding",text:"There was an error while saving your sales encoding. Please try again.",confirmButtonText:"Retry"})}finally{I(!1)}},L=(t,c)=>{x({...o,[t]:c})},N=t=>{const{name:c,value:j}=t.target;x({...o,[c]:j})},B=t=>{const c=t.target.value;x({...o,date_on_sale:c})},s=t=>{const{value:c}=t;T(c),x({...o,amount:c}),u(c===""?{amount:"Amount is required"}:{})},g=t=>{var j;const c=((j=t.target.files)==null?void 0:j[0])||null;if(c&&(["image/jpeg","image/png","image/jpg"].includes(c.type)?c.size>5242880?(w("File size exceeds the maximum limit of 5MB."),x({...o,image:null})):(w(null),x({...o,image:c})):(w("Invalid file type. Only JPEG, PNG, and JPG are allowed."),x({...o,image:null}))),c){const v=new FileReader;v.onloadend=()=>{k(v.result)},v.onerror=()=>{w("Failed to read file")},v.readAsDataURL(c)}};return e.jsx("div",{children:e.jsxs(Q,{open:_,onOpenChange:R,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(E,{className:"h-10 bg-gradient-to-r from-blue-500 to-blue-700 text-white shadow-md hover:from-blue-600 hover:to-blue-800 transition-all duration-200 rounded-lg",children:[e.jsx(n,{icon:Ne,className:"mr-2"}),"Add Sales"]})}),e.jsx(W,{className:"md:w-[90%] max-w-lg h-full md:h-[750px] overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:e.jsxs(te,{children:[e.jsxs(le,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-500"}),"Add Sales Encoding"]}),e.jsx(re,{children:e.jsx("form",{onSubmit:D,children:e.jsxs("div",{className:"text-start grid grid-cols-1 md:grid-cols-1 gap-5 mt-5",children:[e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-blue-900",children:"Category"}),e.jsxs(G,{onValueChange:t=>L("category",t),children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(V,{children:[e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(a,{value:"Block and lot",children:"Block and lot"})]})]}),i.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.category})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:U,className:"text-blue-400"}),"Client Name"]}),e.jsx(y,{type:"text",name:"client_name",placeholder:"Enter client name",value:o.client_name,onChange:N,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),i.client_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.client_name})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ee,className:"text-blue-400"}),"Reservation Date"]}),e.jsx(y,{type:"date",name:"date_on_sale",value:o.date_on_sale,onChange:B,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),i.date_on_sale&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.date_on_sale})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-blue-900",children:"Amount of Sale"}),e.jsx(ue,{value:b,thousandSeparator:!0,decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,placeholder:"0.00",onValueChange:s,className:"flex h-9 w-full rounded-lg border border-blue-300 bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"}),i.amount&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.amount})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:se,className:"text-blue-400"}),"Location of Property"]}),e.jsx(y,{type:"text",name:"location",placeholder:"Enter location of property",onChange:N,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),i.location&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.location})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-blue-900",children:"Remarks"}),e.jsxs(G,{onValueChange:t=>L("remarks",t),children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select remarks"})}),e.jsxs(V,{children:[e.jsx(a,{value:"Sold",children:"Sold"}),e.jsx(a,{value:"Not Sold",children:"Not Sold"}),e.jsx(a,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(a,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]}),i.remarks&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.remarks})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ie,className:"text-blue-400"}),"Upload Proof of Transaction",e.jsx("span",{className:"text-xs text-red-500 ml-2",children:"(JPEG, PNG, JPG only, max 5MB)"})]}),e.jsx(y,{type:"file",name:"image",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:g,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),F&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:F}),i.image&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.image}),P&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("img",{src:P,alt:"Preview",className:"max-w-xs rounded-lg border border-blue-200 shadow"})})]}),e.jsx(K,{className:"mt-4",children:e.jsx(E,{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white rounded-lg shadow hover:from-blue-700 hover:to-blue-900 flex items-center justify-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submitting..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:ce}),e.jsx("span",{children:"Submit"})]})})})]})})})]})})]})})}function Oe({sales:l,dateFormatter:f,currencyFormatter:o}){var _;const x=r.useRef(null),[i,u]=r.useState(!1);return e.jsx("div",{children:e.jsxs(Q,{children:[e.jsx(xe,{children:e.jsx(E,{className:"h-8 w-8 font-medium text-sm rounded-md border border-primary bg-gradient-to-br from-blue-500 to-blue-700 text-white shadow hover:from-blue-600 hover:to-blue-800 transition-all duration-200",children:e.jsx(n,{icon:ve})})}),e.jsxs(W,{className:"md:w-[95%] max-w-2xl h-full overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(te,{children:[e.jsxs(le,{className:"text-start text-2xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-500"}),"View Receipt"]}),e.jsx(re,{children:e.jsxs("div",{ref:x,className:"grid gap-6 py-6 text-start bg-white rounded-xl shadow-inner px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:U,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Broker/Agent:"}),e.jsxs("span",{className:"ml-2 text-base text-gray-800 font-medium",children:[l.agent.personal_info.first_name," ",l.agent.personal_info.middle_name," ",l.agent.personal_info.last_name," ",(_=l.agent.personal_info)==null?void 0:_.extension_name]})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:U,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Client Name:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.client_name})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:O,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Category:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.category})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:ee,className:"text-blue-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Date of Sale:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:f.format(new Date(l.date_on_sale))})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:de,className:"text-green-500 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Amount:"}),e.jsx("span",{className:"ml-2 text-base text-green-700 font-bold",children:o.format(l.amount)})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:se,className:"text-red-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Location:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.location})]}),e.jsxs("div",{className:"flex items-center gap-3 border-b pb-3",children:[e.jsx(n,{icon:ye,className:"text-indigo-400 text-lg"}),e.jsx(d,{className:"text-gray-600 font-semibold",children:"Remarks:"}),e.jsx("span",{className:"ml-2 text-base text-gray-800 font-medium",children:l.remarks})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs(d,{className:"text-gray-600 font-semibold flex items-center gap-2",children:[e.jsx(n,{icon:we,className:"text-pink-400 text-lg"}),"Proof of Transaction:"]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:`https://athomes.site/${l.image}`,alt:l.image,className:"object-cover rounded-lg border-2 border-blue-200 shadow-md max-w-xs max-h-60 cursor-pointer transition-transform duration-200 hover:scale-105 hover:ring-2 hover:ring-primary",onClick:()=>u(!0),title:"Click to preview"})}),e.jsx(Q,{open:i,onOpenChange:u,children:e.jsxs(W,{className:"md:max-w-[80vw] flex flex-col items-center bg-white rounded-xl shadow-2xl",children:[e.jsx("img",{src:`https://athomes.site/${l.image}`,alt:l.image,className:"max-w-[80vw] max-h-[80vh] rounded shadow-lg"}),e.jsx(K,{children:e.jsxs(E,{className:"mt-4 bg-red-500 hover:bg-red-400 text-white",onClick:()=>u(!1),children:[e.jsx(n,{icon:me,className:"mr-1"}),"Close"]})})]})})]})]})})]}),e.jsx(K,{children:e.jsx("div",{className:"flex flex-row justify-end gap-2",children:e.jsx(ke,{asChild:!0,children:e.jsx(E,{className:"bg-red-500 hover:bg-red-400 h-8 rounded shadow",children:"Close"})})})})]})]})})}const Ge=({sales:l,open:f,onOpenChange:o,fetchAgent:x,identityDetails:i})=>{var oe;const u=`https://athomes.site/${l.image}`,[_,R]=r.useState(i.id?String(i.id):""),[p,I]=r.useState(l.category||""),[b,T]=r.useState(((oe=l.date_on_sale)==null?void 0:oe.split("T")[0])||""),[P,k]=r.useState(l.amount.toString()||""),[F,w]=r.useState(l.location||""),[S,D]=r.useState(u),[L,N]=r.useState(l.remarks||""),[B,s]=r.useState(l.client_name||""),[g,t]=r.useState(!1),[c,j]=r.useState(null),[v,q]=r.useState(null),[ne,$]=r.useState(null),X=r.useRef(null),ge=h=>{var M;const m=(M=h.target.files)==null?void 0:M[0];if(m){const je=["image/jpeg","image/png","image/jpg"];if(!m.type.startsWith("image/")||!je.includes(m.type)){$("Please select a valid image file (JPEG, PNG, or JPG).");return}if(m.size>5242880){$("The selected file exceeds the maximum size of 5MB.");return}$(null);const J=new FileReader;J.onloadend=()=>{typeof J.result=="string"&&(D(J.result),q(m))},J.readAsDataURL(m)}else $("Please select a valid image file.")},he=()=>{D(u),X.current&&(X.current.value=""),q(null)};r.useEffect(()=>{var h;f&&(R(i.id?String(i.id):""),I(l.category||""),T(((h=l.date_on_sale)==null?void 0:h.split("T")[0])||""),k(l.amount.toString()||""),w(l.location||""),N(l.remarks||""),s(l.client_name||""),D(u),j(null),q(null),$(null))},[f,l]);const fe=async h=>{if(h.preventDefault(),!g){t(!0),j(null);try{const m=new FormData;m.append("agent_id",_),m.append("category",p),m.append("date_on_sale",b),m.append("amount",P),m.append("location",F),m.append("remarks",L),m.append("client_name",B),v&&m.append("image",v),(await ae.post(`updateSalesEncodingAgent/${l.id}`,m,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"multipart/form-data"}})).status===200&&(o(!1),k(""),x(),Z.fire({icon:"success",title:"Success",text:"Sales encoding updated successfully!",timer:2e3,timerProgressBar:!0,showConfirmButton:!1}))}catch(m){if(m.response&&m.response.data&&m.response.data.errors){const M=Object.values(m.response.data.errors).flat().join(", ");j(M)}else j("An error occurred while updating.")}finally{t(!1)}}},be=h=>{const{value:m}=h;k(m)};return e.jsx(Q,{open:f,onOpenChange:o,children:e.jsxs(W,{className:"md:w-[90%] h-full overflow-auto bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl border border-blue-200",children:[e.jsxs(te,{className:"text-start",children:[e.jsxs(le,{className:"text-2xl font-bold text-blue-900 flex items-center gap-2 mb-2",children:[e.jsx(n,{icon:O,className:"text-blue-500"}),"Edit Sales Encoding"]}),e.jsx(re,{children:e.jsx("span",{className:"text-blue-800 md:text-sm mt-1",children:"Make changes to your sales here. Click save when you're done."})})]}),e.jsxs("form",{onSubmit:fe,className:"space-y-6 mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-5",children:[e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-400"}),"Category"]}),e.jsxs(G,{value:p,onValueChange:I,children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(V,{children:[e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(a,{value:"Block and lot",children:"Block and lot"})]})]})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:U,className:"text-blue-400"}),"Client Name"]}),e.jsx(y,{value:B,onChange:h=>s(h.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ee,className:"text-blue-400"}),"Date"]}),e.jsx(y,{type:"date",value:b,onChange:h=>T(h.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:de,className:"text-green-500"}),"Amount"]}),e.jsx(ue,{value:P,thousandSeparator:!0,decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,placeholder:"0.00",onValueChange:be,className:"flex h-9 w-full rounded-lg border border-blue-300 bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:se,className:"text-blue-400"}),"Location"]}),e.jsx(y,{value:F,onChange:h=>w(h.target.value),className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:O,className:"text-blue-400"}),"Remarks"]}),e.jsxs(G,{value:L,onValueChange:N,children:[e.jsx(H,{className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1",children:e.jsx(z,{placeholder:"Select remarks"})}),e.jsxs(V,{children:[e.jsx(a,{value:"Sold",children:"Sold"}),e.jsx(a,{value:"Not Sold",children:"Not Sold"}),e.jsx(a,{value:"Pre-Selling",children:"Pre-Selling"}),e.jsx(a,{value:"RFO",children:"Ready for Occupancy - (RFO)"})]})]})]}),e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(n,{icon:ie,className:"text-blue-400"}),"Proof of Transaction",e.jsx("span",{className:"text-xs text-red-500 ml-2",children:"(JPEG, PNG, JPG only, max 5MB)"})]}),e.jsx(y,{type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:ge,ref:X,className:"rounded-lg border-blue-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 mt-1"}),ne&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:ne})]}),S&&e.jsxs("div",{className:"relative mt-4 flex justify-center",children:[e.jsx("img",{src:S,alt:"Selected Preview",className:"max-h-48 object-cover rounded-lg border border-blue-200 shadow"}),S!==u&&e.jsx(E,{type:"button",onClick:he,className:"absolute top-2 right-2 h-8 w-8 bg-red-500 hover:bg-red-400 rounded-full p-1 shadow-md",children:e.jsx(n,{icon:me,className:"text-white"})})]})]}),c&&e.jsx("div",{className:"text-red-500 text-center",children:c}),e.jsx(K,{children:e.jsx(E,{type:"submit",disabled:g,className:"w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-600 hover:to-green-800 text-white rounded-lg shadow flex items-center justify-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saving..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:ce}),e.jsx("span",{children:"Save changes"})]})})})]})]})})};function We(){const[l,f]=r.useState([]),[o,x]=r.useState({}),[i,u]=r.useState({}),[_,R]=r.useState(null),[p,I]=r.useState("all"),[b,T]=r.useState(""),[P,k]=r.useState(""),[F,w]=r.useState(10),S=async()=>{try{const s=await ae.get("user/agent-broker",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`}});f(s.data.salesEncoding.map(g=>({...g,amount:typeof g.amount=="number"?g.amount:parseFloat(g.amount)}))),x(s.data.personalInfo),u(s.data.identityDetails),f(s.data.salesEncoding)}catch{}};r.useEffect(()=>{S()},[]);const D=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}),L=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}),N=l.filter(s=>{const g=s.category.toLowerCase().includes(b.toLowerCase())||new Date(s.date_on_sale).toLocaleDateString().toLowerCase().includes(b.toLowerCase())||s.amount.toString().toLowerCase().includes(b.toLowerCase())||s.location.toLowerCase().includes(b.toLowerCase())||s.remarks.toLowerCase().includes(b.toLowerCase())||s.client_name.toLowerCase().includes(b.toLowerCase()),t=p&&p!=="all"?s.category===p:!0,c=P?s.date_on_sale.split("T")[0]===P:!0;return g&&t&&c}),B=N.slice(0,F);return e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"ml-72 md:ml-0  gap-2 items-start justify-center mr-5 md:px-2 ",children:[e.jsx(Te,{}),e.jsxs(Ce,{className:"bg-[#eef2ff] border-b-4 border-primary fade-in-left md:w-[380px]",children:[e.jsx(_e,{children:e.jsxs("div",{className:"flex flex-row md:flex-col gap-4 justify-between",children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-1 gap-4 md:mt-0",children:[e.jsxs("div",{className:"grid w-full gap-1.5",children:[e.jsx(d,{children:"Category"}),e.jsxs(G,{onValueChange:I,value:p,children:[e.jsx(H,{className:"md:w-full ",children:e.jsx(z,{placeholder:"Select category"})}),e.jsxs(V,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"Lot only",children:"Lot only"}),e.jsx(a,{value:"House and lot",children:"House and lot"}),e.jsx(a,{value:"Condominium/Apartment",children:"Condominium/Apartment"}),e.jsx(a,{value:"Commercial Properties",children:"Commercial Properties"}),e.jsx(a,{value:"Rental Properties",children:"Rental Properties"}),e.jsx(a,{value:"Farm Lot",children:"Farm Lot"}),e.jsx(a,{value:"Block and lot",children:"Block and lot"})]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(d,{children:"Reservation date"}),e.jsx(y,{type:"date",className:"md:w-full]",onChange:s=>k(s.target.value)})]})]}),e.jsx("div",{className:"md:flex md:justify-end md:items-center md:w-full",children:e.jsx(Be,{fetchAgent:S,personalInfo:o,identityDetails:i})})]})}),e.jsxs(Pe,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between gap-4",children:[e.jsxs(G,{onValueChange:s=>w(s==="all"?N.length:parseInt(s,10)),children:[e.jsxs(H,{className:"w-[120px]  border border-primary",children:[e.jsx("span",{className:"text-[#172554]",children:"Show"}),e.jsx(z,{placeholder:"All"})]}),e.jsxs(V,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"5",children:"5"}),e.jsx(a,{value:"10",children:"10"}),e.jsx(a,{value:"20",children:"20"}),e.jsx(a,{value:"30",children:"30"}),e.jsx(a,{value:"40",children:"40"}),e.jsx(a,{value:"50",children:"50"})]})]}),e.jsx(y,{type:"text",placeholder:"Search",className:"w-52 md:w-full",value:b,onChange:s=>T(s.target.value)})]}),e.jsx("div",{className:"fade-in-left ",children:e.jsxs(Fe,{className:"w-full",children:[e.jsx(De,{className:"bg-primary text-base",children:e.jsxs(Y,{children:[e.jsx(A,{children:"#"}),e.jsx(A,{children:"Client name"}),e.jsx(A,{children:"Category"}),e.jsx(A,{children:"Reservation Date"}),e.jsx(A,{children:"Amount"}),e.jsx(A,{children:"Location"}),e.jsx(A,{children:"Remarks"}),e.jsx(A,{className:"text-right",children:"Action"})]})}),e.jsxs(Le,{children:[B.length===0&&e.jsx(Y,{children:e.jsx(C,{colSpan:8,className:"text-center text-sm font-medium text-gray-500",children:"No record found."})}),B.map((s,g)=>e.jsxs(Y,{children:[e.jsx(C,{className:"font-medium border border-[#bfdbfe]",children:g+1}),e.jsx(C,{className:"border border-[#bfdbfe]",children:s.client_name}),e.jsx(C,{className:"font-medium border border-[#bfdbfe]",children:s.category}),e.jsx(C,{className:"border border-[#bfdbfe]",children:D.format(new Date(s.date_on_sale))}),e.jsx(C,{className:"border border-[#bfdbfe]",children:e.jsx("span",{children:L.format(s.amount)})}),e.jsx(C,{className:"border border-[#bfdbfe]",children:s.location}),e.jsx(C,{className:"border border-[#bfdbfe]",children:s.remarks}),e.jsx(C,{className:"text-right border border-[#bfdbfe]",children:e.jsxs("div",{className:"flex flex-row gap-1 justify-end",children:[e.jsx(Oe,{sales:s,dateFormatter:D,currencyFormatter:L}),e.jsx(E,{className:"h-8 w-8 font-medium bg-green-500 hover:bg-green-400 text-sm rounded-md",onClick:()=>R(s.id),children:e.jsx(n,{icon:Se})}),e.jsx(Ge,{sales:s,open:_===s.id,onOpenChange:t=>R(t?s.id:null),fetchAgent:S,identityDetails:i})]})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-[#172554] text-sm w-full",children:["Showing 1 to ",Math.min(F,N.length)," of ",N.length," entries"]})})})]})]})]})})}export{We as default};
