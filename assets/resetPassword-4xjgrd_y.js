import{r as t,u as H,g as O,j as e,F as I,a as L,f as R,B as q,S as d,c as U}from"./index-CjLef5bq.js";import{c as _,C as z,a as G,d as J,b as K}from"./card-C1rSJ_1a.js";import{I as c}from"./input-CaqVBi-Z.js";import{L as h}from"./label-IU-MHvgN.js";function Y(){const[o,p]=t.useState(""),[l,w]=t.useState(""),[u,m]=t.useState(""),[x,f]=t.useState(""),[g,j]=t.useState(!1),[b,i]=t.useState(null),[y,S]=t.useState(null),[r,B]=t.useState(!1),M=H(),v=O(),[P,T]=t.useState(!1),[C,D]=t.useState(!1);t.useEffect(()=>{const s=new URLSearchParams(v.search),a=s.get("token"),n=s.get("email");a&&m(a),n&&f(n)},[v.search]);const A=async s=>{var a,n,N,k;if(s.preventDefault(),i(null),S(null),!o||!l||!u||!x){i("Please fill in all fields."),d.fire({icon:"error",title:"Missing Fields",text:"Please fill in all fields."});return}if(o.trim()!==l.trim()){i("Passwords do not match."),d.fire({icon:"error",title:"Password Mismatch",text:"Passwords do not match."});return}j(!0);try{await U.post("reset-password",{password:o.trim(),password_confirmation:l.trim(),token:u,email:x}),S("Password reset successful!"),p(""),w(""),m(""),f(""),B(!0),d.fire({icon:"success",title:"Success",text:"Password reset successful!"})}catch(E){const F=((n=(a=E.response)==null?void 0:a.data)==null?void 0:n.message)||((k=(N=E.response)==null?void 0:N.data)==null?void 0:k.detail)||"Failed to reset password. Please try again.";i(F),d.fire({icon:"error",title:"Error",text:F})}finally{j(!1)}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen md:p-5",children:e.jsxs(_,{className:"w-full max-w-md shadow-lg rounded-xl border border-b-4 border-primary",children:[e.jsxs(z,{children:[e.jsx(G,{className:"text-2xl font-semibold text-center text-gray-800",children:"Reset Password"}),e.jsx(J,{className:"text-center text-sm text-gray-500 mt-1",children:"Enter your details to reset your password."})]}),e.jsx(K,{children:e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:A,children:[e.jsxs("div",{className:"flex flex-col gap-1.5 relative",children:[e.jsx(h,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",type:"email",readOnly:!0,value:x,onChange:s=>f(s.target.value),required:!0,disabled:r})]}),e.jsx(c,{id:"token",type:"hidden",value:u,onChange:s=>m(s.target.value),required:!0,disabled:r}),e.jsxs("div",{className:"flex flex-col gap-1.5 relative",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsx(c,{id:"password",type:P?"text":"password",value:o,onChange:s=>p(s.target.value),required:!0,disabled:r}),e.jsx("button",{type:"button",tabIndex:-1,className:"absolute right-3 top-10 transform -translate-y-1/2 cursor-pointer text-[#93c5fd]",onClick:()=>T(s=>!s),style:{background:"none",border:"none",padding:0,margin:0},children:e.jsx(I,{icon:P?L:R})})]}),e.jsxs("div",{className:"flex flex-col gap-1.5 relative",children:[e.jsx(h,{htmlFor:"confirm-password",children:"Confirm Password"}),e.jsx(c,{id:"confirm-password",type:C?"text":"password",value:l,onChange:s=>w(s.target.value),required:!0,disabled:r}),e.jsx("button",{type:"button",tabIndex:-1,className:"absolute right-3 top-10 transform -translate-y-1/2 cursor-pointer text-[#93c5fd]",onClick:()=>D(s=>!s),style:{background:"none",border:"none",padding:0,margin:0},children:e.jsx(I,{icon:C?L:R})})]}),b&&e.jsx("div",{className:"text-red-600 text-sm text-center",children:b}),y&&e.jsx("div",{className:"text-green-600 text-sm text-center",children:y}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(q,{type:"submit",disabled:g||r,className:"w-full flex items-center justify-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Sending..."}),e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})]}):e.jsx("span",{children:"Submit"})}),e.jsx(q,{type:"button",disabled:!r,onClick:()=>M("/user-login"),className:"w-full flex items-center justify-center gap-2 bg-red-600 hover:bg-red-500 text-white hover:text-white",children:e.jsx("span",{children:"Back to login"})})]})]})})]})})}export{Y as default};
